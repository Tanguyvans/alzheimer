{
  "config": {
    "data": {
      "tabular_dir": "/Users/tanguyvans/Desktop/umons/alzheimer/data/tabular",
      "dxsum_csv": "/home/maxglo/tanguy/dxsum.csv",
      "skull_dir": "/home/maxglo/tanguy/ADNI-skull",
      "splits_dir": "data/splits",
      "checkpoints_dir": "data/checkpoints",
      "logs_dir": "data/logs",
      "results_dir": "data/results",
      "train_csv": "data/splits/train.csv",
      "val_csv": "data/splits/val.csv",
      "test_csv": "data/splits/test.csv"
    },
    "classes": {
      "num_classes": 4,
      "names": [
        "CN",
        "MCI_stable",
        "MCI_to_AD",
        "AD"
      ]
    },
    "slice_extraction": {
      "range": [
        0.25,
        0.75
      ]
    },
    "model": {
      "name": "MedTransformer",
      "image_size": 224,
      "num_classes": 4,
      "num_slices": 10,
      "backbone": "vit_small_patch16_224",
      "pretrained": true,
      "embed_dim": 384,
      "num_heads": 6,
      "num_layers": 2,
      "dropout": 0.1,
      "use_cross_attention": true
    },
    "training": {
      "batch_size": 4,
      "epochs": 20,
      "learning_rate": 0.0001,
      "weight_decay": 0.01,
      "optimizer": "AdamW",
      "scheduler": "CosineAnnealing",
      "warmup_epochs": 5,
      "lr_min": 1e-06,
      "use_weighted_loss": true,
      "accumulation_steps": 4,
      "seed": 42
    },
    "augmentation": {
      "enabled": true,
      "random_horizontal_flip": 0.5,
      "random_rotation": 10,
      "color_jitter": true,
      "brightness": 0.1,
      "contrast": 0.1,
      "mean": [
        0.485,
        0.456,
        0.406
      ],
      "std": [
        0.229,
        0.224,
        0.225
      ]
    },
    "hardware": {
      "device": "cuda",
      "num_workers": 4,
      "pin_memory": true,
      "mixed_precision": true
    },
    "callbacks": {
      "early_stopping": {
        "enabled": true,
        "patience": 15,
        "monitor": "val_balanced_accuracy",
        "mode": "max"
      },
      "checkpoint": {
        "save_top_k": 3,
        "monitor": "val_balanced_accuracy",
        "mode": "max",
        "save_last": true
      }
    },
    "dataset_preparation": {
      "train_ratio": 0.7,
      "val_ratio": 0.15,
      "test_ratio": 0.15,
      "random_seed": 42
    },
    "evaluation": {
      "metrics": [
        "accuracy",
        "balanced_accuracy",
        "precision",
        "recall",
        "f1",
        "confusion_matrix"
      ],
      "save_predictions": true
    }
  },
  "best_epoch": 12,
  "history": {
    "train_loss": [
      1.3444146922189895,
      1.2708170680694928,
      1.2544746483297653,
      1.2368494714503964,
      1.2732453180230372,
      1.2153963794991307,
      1.2007334665076372,
      1.1958356111833495,
      1.21010881077209,
      1.1076871204321788,
      1.1178213626010234,
      1.090015125601259,
      1.0703094288638737,
      1.0360733523760757,
      1.0072913431141475,
      0.9726658945214258,
      0.933414668797358,
      0.9022251465549208,
      0.8869488979583462,
      0.8599927074288669
    ],
    "train_acc": [
      0.3550228310502283,
      0.4257990867579909,
      0.3972602739726027,
      0.3972602739726027,
      0.410958904109589,
      0.4315068493150685,
      0.4360730593607306,
      0.454337899543379,
      0.4360730593607306,
      0.4828767123287671,
      0.4737442922374429,
      0.4885844748858447,
      0.4977168949771689,
      0.521689497716895,
      0.5342465753424658,
      0.5536529680365296,
      0.5764840182648402,
      0.610730593607306,
      0.591324200913242,
      0.6118721461187214
    ],
    "train_bal_acc": [
      0.32280703711515324,
      0.41393092761365047,
      0.3854492270804812,
      0.3740077498733485,
      0.3856399201088578,
      0.41317697417102583,
      0.41490515301891995,
      0.4321481998040716,
      0.41633557054542014,
      0.4661487290706182,
      0.44892803909028467,
      0.47842720226671326,
      0.47214926697147575,
      0.5055391889284105,
      0.521090148106618,
      0.5399188374465077,
      0.5644760779187933,
      0.6009899179371434,
      0.5767134276708841,
      0.596910571711888
    ],
    "val_loss": [
      1.236819122699981,
      1.3138488695976582,
      1.1956991616715775,
      1.1860729772993859,
      1.245685524128853,
      1.299540362459548,
      1.4090356699963833,
      1.0895598441996472,
      1.1413174499856664,
      1.1062153653895601,
      1.1638091599687617,
      1.0926856981947066,
      1.100835675888873,
      1.1382408224521798,
      1.1351880608720983,
      1.1733108004356951,
      1.1711299692062622,
      1.1937709602903812,
      1.1777084082999127,
      1.1947652107857643
    ],
    "val_acc": [
      0.4148936170212766,
      0.30319148936170215,
      0.4787234042553192,
      0.3776595744680851,
      0.324468085106383,
      0.31382978723404253,
      0.3776595744680851,
      0.48404255319148937,
      0.44680851063829785,
      0.44148936170212766,
      0.44680851063829785,
      0.5106382978723404,
      0.4946808510638298,
      0.48404255319148937,
      0.48404255319148937,
      0.48936170212765956,
      0.4946808510638298,
      0.46808510638297873,
      0.4946808510638298,
      0.4946808510638298
    ],
    "val_bal_acc": [
      0.4125874125874126,
      0.3347672064777328,
      0.4333548030916452,
      0.38650932400932403,
      0.36781989939884674,
      0.366462703962704,
      0.29641608391608393,
      0.4701432339590234,
      0.4667924181082076,
      0.448652005888848,
      0.3921788737578211,
      0.5068151147098516,
      0.4791728008833272,
      0.44455281560544724,
      0.4492439577965893,
      0.4571693657219973,
      0.46356121948227214,
      0.44413262176420065,
      0.4709038768249295,
      0.471900687032266
    ]
  },
  "test_metrics": {
    "accuracy": 0.4627659574468085,
    "balanced_accuracy": 0.4535762483130904,
    "precision": 0.4867251542783458,
    "recall": 0.4627659574468085,
    "f1": 0.4489678173231413,
    "confusion_matrix": [
      [
        41,
        10,
        14,
        0
      ],
      [
        21,
        10,
        18,
        3
      ],
      [
        3,
        2,
        25,
        8
      ],
      [
        0,
        2,
        20,
        11
      ]
    ]
  }
}