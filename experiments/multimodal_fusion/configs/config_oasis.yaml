# Multi-Modal Fusion: MRI + Tabular - OASIS Dataset
# Uses common features available in OASIS (7 features)
# Note: Some features may have missing values - handled by median imputation

experiment:
  name: "multimodal_fusion_oasis"
  task: "cn_ad_trajectory"
  dataset: "oasis"
  description: "Late fusion of MRI features + OASIS tabular clinical data"

model:
  backbone:
    type: "resnet"
    depth: 18
    pretrained: true
    freeze: false
    feature_dim: 512

  tabular:
    type: "mlp"  # mlp (best) or fttransformer
    hidden_dims: [64, 32]  # Smaller due to fewer features
    dropout: 0.3

  fusion:
    method: "gated"  # concat, attention, or gated
    hidden_dim: 512
    dropout: 0.3

  num_classes: 2

data:
  train_csv: "data/oasis/train.csv"
  val_csv: "data/oasis/val.csv"
  test_csv: "data/oasis/test.csv"
  checkpoints_dir: "checkpoints"
  results_dir: "results"

  # OASIS tabular features (common features - 7 total)
  # Note: CATANIMSC, TRAASCOR, TRABSCOR only ~35% available
  tabular_features:
    # Demographics (4) - ~98% available
    - "AGE"
    - "PTGENDER"
    - "PTEDUCAT"
    - "PTMARRY"
    # Neuropsych tests (3) - ~35% available
    - "CATANIMSC"
    - "TRAASCOR"
    - "TRABSCOR"

preprocessing:
  use_paper_preprocessing: true
  target_spacing: 1.75
  tabular_normalize: true
  handle_missing: "median"

training:
  epochs: 50
  batch_size: 4
  learning_rate: 0.0001
  weight_decay: 0.01
  lr_min: 0.0000001
  optimizer: "adamw"
  scheduler: "cosine"
  warmup_epochs: 5
  gradient_clip: 1.0
  use_weighted_loss: true
  seed: 42

hardware:
  device: "cuda"
  num_workers: 4
  pin_memory: true

callbacks:
  early_stopping:
    enabled: true
    patience: 15
    monitor: "val_accuracy"
  checkpoint:
    save_best: true

wandb:
  enabled: false
