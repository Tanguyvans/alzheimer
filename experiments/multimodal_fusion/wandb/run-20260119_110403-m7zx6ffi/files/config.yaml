_wandb:
    value:
        cli_version: 0.23.1
        e:
            rrsrtk36yap18gqqwfv5ea180rnz1vap:
                args:
                    - --config
                    - config_adni.yaml
                    - --n-folds
                    - "5"
                    - --seeds
                    - "42"
                    - "123"
                    - "456"
                codePath: experiments/multimodal_fusion/train_adni_external.py
                codePathLocal: train_adni_external.py
                cpu_count: 20
                cpu_count_logical: 28
                cudaVersion: "12.2"
                disk:
                    /:
                        total: "1595870232576"
                        used: "992594182144"
                email: tanguyvans@gmail.com
                executable: /home/tanguy/medical/alzheimer/env/bin/python
                git:
                    commit: e7ef6393d4e4618d864cf3389f59f2715c9a864c
                    remote: https://github.com/Tanguyvans/alzheimer.git
                gpu: NVIDIA GeForce RTX 4080
                gpu_count: 1
                gpu_nvidia:
                    - architecture: Ada
                      cudaCores: 9728
                      memoryTotal: "17171480576"
                      name: NVIDIA GeForce RTX 4080
                      uuid: GPU-7bd8a1a2-4418-d7ee-6ab4-3a6e4a383196
                host: ilia-corsair-5000x
                memory:
                    total: "33448153088"
                os: Linux-6.14.0-37-generic-x86_64-with-glibc2.39
                program: /home/tanguy/medical/alzheimer/experiments/multimodal_fusion/train_adni_external.py
                python: CPython 3.12.3
                root: /home/tanguy/medical/alzheimer/experiments/multimodal_fusion
                startedAt: "2026-01-19T10:04:03.286824Z"
                writerId: rrsrtk36yap18gqqwfv5ea180rnz1vap
        m: []
        python_version: 3.12.3
        t:
            "1":
                - 1
                - 5
                - 11
                - 41
                - 48
                - 49
                - 53
            "2":
                - 1
                - 5
                - 11
                - 41
                - 48
                - 49
                - 53
            "3":
                - 2
                - 13
                - 16
            "4": 3.12.3
            "5": 0.23.1
            "6": 4.57.3
            "12": 0.23.1
            "13": linux-x86_64
callbacks:
    value:
        checkpoint:
            save_best: true
        early_stopping:
            enabled: true
            min_epochs: 40
            monitor: val_accuracy
            patience: 20
data:
    value:
        checkpoints_dir: checkpoints_adni
        external_test:
            nacc: data/nacc_external/all.csv
            oasis: data/oasis_external/all.csv
        results_dir: results_adni
        tabular_features:
            - AGE
            - PTGENDER
            - PTEDUCAT
            - PTMARRY
            - CATANIMSC
            - TRAASCOR
            - TRABSCOR
            - DSPANFOR
            - DSPANBAC
            - BNTTOTAL
            - VSWEIGHT
            - BMI
            - MH14ALCH
            - MH16SMOK
            - MH4CARD
            - MH2NEURL
        test_csv: data/adni_only/test.csv
        train_csv: data/adni_only/train.csv
        val_csv: data/adni_only/val.csv
experiment:
    value:
        dataset: adni_only
        description: ADNI-only training to demonstrate cross-cohort generalization gap
        name: multimodal_fusion_adni_only
        task: cn_ad_trajectory
hardware:
    value:
        device: cuda
        num_workers: 4
        pin_memory: true
model:
    value:
        fusion:
            auxiliary_losses: true
            dropout: 0.3
            hidden_dim: 512
            method: cross_modal
            num_heads: 8
        num_classes: 2
        tabular:
            dropout: 0.1
            embed_dim: 64
            num_heads: 4
            num_layers: 3
            output_dim: 64
            type: ft_transformer
        vit:
            architecture: vit_base
            feature_dim: 768
            freeze_backbone: false
            image_size: 128
            pretrained_path: ../mri_vit_ad/pretrained/vit_mae75_pretrained.pth
preprocessing:
    value:
        handle_missing: median
        tabular_normalize: true
        target_spacing: 1.75
        use_paper_preprocessing: true
training:
    value:
        auxiliary_loss_weight: 0.3
        batch_size: 4
        epochs: 100
        gradient_clip: 1
        label_smoothing: 0.1
        layer_wise_lr_decay: 0.75
        learning_rate: 2e-05
        lr_min: 1e-07
        optimizer: adamw
        scheduler: cosine
        seed: 42
        tta_augmentations: 8
        use_auxiliary_loss: true
        use_tta: true
        use_weighted_loss: true
        warmup_epochs: 5
        weight_decay: 0.01
wandb:
    value:
        enabled: true
        name: multimodal_adni_only_external
        project: alzheimer-ablation
