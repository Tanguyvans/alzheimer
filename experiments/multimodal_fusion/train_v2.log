nohup: les entrÃ©es sont ignorÃ©es
[0;93m2026-01-08 12:40:46.579492944 [W:onnxruntime:Default, device_discovery.cc:164 DiscoverDevicesForPlatform] GPU device discovery failed: device_discovery.cc:89 ReadFileContents Failed to open file: "/sys/class/drm/card0/device/vendor"[m
INFO:__main__:Loading data...
INFO:__main__:Total samples: 6065
INFO:__main__:Label distribution:
label
0    4747
1    1318
Name: count, dtype: int64
INFO:__main__:Trajectory distribution:
trajectory
CN               4747
AD_trajectory     839
MCI_to_AD         259
AD                220
Name: count, dtype: int64
INFO:__main__:
============================================================
INFO:__main__:SEED: 42
INFO:__main__:============================================================
INFO:__main__:
--- Fold 1/5 ---
INFO:__main__:Train: 4367, Val: 485, Test: 1213
INFO:dataset:Filled 3 missing values in 'AGE' with 69.00
INFO:dataset:Filled 12 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 478 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 484 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 527 missing values in 'TRABSCOR' with 76.00
INFO:dataset:Filled 3357 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 3361 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 3346 missing values in 'BNTTOTAL' with 23.00
INFO:dataset:Filled 2419 missing values in 'VSWEIGHT' with 166.00
INFO:dataset:Filled 2413 missing values in 'BMI' with 29.71
INFO:dataset:Filled 2661 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 2659 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 2659 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 2659 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 4367 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 3421 (78.3%)
INFO:dataset:  Class 1: 946 (21.7%)
INFO:dataset:Filled 56 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 57 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 64 missing values in 'TRABSCOR' with 80.00
INFO:dataset:Filled 368 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 368 missing values in 'DSPANBAC' with 5.00
INFO:dataset:Filled 367 missing values in 'BNTTOTAL' with 24.00
INFO:dataset:Filled 261 missing values in 'VSWEIGHT' with 160.00
INFO:dataset:Filled 261 missing values in 'BMI' with 29.03
INFO:dataset:Filled 291 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 291 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 291 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 291 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 485 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 376 (77.5%)
INFO:dataset:  Class 1: 109 (22.5%)
INFO:dataset:Filled 1 missing values in 'AGE' with 69.00
INFO:dataset:Filled 4 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 150 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 152 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 162 missing values in 'TRABSCOR' with 78.00
INFO:dataset:Filled 913 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 913 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 912 missing values in 'BNTTOTAL' with 23.00
INFO:dataset:Filled 653 missing values in 'VSWEIGHT' with 162.20
INFO:dataset:Filled 652 missing values in 'BMI' with 29.12
INFO:dataset:Filled 712 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 712 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 712 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 712 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 1213 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 950 (78.3%)
INFO:dataset:  Class 1: 263 (21.7%)
INFO:mri_vit_model:Created ViT3DClassifier with vit_base
INFO:mri_vit_model:  Image size: 128x128x128
INFO:mri_vit_model:  Patch size: 16
INFO:mri_vit_model:  Num patches: 512
INFO:mri_vit_model:  Embed dim: 768, Depth: 12, Heads: 12
INFO:mri_vit_model:Loading MAE pre-trained weights from ../mri_vit_ad/pretrained/vit_mae75_pretrained.pth
INFO:mri_vit_model:  Loaded pos_embed directly (shapes match: torch.Size([1, 513, 768]))
INFO:mri_vit_model:Loaded 150 pretrained weights (including pos_embed, cls_token, patch_embed if matched)
INFO:mri_vit_model:Missing keys: 2
INFO:mri_vit_model:  Missing: ['head.1.weight', 'head.1.bias']
/home/tanguy/medical/alzheimer/env/lib/python3.12/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
ViT backbone: 768-dim features
FT-Transformer tabular encoder: 16 -> 64
  Auxiliary losses: Enabled (MRI + Tabular classifiers)
MultiModalFusion initialized:
  MRI backbone: vit (768-dim)
  Tabular features: 16 -> 64
  Fusion method: cross_modal
  Fusion hidden: 512
Fold 1 Seed 42:   0%|          | 0/50 [00:00<?, ?it/s]Fold 1 Seed 42:   0%|          | 0/50 [03:15<?, ?it/s, train_acc=58.9%, val_acc=77.5%]Fold 1 Seed 42:   2%|â–         | 1/50 [03:15<2:39:48, 195.68s/it, train_acc=58.9%, val_acc=77.5%]Fold 1 Seed 42:   2%|â–         | 1/50 [06:28<2:39:48, 195.68s/it, train_acc=80.5%, val_acc=86.6%]Fold 1 Seed 42:   4%|â–         | 2/50 [06:29<2:35:26, 194.31s/it, train_acc=80.5%, val_acc=86.6%]Fold 1 Seed 42:   4%|â–         | 2/50 [09:20<2:35:26, 194.31s/it, train_acc=88.0%, val_acc=86.0%]Fold 1 Seed 42:   6%|â–Œ         | 3/50 [09:20<2:23:58, 183.79s/it, train_acc=88.0%, val_acc=86.0%]Fold 1 Seed 42:   6%|â–Œ         | 3/50 [12:10<2:23:58, 183.79s/it, train_acc=88.0%, val_acc=86.8%]Fold 1 Seed 42:   8%|â–Š         | 4/50 [12:10<2:16:45, 178.38s/it, train_acc=88.0%, val_acc=86.8%]Fold 1 Seed 42:   8%|â–Š         | 4/50 [15:03<2:16:45, 178.38s/it, train_acc=88.4%, val_acc=86.4%]Fold 1 Seed 42:  10%|â–ˆ         | 5/50 [15:03<2:12:25, 176.56s/it, train_acc=88.4%, val_acc=86.4%]Fold 1 Seed 42:  10%|â–ˆ         | 5/50 [17:55<2:12:25, 176.56s/it, train_acc=87.9%, val_acc=87.2%]Fold 1 Seed 42:  12%|â–ˆâ–        | 6/50 [17:56<2:08:25, 175.12s/it, train_acc=87.9%, val_acc=87.2%]Fold 1 Seed 42:  12%|â–ˆâ–        | 6/50 [20:49<2:08:25, 175.12s/it, train_acc=88.9%, val_acc=87.2%]Fold 1 Seed 42:  14%|â–ˆâ–        | 7/50 [20:49<2:05:07, 174.59s/it, train_acc=88.9%, val_acc=87.2%]Fold 1 Seed 42:  14%|â–ˆâ–        | 7/50 [23:41<2:05:07, 174.59s/it, train_acc=88.5%, val_acc=87.2%]Fold 1 Seed 42:  16%|â–ˆâ–Œ        | 8/50 [23:41<2:01:32, 173.62s/it, train_acc=88.5%, val_acc=87.2%]Fold 1 Seed 42:  16%|â–ˆâ–Œ        | 8/50 [26:34<2:01:32, 173.62s/it, train_acc=89.1%, val_acc=88.5%]Fold 1 Seed 42:  18%|â–ˆâ–Š        | 9/50 [26:34<1:58:33, 173.49s/it, train_acc=89.1%, val_acc=88.5%]Fold 1 Seed 42:  18%|â–ˆâ–Š        | 9/50 [29:25<1:58:33, 173.49s/it, train_acc=88.1%, val_acc=86.8%]Fold 1 Seed 42:  20%|â–ˆâ–ˆ        | 10/50 [29:25<1:55:16, 172.90s/it, train_acc=88.1%, val_acc=86.8%]Fold 1 Seed 42:  20%|â–ˆâ–ˆ        | 10/50 [32:18<1:55:16, 172.90s/it, train_acc=88.7%, val_acc=86.4%]Fold 1 Seed 42:  22%|â–ˆâ–ˆâ–       | 11/50 [32:18<1:52:14, 172.69s/it, train_acc=88.7%, val_acc=86.4%]Fold 1 Seed 42:  22%|â–ˆâ–ˆâ–       | 11/50 [35:09<1:52:14, 172.69s/it, train_acc=88.5%, val_acc=86.8%]Fold 1 Seed 42:  24%|â–ˆâ–ˆâ–       | 12/50 [35:09<1:49:12, 172.45s/it, train_acc=88.5%, val_acc=86.8%]Fold 1 Seed 42:  24%|â–ˆâ–ˆâ–       | 12/50 [38:02<1:49:12, 172.45s/it, train_acc=88.4%, val_acc=86.2%]Fold 1 Seed 42:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [38:02<1:46:16, 172.35s/it, train_acc=88.4%, val_acc=86.2%]Fold 1 Seed 42:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [40:54<1:46:16, 172.35s/it, train_acc=88.8%, val_acc=86.2%]Fold 1 Seed 42:  28%|â–ˆâ–ˆâ–Š       | 14/50 [40:54<1:43:25, 172.37s/it, train_acc=88.8%, val_acc=86.2%]Fold 1 Seed 42:  28%|â–ˆâ–ˆâ–Š       | 14/50 [43:46<1:43:25, 172.37s/it, train_acc=88.5%, val_acc=86.8%]Fold 1 Seed 42:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [43:46<1:40:32, 172.35s/it, train_acc=88.5%, val_acc=86.8%]Fold 1 Seed 42:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [46:38<1:40:32, 172.35s/it, train_acc=89.0%, val_acc=86.6%]Fold 1 Seed 42:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [46:38<1:37:31, 172.11s/it, train_acc=89.0%, val_acc=86.6%]Fold 1 Seed 42:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [49:30<1:37:31, 172.11s/it, train_acc=89.2%, val_acc=87.0%]Fold 1 Seed 42:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [49:30<1:34:35, 171.99s/it, train_acc=89.2%, val_acc=87.0%]Fold 1 Seed 42:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [52:23<1:34:35, 171.99s/it, train_acc=89.4%, val_acc=86.6%]Fold 1 Seed 42:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [52:23<1:31:59, 172.50s/it, train_acc=89.4%, val_acc=86.6%]Fold 1 Seed 42:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [55:14<1:31:59, 172.50s/it, train_acc=88.8%, val_acc=85.8%]Fold 1 Seed 42:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [55:14<1:28:51, 171.97s/it, train_acc=88.8%, val_acc=85.8%]Fold 1 Seed 42:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [58:07<1:28:51, 171.97s/it, train_acc=89.0%, val_acc=87.0%]Fold 1 Seed 42:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [58:07<1:26:09, 172.31s/it, train_acc=89.0%, val_acc=87.0%]Fold 1 Seed 42:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [1:01:00<1:26:09, 172.31s/it, train_acc=89.1%, val_acc=86.8%]Fold 1 Seed 42:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:01:00<1:23:22, 172.51s/it, train_acc=89.1%, val_acc=86.8%]Fold 1 Seed 42:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:03:52<1:23:22, 172.51s/it, train_acc=89.0%, val_acc=86.8%]Fold 1 Seed 42:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:03:52<1:20:27, 172.42s/it, train_acc=89.0%, val_acc=86.8%]Fold 1 Seed 42:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:06:45<1:20:27, 172.42s/it, train_acc=89.0%, val_acc=86.6%]Fold 1 Seed 42:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:06:45<1:17:41, 172.65s/it, train_acc=89.0%, val_acc=86.6%]Fold 1 Seed 42:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:09:37<1:17:41, 172.65s/it, train_acc=89.3%, val_acc=86.8%]Fold 1 Seed 42:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:09:37<1:21:44, 181.65s/it, train_acc=89.3%, val_acc=86.8%]
INFO:__main__:  Subgroup Analysis:
INFO:__main__:    AD: 100.0% (42 samples)
INFO:__main__:    AD_trajectory: 45.6% (160 samples)
INFO:__main__:    CN: 97.7% (950 samples)
INFO:__main__:    MCI_to_AD: 77.0% (61 samples)
INFO:__main__:Fold 1 - Val: 88.45%, Test: 89.86%, Balanced: 79.64%
INFO:__main__:
--- Fold 2/5 ---
INFO:__main__:Train: 4367, Val: 485, Test: 1213
INFO:dataset:Filled 2 missing values in 'AGE' with 69.00
INFO:dataset:Filled 12 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 504 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 510 missing values in 'TRAASCOR' with 30.00
INFO:dataset:Filled 556 missing values in 'TRABSCOR' with 76.00
INFO:dataset:Filled 3333 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 3335 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 3323 missing values in 'BNTTOTAL' with 24.00
INFO:dataset:Filled 2395 missing values in 'VSWEIGHT' with 165.00
INFO:dataset:Filled 2387 missing values in 'BMI' with 29.40
INFO:dataset:Filled 2615 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 2615 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 2615 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 2615 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 4367 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 3415 (78.2%)
INFO:dataset:  Class 1: 952 (21.8%)
INFO:dataset:Filled 1 missing values in 'AGE' with 69.10
INFO:dataset:Filled 2 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 48 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 49 missing values in 'TRAASCOR' with 32.00
INFO:dataset:Filled 53 missing values in 'TRABSCOR' with 80.50
INFO:dataset:Filled 374 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 375 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 374 missing values in 'BNTTOTAL' with 22.00
INFO:dataset:Filled 281 missing values in 'VSWEIGHT' with 171.30
INFO:dataset:Filled 282 missing values in 'BMI' with 31.20
INFO:dataset:Filled 307 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 307 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 307 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 307 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 485 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 382 (78.8%)
INFO:dataset:  Class 1: 103 (21.2%)
INFO:dataset:Filled 1 missing values in 'AGE' with 69.00
INFO:dataset:Filled 2 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 132 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 134 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 144 missing values in 'TRABSCOR' with 77.00
INFO:dataset:Filled 931 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 932 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 928 missing values in 'BNTTOTAL' with 22.00
INFO:dataset:Filled 657 missing values in 'VSWEIGHT' with 164.00
INFO:dataset:Filled 657 missing values in 'BMI' with 29.45
INFO:dataset:Filled 742 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 740 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 740 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 740 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 1213 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 950 (78.3%)
INFO:dataset:  Class 1: 263 (21.7%)
INFO:mri_vit_model:Created ViT3DClassifier with vit_base
INFO:mri_vit_model:  Image size: 128x128x128
INFO:mri_vit_model:  Patch size: 16
INFO:mri_vit_model:  Num patches: 512
INFO:mri_vit_model:  Embed dim: 768, Depth: 12, Heads: 12
INFO:mri_vit_model:Loading MAE pre-trained weights from ../mri_vit_ad/pretrained/vit_mae75_pretrained.pth
INFO:mri_vit_model:  Loaded pos_embed directly (shapes match: torch.Size([1, 513, 768]))
INFO:mri_vit_model:Loaded 150 pretrained weights (including pos_embed, cls_token, patch_embed if matched)
INFO:mri_vit_model:Missing keys: 2
INFO:mri_vit_model:  Missing: ['head.1.weight', 'head.1.bias']
/home/tanguy/medical/alzheimer/env/lib/python3.12/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
ViT backbone: 768-dim features
FT-Transformer tabular encoder: 16 -> 64
  Auxiliary losses: Enabled (MRI + Tabular classifiers)
MultiModalFusion initialized:
  MRI backbone: vit (768-dim)
  Tabular features: 16 -> 64
  Fusion method: cross_modal
  Fusion hidden: 512
Fold 2 Seed 42:   0%|          | 0/50 [00:00<?, ?it/s]Fold 2 Seed 42:   0%|          | 0/50 [02:52<?, ?it/s, train_acc=61.3%, val_acc=79.2%]Fold 2 Seed 42:   2%|â–         | 1/50 [02:52<2:21:16, 172.99s/it, train_acc=61.3%, val_acc=79.2%]Fold 2 Seed 42:   2%|â–         | 1/50 [05:43<2:21:16, 172.99s/it, train_acc=80.6%, val_acc=87.2%]Fold 2 Seed 42:   4%|â–         | 2/50 [05:43<2:17:21, 171.69s/it, train_acc=80.6%, val_acc=87.2%]Fold 2 Seed 42:   4%|â–         | 2/50 [08:34<2:17:21, 171.69s/it, train_acc=87.5%, val_acc=87.6%]Fold 2 Seed 42:   6%|â–Œ         | 3/50 [08:35<2:14:22, 171.54s/it, train_acc=87.5%, val_acc=87.6%]Fold 2 Seed 42:   6%|â–Œ         | 3/50 [11:29<2:14:22, 171.54s/it, train_acc=88.2%, val_acc=86.8%]Fold 2 Seed 42:   8%|â–Š         | 4/50 [11:29<2:12:18, 172.57s/it, train_acc=88.2%, val_acc=86.8%]Fold 2 Seed 42:   8%|â–Š         | 4/50 [14:21<2:12:18, 172.57s/it, train_acc=88.6%, val_acc=87.6%]Fold 2 Seed 42:  10%|â–ˆ         | 5/50 [14:21<2:09:25, 172.56s/it, train_acc=88.6%, val_acc=87.6%]Fold 2 Seed 42:  10%|â–ˆ         | 5/50 [17:13<2:09:25, 172.56s/it, train_acc=88.7%, val_acc=86.8%]Fold 2 Seed 42:  12%|â–ˆâ–        | 6/50 [17:13<2:06:24, 172.38s/it, train_acc=88.7%, val_acc=86.8%]Fold 2 Seed 42:  12%|â–ˆâ–        | 6/50 [20:06<2:06:24, 172.38s/it, train_acc=89.2%, val_acc=88.0%]Fold 2 Seed 42:  14%|â–ˆâ–        | 7/50 [20:06<2:03:32, 172.38s/it, train_acc=89.2%, val_acc=88.0%]Fold 2 Seed 42:  14%|â–ˆâ–        | 7/50 [22:59<2:03:32, 172.38s/it, train_acc=89.3%, val_acc=87.6%]Fold 2 Seed 42:  16%|â–ˆâ–Œ        | 8/50 [22:59<2:00:49, 172.60s/it, train_acc=89.3%, val_acc=87.6%]Fold 2 Seed 42:  16%|â–ˆâ–Œ        | 8/50 [25:50<2:00:49, 172.60s/it, train_acc=89.8%, val_acc=88.9%]Fold 2 Seed 42:  18%|â–ˆâ–Š        | 9/50 [25:50<1:57:37, 172.13s/it, train_acc=89.8%, val_acc=88.9%]Fold 2 Seed 42:  18%|â–ˆâ–Š        | 9/50 [28:43<1:57:37, 172.13s/it, train_acc=90.0%, val_acc=90.5%]Fold 2 Seed 42:  20%|â–ˆâ–ˆ        | 10/50 [28:43<1:54:58, 172.46s/it, train_acc=90.0%, val_acc=90.5%]Fold 2 Seed 42:  20%|â–ˆâ–ˆ        | 10/50 [31:42<1:54:58, 172.46s/it, train_acc=90.5%, val_acc=88.7%]Fold 2 Seed 42:  22%|â–ˆâ–ˆâ–       | 11/50 [31:42<1:53:18, 174.32s/it, train_acc=90.5%, val_acc=88.7%]Fold 2 Seed 42:  22%|â–ˆâ–ˆâ–       | 11/50 [34:40<1:53:18, 174.32s/it, train_acc=91.0%, val_acc=90.9%]Fold 2 Seed 42:  24%|â–ˆâ–ˆâ–       | 12/50 [34:40<1:51:07, 175.46s/it, train_acc=91.0%, val_acc=90.9%]Fold 2 Seed 42:  24%|â–ˆâ–ˆâ–       | 12/50 [37:39<1:51:07, 175.46s/it, train_acc=91.5%, val_acc=90.1%]Fold 2 Seed 42:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [37:39<1:48:55, 176.65s/it, train_acc=91.5%, val_acc=90.1%]Fold 2 Seed 42:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [40:37<1:48:55, 176.65s/it, train_acc=91.7%, val_acc=89.9%]Fold 2 Seed 42:  28%|â–ˆâ–ˆâ–Š       | 14/50 [40:37<1:46:17, 177.16s/it, train_acc=91.7%, val_acc=89.9%]Fold 2 Seed 42:  28%|â–ˆâ–ˆâ–Š       | 14/50 [43:35<1:46:17, 177.16s/it, train_acc=91.7%, val_acc=89.3%]Fold 2 Seed 42:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [43:35<1:43:22, 177.22s/it, train_acc=91.7%, val_acc=89.3%]Fold 2 Seed 42:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [46:34<1:43:22, 177.22s/it, train_acc=92.0%, val_acc=91.5%]Fold 2 Seed 42:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [46:34<1:40:48, 177.90s/it, train_acc=92.0%, val_acc=91.5%]Fold 2 Seed 42:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [49:33<1:40:48, 177.90s/it, train_acc=92.3%, val_acc=90.7%]Fold 2 Seed 42:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [49:33<1:38:03, 178.28s/it, train_acc=92.3%, val_acc=90.7%]Fold 2 Seed 42:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [52:30<1:38:03, 178.28s/it, train_acc=92.7%, val_acc=90.5%]Fold 2 Seed 42:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [52:30<1:34:44, 177.65s/it, train_acc=92.7%, val_acc=90.5%]Fold 2 Seed 42:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [55:28<1:34:44, 177.65s/it, train_acc=92.7%, val_acc=92.2%]Fold 2 Seed 42:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [55:29<1:31:59, 178.05s/it, train_acc=92.7%, val_acc=92.2%]Fold 2 Seed 42:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [58:28<1:31:59, 178.05s/it, train_acc=93.0%, val_acc=91.3%]Fold 2 Seed 42:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [58:28<1:29:12, 178.40s/it, train_acc=93.0%, val_acc=91.3%]Fold 2 Seed 42:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [1:01:28<1:29:12, 178.40s/it, train_acc=93.4%, val_acc=91.8%]Fold 2 Seed 42:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:01:28<1:26:27, 178.89s/it, train_acc=93.4%, val_acc=91.8%]Fold 2 Seed 42:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:04:27<1:26:27, 178.89s/it, train_acc=93.5%, val_acc=92.0%]Fold 2 Seed 42:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:04:27<1:23:29, 178.91s/it, train_acc=93.5%, val_acc=92.0%]Fold 2 Seed 42:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:07:25<1:23:29, 178.91s/it, train_acc=93.8%, val_acc=91.3%]Fold 2 Seed 42:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:07:25<1:20:26, 178.77s/it, train_acc=93.8%, val_acc=91.3%]Fold 2 Seed 42:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:10:24<1:20:26, 178.77s/it, train_acc=94.3%, val_acc=90.7%]Fold 2 Seed 42:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:10:24<1:17:30, 178.85s/it, train_acc=94.3%, val_acc=90.7%]Fold 2 Seed 42:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:13:25<1:17:30, 178.85s/it, train_acc=94.2%, val_acc=90.7%]Fold 2 Seed 42:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:13:25<1:14:42, 179.29s/it, train_acc=94.2%, val_acc=90.7%]Fold 2 Seed 42:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:16:22<1:14:42, 179.29s/it, train_acc=94.6%, val_acc=90.7%]Fold 2 Seed 42:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:16:22<1:11:28, 178.70s/it, train_acc=94.6%, val_acc=90.7%]Fold 2 Seed 42:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:19:20<1:11:28, 178.70s/it, train_acc=94.7%, val_acc=91.5%]Fold 2 Seed 42:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:19:20<1:08:25, 178.50s/it, train_acc=94.7%, val_acc=91.5%]Fold 2 Seed 42:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:22:18<1:08:25, 178.50s/it, train_acc=95.8%, val_acc=91.3%]Fold 2 Seed 42:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:22:18<1:05:24, 178.41s/it, train_acc=95.8%, val_acc=91.3%]Fold 2 Seed 42:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:25:16<1:05:24, 178.41s/it, train_acc=95.4%, val_acc=91.5%]Fold 2 Seed 42:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:25:16<1:02:21, 178.17s/it, train_acc=95.4%, val_acc=91.5%]Fold 2 Seed 42:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:28:14<1:02:21, 178.17s/it, train_acc=96.0%, val_acc=91.5%]Fold 2 Seed 42:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:28:14<59:23, 178.18s/it, train_acc=96.0%, val_acc=91.5%]  Fold 2 Seed 42:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:31:13<59:23, 178.18s/it, train_acc=95.8%, val_acc=90.5%]Fold 2 Seed 42:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:31:13<56:32, 178.53s/it, train_acc=95.8%, val_acc=90.5%]Fold 2 Seed 42:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:34:11<56:32, 178.53s/it, train_acc=96.4%, val_acc=91.1%]Fold 2 Seed 42:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:34:11<53:31, 178.40s/it, train_acc=96.4%, val_acc=91.1%]Fold 2 Seed 42:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:37:10<53:31, 178.40s/it, train_acc=96.0%, val_acc=91.5%]Fold 2 Seed 42:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:37:10<50:34, 178.49s/it, train_acc=96.0%, val_acc=91.5%]Fold 2 Seed 42:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:40:09<50:34, 178.49s/it, train_acc=96.4%, val_acc=91.8%]Fold 2 Seed 42:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:40:09<51:35, 182.11s/it, train_acc=96.4%, val_acc=91.8%]
INFO:__main__:  Subgroup Analysis:
INFO:__main__:    AD: 97.4% (38 samples)
INFO:__main__:    AD_trajectory: 73.6% (174 samples)
INFO:__main__:    CN: 93.7% (950 samples)
INFO:__main__:    MCI_to_AD: 84.3% (51 samples)
INFO:__main__:Fold 2 - Val: 92.16%, Test: 90.52%, Balanced: 86.39%
INFO:__main__:
--- Fold 3/5 ---
INFO:__main__:Train: 4367, Val: 485, Test: 1213
INFO:dataset:Filled 3 missing values in 'AGE' with 69.00
INFO:dataset:Filled 12 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 503 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 510 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 555 missing values in 'TRABSCOR' with 77.00
INFO:dataset:Filled 3336 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 3338 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 3323 missing values in 'BNTTOTAL' with 23.00
INFO:dataset:Filled 2384 missing values in 'VSWEIGHT' with 164.00
INFO:dataset:Filled 2378 missing values in 'BMI' with 29.40
INFO:dataset:Filled 2620 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 2618 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 2618 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 2618 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 4367 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 3422 (78.4%)
INFO:dataset:  Class 1: 945 (21.6%)
INFO:dataset:Filled 1 missing values in 'AGE' with 69.00
INFO:dataset:Filled 2 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 61 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 61 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 66 missing values in 'TRABSCOR' with 80.00
INFO:dataset:Filled 370 missing values in 'DSPANFOR' with 7.00
INFO:dataset:Filled 370 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 372 missing values in 'BNTTOTAL' with 26.00
INFO:dataset:Filled 262 missing values in 'VSWEIGHT' with 167.00
INFO:dataset:Filled 263 missing values in 'BMI' with 28.90
INFO:dataset:Filled 289 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 289 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 289 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 289 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 485 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 376 (77.5%)
INFO:dataset:  Class 1: 109 (22.5%)
INFO:dataset:Filled 2 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 120 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 122 missing values in 'TRAASCOR' with 30.00
INFO:dataset:Filled 132 missing values in 'TRABSCOR' with 75.00
INFO:dataset:Filled 932 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 934 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 930 missing values in 'BNTTOTAL' with 23.00
INFO:dataset:Filled 687 missing values in 'VSWEIGHT' with 167.00
INFO:dataset:Filled 685 missing values in 'BMI' with 30.60
INFO:dataset:Filled 755 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 755 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 755 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 755 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 1213 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 949 (78.2%)
INFO:dataset:  Class 1: 264 (21.8%)
INFO:mri_vit_model:Created ViT3DClassifier with vit_base
INFO:mri_vit_model:  Image size: 128x128x128
INFO:mri_vit_model:  Patch size: 16
INFO:mri_vit_model:  Num patches: 512
INFO:mri_vit_model:  Embed dim: 768, Depth: 12, Heads: 12
INFO:mri_vit_model:Loading MAE pre-trained weights from ../mri_vit_ad/pretrained/vit_mae75_pretrained.pth
INFO:mri_vit_model:  Loaded pos_embed directly (shapes match: torch.Size([1, 513, 768]))
INFO:mri_vit_model:Loaded 150 pretrained weights (including pos_embed, cls_token, patch_embed if matched)
INFO:mri_vit_model:Missing keys: 2
INFO:mri_vit_model:  Missing: ['head.1.weight', 'head.1.bias']
/home/tanguy/medical/alzheimer/env/lib/python3.12/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
ViT backbone: 768-dim features
FT-Transformer tabular encoder: 16 -> 64
  Auxiliary losses: Enabled (MRI + Tabular classifiers)
MultiModalFusion initialized:
  MRI backbone: vit (768-dim)
  Tabular features: 16 -> 64
  Fusion method: cross_modal
  Fusion hidden: 512
Fold 3 Seed 42:   0%|          | 0/50 [00:00<?, ?it/s]Fold 3 Seed 42:   0%|          | 0/50 [02:51<?, ?it/s, train_acc=59.6%, val_acc=77.5%]Fold 3 Seed 42:   2%|â–         | 1/50 [02:51<2:20:26, 171.98s/it, train_acc=59.6%, val_acc=77.5%]Fold 3 Seed 42:   2%|â–         | 1/50 [05:44<2:20:26, 171.98s/it, train_acc=80.0%, val_acc=85.4%]Fold 3 Seed 42:   4%|â–         | 2/50 [05:44<2:18:04, 172.59s/it, train_acc=80.0%, val_acc=85.4%]Fold 3 Seed 42:   4%|â–         | 2/50 [08:37<2:18:04, 172.59s/it, train_acc=87.3%, val_acc=87.4%]Fold 3 Seed 42:   6%|â–Œ         | 3/50 [08:37<2:15:20, 172.77s/it, train_acc=87.3%, val_acc=87.4%]Fold 3 Seed 42:   6%|â–Œ         | 3/50 [11:30<2:15:20, 172.77s/it, train_acc=87.6%, val_acc=88.7%]Fold 3 Seed 42:   8%|â–Š         | 4/50 [11:30<2:12:29, 172.80s/it, train_acc=87.6%, val_acc=88.7%]Fold 3 Seed 42:   8%|â–Š         | 4/50 [14:22<2:12:29, 172.80s/it, train_acc=88.2%, val_acc=88.5%]Fold 3 Seed 42:  10%|â–ˆ         | 5/50 [14:23<2:09:25, 172.57s/it, train_acc=88.2%, val_acc=88.5%]Fold 3 Seed 42:  10%|â–ˆ         | 5/50 [17:15<2:09:25, 172.57s/it, train_acc=88.1%, val_acc=88.2%]Fold 3 Seed 42:  12%|â–ˆâ–        | 6/50 [17:15<2:06:29, 172.49s/it, train_acc=88.1%, val_acc=88.2%]Fold 3 Seed 42:  12%|â–ˆâ–        | 6/50 [20:07<2:06:29, 172.49s/it, train_acc=88.7%, val_acc=88.9%]Fold 3 Seed 42:  14%|â–ˆâ–        | 7/50 [20:07<2:03:34, 172.44s/it, train_acc=88.7%, val_acc=88.9%]Fold 3 Seed 42:  14%|â–ˆâ–        | 7/50 [22:58<2:03:34, 172.44s/it, train_acc=88.6%, val_acc=89.3%]Fold 3 Seed 42:  16%|â–ˆâ–Œ        | 8/50 [22:58<2:00:20, 171.92s/it, train_acc=88.6%, val_acc=89.3%]Fold 3 Seed 42:  16%|â–ˆâ–Œ        | 8/50 [25:51<2:00:20, 171.92s/it, train_acc=89.9%, val_acc=88.9%]Fold 3 Seed 42:  18%|â–ˆâ–Š        | 9/50 [25:51<1:57:37, 172.14s/it, train_acc=89.9%, val_acc=88.9%]Fold 3 Seed 42:  18%|â–ˆâ–Š        | 9/50 [28:44<1:57:37, 172.14s/it, train_acc=90.2%, val_acc=83.5%]Fold 3 Seed 42:  20%|â–ˆâ–ˆ        | 10/50 [28:44<1:54:56, 172.42s/it, train_acc=90.2%, val_acc=83.5%]Fold 3 Seed 42:  20%|â–ˆâ–ˆ        | 10/50 [31:37<1:54:56, 172.42s/it, train_acc=90.7%, val_acc=89.9%]Fold 3 Seed 42:  22%|â–ˆâ–ˆâ–       | 11/50 [31:37<1:52:18, 172.79s/it, train_acc=90.7%, val_acc=89.9%]Fold 3 Seed 42:  22%|â–ˆâ–ˆâ–       | 11/50 [34:28<1:52:18, 172.79s/it, train_acc=90.9%, val_acc=90.7%]Fold 3 Seed 42:  24%|â–ˆâ–ˆâ–       | 12/50 [34:28<1:49:07, 172.30s/it, train_acc=90.9%, val_acc=90.7%]Fold 3 Seed 42:  24%|â–ˆâ–ˆâ–       | 12/50 [37:27<1:49:07, 172.30s/it, train_acc=91.8%, val_acc=91.3%]Fold 3 Seed 42:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [37:27<1:47:27, 174.25s/it, train_acc=91.8%, val_acc=91.3%]Fold 3 Seed 42:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [40:24<1:47:27, 174.25s/it, train_acc=91.6%, val_acc=91.1%]Fold 3 Seed 42:  28%|â–ˆâ–ˆâ–Š       | 14/50 [40:24<1:45:05, 175.15s/it, train_acc=91.6%, val_acc=91.1%]Fold 3 Seed 42:  28%|â–ˆâ–ˆâ–Š       | 14/50 [43:23<1:45:05, 175.15s/it, train_acc=91.6%, val_acc=91.5%]Fold 3 Seed 42:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [43:24<1:42:52, 176.34s/it, train_acc=91.6%, val_acc=91.5%]Fold 3 Seed 42:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [46:22<1:42:52, 176.34s/it, train_acc=92.3%, val_acc=90.5%]Fold 3 Seed 42:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [46:22<1:40:14, 176.89s/it, train_acc=92.3%, val_acc=90.5%]Fold 3 Seed 42:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [49:20<1:40:14, 176.89s/it, train_acc=91.9%, val_acc=90.9%]Fold 3 Seed 42:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [49:20<1:37:32, 177.35s/it, train_acc=91.9%, val_acc=90.9%]Fold 3 Seed 42:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [52:20<1:37:32, 177.35s/it, train_acc=92.4%, val_acc=91.3%]Fold 3 Seed 42:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [52:20<1:34:59, 178.10s/it, train_acc=92.4%, val_acc=91.3%]Fold 3 Seed 42:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [55:20<1:34:59, 178.10s/it, train_acc=92.3%, val_acc=92.0%]Fold 3 Seed 42:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [55:20<1:32:16, 178.60s/it, train_acc=92.3%, val_acc=92.0%]Fold 3 Seed 42:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [58:17<1:32:16, 178.60s/it, train_acc=92.2%, val_acc=92.0%]Fold 3 Seed 42:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [58:17<1:29:04, 178.16s/it, train_acc=92.2%, val_acc=92.0%]Fold 3 Seed 42:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [1:01:16<1:29:04, 178.16s/it, train_acc=92.6%, val_acc=91.5%]Fold 3 Seed 42:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:01:16<1:26:18, 178.57s/it, train_acc=92.6%, val_acc=91.5%]Fold 3 Seed 42:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:04:15<1:26:18, 178.57s/it, train_acc=92.9%, val_acc=91.1%]Fold 3 Seed 42:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:04:15<1:23:21, 178.62s/it, train_acc=92.9%, val_acc=91.1%]Fold 3 Seed 42:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:07:14<1:23:21, 178.62s/it, train_acc=93.1%, val_acc=92.6%]Fold 3 Seed 42:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:07:14<1:20:24, 178.70s/it, train_acc=93.1%, val_acc=92.6%]Fold 3 Seed 42:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:10:13<1:20:24, 178.70s/it, train_acc=93.4%, val_acc=92.0%]Fold 3 Seed 42:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:10:13<1:17:24, 178.65s/it, train_acc=93.4%, val_acc=92.0%]Fold 3 Seed 42:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:13:12<1:17:24, 178.65s/it, train_acc=93.4%, val_acc=91.8%]Fold 3 Seed 42:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:13:12<1:14:28, 178.76s/it, train_acc=93.4%, val_acc=91.8%]Fold 3 Seed 42:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:16:10<1:14:28, 178.76s/it, train_acc=93.7%, val_acc=92.0%]Fold 3 Seed 42:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:16:10<1:11:31, 178.79s/it, train_acc=93.7%, val_acc=92.0%]Fold 3 Seed 42:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:19:09<1:11:31, 178.79s/it, train_acc=93.6%, val_acc=92.0%]Fold 3 Seed 42:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:19:09<1:08:33, 178.86s/it, train_acc=93.6%, val_acc=92.0%]Fold 3 Seed 42:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:22:09<1:08:33, 178.86s/it, train_acc=94.2%, val_acc=90.9%]Fold 3 Seed 42:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:22:09<1:05:38, 179.01s/it, train_acc=94.2%, val_acc=90.9%]Fold 3 Seed 42:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:25:09<1:05:38, 179.01s/it, train_acc=94.3%, val_acc=90.9%]Fold 3 Seed 42:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:25:09<1:02:48, 179.44s/it, train_acc=94.3%, val_acc=90.9%]Fold 3 Seed 42:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:28:07<1:02:48, 179.44s/it, train_acc=94.5%, val_acc=91.5%]Fold 3 Seed 42:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:28:07<59:39, 178.98s/it, train_acc=94.5%, val_acc=91.5%]  Fold 3 Seed 42:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:31:06<59:39, 178.98s/it, train_acc=94.9%, val_acc=91.8%]Fold 3 Seed 42:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:31:06<56:37, 178.81s/it, train_acc=94.9%, val_acc=91.8%]Fold 3 Seed 42:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:34:02<56:37, 178.81s/it, train_acc=94.9%, val_acc=90.7%]Fold 3 Seed 42:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:34:02<53:28, 178.23s/it, train_acc=94.9%, val_acc=90.7%]Fold 3 Seed 42:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:37:01<53:28, 178.23s/it, train_acc=94.7%, val_acc=91.5%]Fold 3 Seed 42:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:37:01<50:33, 178.43s/it, train_acc=94.7%, val_acc=91.5%]Fold 3 Seed 42:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:40:00<50:33, 178.43s/it, train_acc=94.9%, val_acc=92.0%]Fold 3 Seed 42:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 34/50 [1:40:00<47:38, 178.64s/it, train_acc=94.9%, val_acc=92.0%]Fold 3 Seed 42:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 34/50 [1:42:59<47:38, 178.64s/it, train_acc=95.3%, val_acc=92.0%]Fold 3 Seed 42:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 35/50 [1:42:59<44:37, 178.47s/it, train_acc=95.3%, val_acc=92.0%]Fold 3 Seed 42:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 35/50 [1:45:59<44:37, 178.47s/it, train_acc=95.2%, val_acc=91.5%]Fold 3 Seed 42:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [1:45:59<41:47, 179.09s/it, train_acc=95.2%, val_acc=91.5%]Fold 3 Seed 42:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [1:48:58<41:47, 179.09s/it, train_acc=95.6%, val_acc=92.0%]Fold 3 Seed 42:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 37/50 [1:48:58<38:45, 178.92s/it, train_acc=95.6%, val_acc=92.0%]Fold 3 Seed 42:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 37/50 [1:51:58<38:45, 178.92s/it, train_acc=95.7%, val_acc=92.2%]Fold 3 Seed 42:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 37/50 [1:51:58<39:20, 181.59s/it, train_acc=95.7%, val_acc=92.2%]
INFO:__main__:  Subgroup Analysis:
INFO:__main__:    AD: 87.5% (48 samples)
INFO:__main__:    AD_trajectory: 67.5% (169 samples)
INFO:__main__:    CN: 96.3% (949 samples)
INFO:__main__:    MCI_to_AD: 78.7% (47 samples)
INFO:__main__:Fold 3 - Val: 92.58%, Test: 91.26%, Balanced: 84.71%
INFO:__main__:
--- Fold 4/5 ---
INFO:__main__:Train: 4367, Val: 485, Test: 1213
INFO:dataset:Filled 2 missing values in 'AGE' with 69.00
INFO:dataset:Filled 10 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 500 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 504 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 548 missing values in 'TRABSCOR' with 78.00
INFO:dataset:Filled 3345 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 3349 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 3338 missing values in 'BNTTOTAL' with 23.00
INFO:dataset:Filled 2394 missing values in 'VSWEIGHT' with 164.00
INFO:dataset:Filled 2390 missing values in 'BMI' with 29.68
INFO:dataset:Filled 2645 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 2644 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 2644 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 2644 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 4367 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 3413 (78.2%)
INFO:dataset:  Class 1: 954 (21.8%)
INFO:dataset:Filled 3 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 52 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 55 missing values in 'TRAASCOR' with 30.00
INFO:dataset:Filled 56 missing values in 'TRABSCOR' with 73.00
INFO:dataset:Filled 366 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 366 missing values in 'DSPANBAC' with 3.00
INFO:dataset:Filled 367 missing values in 'BNTTOTAL' with 23.00
INFO:dataset:Filled 259 missing values in 'VSWEIGHT' with 170.20
INFO:dataset:Filled 259 missing values in 'BMI' with 29.80
INFO:dataset:Filled 290 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 289 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 289 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 289 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 485 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 385 (79.4%)
INFO:dataset:  Class 1: 100 (20.6%)
INFO:dataset:Filled 2 missing values in 'AGE' with 69.70
INFO:dataset:Filled 3 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 132 missing values in 'CATANIMSC' with 21.00
INFO:dataset:Filled 134 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 149 missing values in 'TRABSCOR' with 76.50
INFO:dataset:Filled 927 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 927 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 920 missing values in 'BNTTOTAL' with 24.00
INFO:dataset:Filled 680 missing values in 'VSWEIGHT' with 166.00
INFO:dataset:Filled 677 missing values in 'BMI' with 29.16
INFO:dataset:Filled 729 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 729 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 729 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 729 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 1213 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 949 (78.2%)
INFO:dataset:  Class 1: 264 (21.8%)
INFO:mri_vit_model:Created ViT3DClassifier with vit_base
INFO:mri_vit_model:  Image size: 128x128x128
INFO:mri_vit_model:  Patch size: 16
INFO:mri_vit_model:  Num patches: 512
INFO:mri_vit_model:  Embed dim: 768, Depth: 12, Heads: 12
INFO:mri_vit_model:Loading MAE pre-trained weights from ../mri_vit_ad/pretrained/vit_mae75_pretrained.pth
INFO:mri_vit_model:  Loaded pos_embed directly (shapes match: torch.Size([1, 513, 768]))
INFO:mri_vit_model:Loaded 150 pretrained weights (including pos_embed, cls_token, patch_embed if matched)
INFO:mri_vit_model:Missing keys: 2
INFO:mri_vit_model:  Missing: ['head.1.weight', 'head.1.bias']
/home/tanguy/medical/alzheimer/env/lib/python3.12/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
ViT backbone: 768-dim features
FT-Transformer tabular encoder: 16 -> 64
  Auxiliary losses: Enabled (MRI + Tabular classifiers)
MultiModalFusion initialized:
  MRI backbone: vit (768-dim)
  Tabular features: 16 -> 64
  Fusion method: cross_modal
  Fusion hidden: 512
Fold 4 Seed 42:   0%|          | 0/50 [00:00<?, ?it/s]Fold 4 Seed 42:   0%|          | 0/50 [02:53<?, ?it/s, train_acc=60.1%, val_acc=79.4%]Fold 4 Seed 42:   2%|â–         | 1/50 [02:53<2:21:50, 173.69s/it, train_acc=60.1%, val_acc=79.4%]Fold 4 Seed 42:   2%|â–         | 1/50 [05:45<2:21:50, 173.69s/it, train_acc=80.1%, val_acc=88.5%]Fold 4 Seed 42:   4%|â–         | 2/50 [05:45<2:18:15, 172.82s/it, train_acc=80.1%, val_acc=88.5%]Fold 4 Seed 42:   4%|â–         | 2/50 [08:39<2:18:15, 172.82s/it, train_acc=87.5%, val_acc=89.5%]Fold 4 Seed 42:   6%|â–Œ         | 3/50 [08:39<2:15:33, 173.05s/it, train_acc=87.5%, val_acc=89.5%]Fold 4 Seed 42:   6%|â–Œ         | 3/50 [11:32<2:15:33, 173.05s/it, train_acc=88.0%, val_acc=89.5%]Fold 4 Seed 42:   8%|â–Š         | 4/50 [11:32<2:12:51, 173.30s/it, train_acc=88.0%, val_acc=89.5%]Fold 4 Seed 42:   8%|â–Š         | 4/50 [14:24<2:12:51, 173.30s/it, train_acc=88.1%, val_acc=88.9%]Fold 4 Seed 42:  10%|â–ˆ         | 5/50 [14:24<2:09:25, 172.57s/it, train_acc=88.1%, val_acc=88.9%]Fold 4 Seed 42:  10%|â–ˆ         | 5/50 [17:17<2:09:25, 172.57s/it, train_acc=87.3%, val_acc=89.1%]Fold 4 Seed 42:  12%|â–ˆâ–        | 6/50 [17:17<2:06:41, 172.75s/it, train_acc=87.3%, val_acc=89.1%]Fold 4 Seed 42:  12%|â–ˆâ–        | 6/50 [20:09<2:06:41, 172.75s/it, train_acc=88.3%, val_acc=89.3%]Fold 4 Seed 42:  14%|â–ˆâ–        | 7/50 [20:09<2:03:36, 172.48s/it, train_acc=88.3%, val_acc=89.3%]Fold 4 Seed 42:  14%|â–ˆâ–        | 7/50 [23:03<2:03:36, 172.48s/it, train_acc=88.8%, val_acc=88.9%]Fold 4 Seed 42:  16%|â–ˆâ–Œ        | 8/50 [23:03<2:01:02, 172.92s/it, train_acc=88.8%, val_acc=88.9%]Fold 4 Seed 42:  16%|â–ˆâ–Œ        | 8/50 [25:55<2:01:02, 172.92s/it, train_acc=88.9%, val_acc=90.5%]Fold 4 Seed 42:  18%|â–ˆâ–Š        | 9/50 [25:55<1:58:03, 172.76s/it, train_acc=88.9%, val_acc=90.5%]Fold 4 Seed 42:  18%|â–ˆâ–Š        | 9/50 [28:50<1:58:03, 172.76s/it, train_acc=89.7%, val_acc=90.7%]Fold 4 Seed 42:  20%|â–ˆâ–ˆ        | 10/50 [28:50<1:55:34, 173.36s/it, train_acc=89.7%, val_acc=90.7%]Fold 4 Seed 42:  20%|â–ˆâ–ˆ        | 10/50 [31:43<1:55:34, 173.36s/it, train_acc=90.8%, val_acc=91.3%]Fold 4 Seed 42:  22%|â–ˆâ–ˆâ–       | 11/50 [31:43<1:52:36, 173.23s/it, train_acc=90.8%, val_acc=91.3%]Fold 4 Seed 42:  22%|â–ˆâ–ˆâ–       | 11/50 [34:34<1:52:36, 173.23s/it, train_acc=91.0%, val_acc=90.7%]Fold 4 Seed 42:  24%|â–ˆâ–ˆâ–       | 12/50 [34:34<1:49:24, 172.75s/it, train_acc=91.0%, val_acc=90.7%]Fold 4 Seed 42:  24%|â–ˆâ–ˆâ–       | 12/50 [37:29<1:49:24, 172.75s/it, train_acc=91.4%, val_acc=88.9%]Fold 4 Seed 42:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [37:29<1:46:50, 173.27s/it, train_acc=91.4%, val_acc=88.9%]Fold 4 Seed 42:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [40:23<1:46:50, 173.27s/it, train_acc=91.2%, val_acc=90.7%]Fold 4 Seed 42:  28%|â–ˆâ–ˆâ–Š       | 14/50 [40:23<1:44:10, 173.63s/it, train_acc=91.2%, val_acc=90.7%]Fold 4 Seed 42:  28%|â–ˆâ–ˆâ–Š       | 14/50 [43:17<1:44:10, 173.63s/it, train_acc=91.9%, val_acc=91.1%]Fold 4 Seed 42:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [43:17<1:41:14, 173.56s/it, train_acc=91.9%, val_acc=91.1%]Fold 4 Seed 42:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [46:10<1:41:14, 173.56s/it, train_acc=92.2%, val_acc=91.3%]Fold 4 Seed 42:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [46:10<1:38:17, 173.46s/it, train_acc=92.2%, val_acc=91.3%]Fold 4 Seed 42:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [49:02<1:38:17, 173.46s/it, train_acc=92.0%, val_acc=91.5%]Fold 4 Seed 42:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [49:02<1:35:11, 173.08s/it, train_acc=92.0%, val_acc=91.5%]Fold 4 Seed 42:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [51:56<1:35:11, 173.08s/it, train_acc=92.5%, val_acc=91.8%]Fold 4 Seed 42:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [51:56<1:32:31, 173.48s/it, train_acc=92.5%, val_acc=91.8%]Fold 4 Seed 42:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [54:54<1:32:31, 173.48s/it, train_acc=92.9%, val_acc=90.9%]Fold 4 Seed 42:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [54:54<1:30:15, 174.68s/it, train_acc=92.9%, val_acc=90.9%]Fold 4 Seed 42:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [57:48<1:30:15, 174.68s/it, train_acc=92.9%, val_acc=92.6%]Fold 4 Seed 42:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [57:48<1:27:16, 174.56s/it, train_acc=92.9%, val_acc=92.6%]Fold 4 Seed 42:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [1:00:45<1:27:16, 174.56s/it, train_acc=93.1%, val_acc=89.5%]Fold 4 Seed 42:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:00:45<1:24:45, 175.37s/it, train_acc=93.1%, val_acc=89.5%]Fold 4 Seed 42:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:03:45<1:24:45, 175.37s/it, train_acc=93.2%, val_acc=92.2%]Fold 4 Seed 42:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:03:45<1:22:22, 176.53s/it, train_acc=93.2%, val_acc=92.2%]Fold 4 Seed 42:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:06:42<1:22:22, 176.53s/it, train_acc=93.9%, val_acc=92.2%]Fold 4 Seed 42:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:06:42<1:19:33, 176.80s/it, train_acc=93.9%, val_acc=92.2%]Fold 4 Seed 42:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:09:40<1:19:33, 176.80s/it, train_acc=93.8%, val_acc=92.2%]Fold 4 Seed 42:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:09:40<1:16:46, 177.15s/it, train_acc=93.8%, val_acc=92.2%]Fold 4 Seed 42:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:12:38<1:16:46, 177.15s/it, train_acc=93.5%, val_acc=92.4%]Fold 4 Seed 42:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:12:38<1:13:53, 177.36s/it, train_acc=93.5%, val_acc=92.4%]Fold 4 Seed 42:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:15:38<1:13:53, 177.36s/it, train_acc=94.2%, val_acc=92.2%]Fold 4 Seed 42:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:15:38<1:11:17, 178.22s/it, train_acc=94.2%, val_acc=92.2%]Fold 4 Seed 42:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:18:35<1:11:17, 178.22s/it, train_acc=94.2%, val_acc=92.2%]Fold 4 Seed 42:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:18:35<1:08:12, 177.92s/it, train_acc=94.2%, val_acc=92.2%]Fold 4 Seed 42:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:21:37<1:08:12, 177.92s/it, train_acc=94.3%, val_acc=92.2%]Fold 4 Seed 42:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:21:37<1:05:35, 178.90s/it, train_acc=94.3%, val_acc=92.2%]Fold 4 Seed 42:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:24:35<1:05:35, 178.90s/it, train_acc=94.7%, val_acc=90.5%]Fold 4 Seed 42:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:24:35<1:02:33, 178.72s/it, train_acc=94.7%, val_acc=90.5%]Fold 4 Seed 42:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:27:34<1:02:33, 178.72s/it, train_acc=94.8%, val_acc=92.4%]Fold 4 Seed 42:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:27:34<59:38, 178.90s/it, train_acc=94.8%, val_acc=92.4%]  Fold 4 Seed 42:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:30:32<59:38, 178.90s/it, train_acc=94.8%, val_acc=92.4%]Fold 4 Seed 42:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:30:32<56:32, 178.58s/it, train_acc=94.8%, val_acc=92.4%]Fold 4 Seed 42:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:33:33<56:32, 178.58s/it, train_acc=95.1%, val_acc=91.3%]Fold 4 Seed 42:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:33:33<53:45, 179.18s/it, train_acc=95.1%, val_acc=91.3%]Fold 4 Seed 42:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:36:31<53:45, 179.18s/it, train_acc=95.3%, val_acc=92.4%]Fold 4 Seed 42:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:36:31<50:43, 179.03s/it, train_acc=95.3%, val_acc=92.4%]Fold 4 Seed 42:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:39:31<50:43, 179.03s/it, train_acc=95.5%, val_acc=92.8%]Fold 4 Seed 42:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 34/50 [1:39:31<47:46, 179.13s/it, train_acc=95.5%, val_acc=92.8%]Fold 4 Seed 42:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 34/50 [1:42:30<47:46, 179.13s/it, train_acc=95.7%, val_acc=92.8%]Fold 4 Seed 42:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 35/50 [1:42:30<44:48, 179.24s/it, train_acc=95.7%, val_acc=92.8%]Fold 4 Seed 42:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 35/50 [1:45:27<44:48, 179.24s/it, train_acc=96.1%, val_acc=92.0%]Fold 4 Seed 42:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [1:45:27<41:40, 178.63s/it, train_acc=96.1%, val_acc=92.0%]Fold 4 Seed 42:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [1:48:25<41:40, 178.63s/it, train_acc=96.2%, val_acc=92.4%]Fold 4 Seed 42:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 37/50 [1:48:25<38:39, 178.42s/it, train_acc=96.2%, val_acc=92.4%]Fold 4 Seed 42:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 37/50 [1:51:24<38:39, 178.42s/it, train_acc=96.4%, val_acc=92.0%]Fold 4 Seed 42:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 38/50 [1:51:24<35:42, 178.53s/it, train_acc=96.4%, val_acc=92.0%]Fold 4 Seed 42:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 38/50 [1:54:24<35:42, 178.53s/it, train_acc=96.6%, val_acc=92.2%]Fold 4 Seed 42:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 39/50 [1:54:24<32:47, 178.86s/it, train_acc=96.6%, val_acc=92.2%]Fold 4 Seed 42:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 39/50 [1:57:23<32:47, 178.86s/it, train_acc=96.6%, val_acc=89.9%]Fold 4 Seed 42:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 40/50 [1:57:23<29:49, 178.95s/it, train_acc=96.6%, val_acc=89.9%]Fold 4 Seed 42:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 40/50 [2:00:22<29:49, 178.95s/it, train_acc=96.8%, val_acc=90.9%]Fold 4 Seed 42:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 41/50 [2:00:22<26:51, 179.11s/it, train_acc=96.8%, val_acc=90.9%]Fold 4 Seed 42:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 41/50 [2:03:21<26:51, 179.11s/it, train_acc=97.1%, val_acc=92.4%]Fold 4 Seed 42:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 42/50 [2:03:21<23:52, 179.04s/it, train_acc=97.1%, val_acc=92.4%]Fold 4 Seed 42:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 42/50 [2:06:18<23:52, 179.04s/it, train_acc=96.9%, val_acc=89.5%]Fold 4 Seed 42:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 43/50 [2:06:19<20:49, 178.53s/it, train_acc=96.9%, val_acc=89.5%]Fold 4 Seed 42:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 43/50 [2:09:18<20:49, 178.53s/it, train_acc=97.2%, val_acc=90.3%]Fold 4 Seed 42:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 44/50 [2:09:18<17:52, 178.78s/it, train_acc=97.2%, val_acc=90.3%]Fold 4 Seed 42:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 44/50 [2:12:16<17:52, 178.78s/it, train_acc=97.2%, val_acc=91.3%]Fold 4 Seed 42:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 45/50 [2:12:16<14:52, 178.44s/it, train_acc=97.2%, val_acc=91.3%]Fold 4 Seed 42:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 45/50 [2:15:17<14:52, 178.44s/it, train_acc=96.9%, val_acc=91.1%]Fold 4 Seed 42:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 46/50 [2:15:17<11:57, 179.30s/it, train_acc=96.9%, val_acc=91.1%]Fold 4 Seed 42:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 46/50 [2:18:14<11:57, 179.30s/it, train_acc=97.5%, val_acc=91.3%]Fold 4 Seed 42:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 47/50 [2:18:14<08:56, 178.74s/it, train_acc=97.5%, val_acc=91.3%]Fold 4 Seed 42:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 47/50 [2:21:12<08:56, 178.74s/it, train_acc=97.2%, val_acc=91.1%]Fold 4 Seed 42:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 48/50 [2:21:12<05:56, 178.45s/it, train_acc=97.2%, val_acc=91.1%]Fold 4 Seed 42:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 48/50 [2:24:11<05:56, 178.45s/it, train_acc=97.2%, val_acc=91.1%]Fold 4 Seed 42:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 48/50 [2:24:11<06:00, 180.24s/it, train_acc=97.2%, val_acc=91.1%]
INFO:__main__:  Subgroup Analysis:
INFO:__main__:    AD: 97.3% (37 samples)
INFO:__main__:    AD_trajectory: 77.8% (176 samples)
INFO:__main__:    CN: 94.8% (949 samples)
INFO:__main__:    MCI_to_AD: 88.2% (51 samples)
INFO:__main__:Fold 4 - Val: 92.78%, Test: 92.17%, Balanced: 88.71%
INFO:__main__:
--- Fold 5/5 ---
INFO:__main__:Train: 4367, Val: 485, Test: 1213
INFO:dataset:Filled 4 missing values in 'AGE' with 69.00
INFO:dataset:Filled 11 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 472 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 479 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 518 missing values in 'TRABSCOR' with 77.00
INFO:dataset:Filled 3322 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 3324 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 3311 missing values in 'BNTTOTAL' with 23.00
INFO:dataset:Filled 2416 missing values in 'VSWEIGHT' with 165.00
INFO:dataset:Filled 2412 missing values in 'BMI' with 29.40
INFO:dataset:Filled 2642 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 2640 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 2640 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 2640 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 4367 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 3425 (78.4%)
INFO:dataset:  Class 1: 942 (21.6%)
INFO:dataset:Filled 62 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 63 missing values in 'TRAASCOR' with 30.00
INFO:dataset:Filled 69 missing values in 'TRABSCOR' with 75.00
INFO:dataset:Filled 381 missing values in 'DSPANFOR' with 5.00
INFO:dataset:Filled 382 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 379 missing values in 'BNTTOTAL' with 23.00
INFO:dataset:Filled 261 missing values in 'VSWEIGHT' with 168.00
INFO:dataset:Filled 259 missing values in 'BMI' with 29.83
INFO:dataset:Filled 296 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 296 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 296 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 296 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 485 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 373 (76.9%)
INFO:dataset:  Class 1: 112 (23.1%)
INFO:dataset:Filled 5 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 150 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 151 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 166 missing values in 'TRABSCOR' with 78.00
INFO:dataset:Filled 935 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 936 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 935 missing values in 'BNTTOTAL' with 24.00
INFO:dataset:Filled 656 missing values in 'VSWEIGHT' with 164.20
INFO:dataset:Filled 655 missing values in 'BMI' with 30.04
INFO:dataset:Filled 726 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 726 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 726 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 726 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 1213 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 949 (78.2%)
INFO:dataset:  Class 1: 264 (21.8%)
INFO:mri_vit_model:Created ViT3DClassifier with vit_base
INFO:mri_vit_model:  Image size: 128x128x128
INFO:mri_vit_model:  Patch size: 16
INFO:mri_vit_model:  Num patches: 512
INFO:mri_vit_model:  Embed dim: 768, Depth: 12, Heads: 12
INFO:mri_vit_model:Loading MAE pre-trained weights from ../mri_vit_ad/pretrained/vit_mae75_pretrained.pth
INFO:mri_vit_model:  Loaded pos_embed directly (shapes match: torch.Size([1, 513, 768]))
INFO:mri_vit_model:Loaded 150 pretrained weights (including pos_embed, cls_token, patch_embed if matched)
INFO:mri_vit_model:Missing keys: 2
INFO:mri_vit_model:  Missing: ['head.1.weight', 'head.1.bias']
/home/tanguy/medical/alzheimer/env/lib/python3.12/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
ViT backbone: 768-dim features
FT-Transformer tabular encoder: 16 -> 64
  Auxiliary losses: Enabled (MRI + Tabular classifiers)
MultiModalFusion initialized:
  MRI backbone: vit (768-dim)
  Tabular features: 16 -> 64
  Fusion method: cross_modal
  Fusion hidden: 512
Fold 5 Seed 42:   0%|          | 0/50 [00:00<?, ?it/s]Fold 5 Seed 42:   0%|          | 0/50 [02:53<?, ?it/s, train_acc=59.3%, val_acc=76.9%]Fold 5 Seed 42:   2%|â–         | 1/50 [02:53<2:21:29, 173.26s/it, train_acc=59.3%, val_acc=76.9%]Fold 5 Seed 42:   2%|â–         | 1/50 [05:46<2:21:29, 173.26s/it, train_acc=80.7%, val_acc=88.7%]Fold 5 Seed 42:   4%|â–         | 2/50 [05:46<2:18:44, 173.43s/it, train_acc=80.7%, val_acc=88.7%]Fold 5 Seed 42:   4%|â–         | 2/50 [08:39<2:18:44, 173.43s/it, train_acc=87.1%, val_acc=89.1%]Fold 5 Seed 42:   6%|â–Œ         | 3/50 [08:39<2:15:43, 173.27s/it, train_acc=87.1%, val_acc=89.1%]Fold 5 Seed 42:   6%|â–Œ         | 3/50 [11:32<2:15:43, 173.27s/it, train_acc=88.3%, val_acc=89.5%]Fold 5 Seed 42:   8%|â–Š         | 4/50 [11:32<2:12:34, 172.92s/it, train_acc=88.3%, val_acc=89.5%]Fold 5 Seed 42:   8%|â–Š         | 4/50 [14:25<2:12:34, 172.92s/it, train_acc=88.1%, val_acc=84.3%]Fold 5 Seed 42:  10%|â–ˆ         | 5/50 [14:25<2:09:43, 172.97s/it, train_acc=88.1%, val_acc=84.3%]Fold 5 Seed 42:  10%|â–ˆ         | 5/50 [17:18<2:09:43, 172.97s/it, train_acc=88.2%, val_acc=88.9%]Fold 5 Seed 42:  12%|â–ˆâ–        | 6/50 [17:18<2:06:58, 173.16s/it, train_acc=88.2%, val_acc=88.9%]Fold 5 Seed 42:  12%|â–ˆâ–        | 6/50 [20:12<2:06:58, 173.16s/it, train_acc=88.7%, val_acc=87.8%]Fold 5 Seed 42:  14%|â–ˆâ–        | 7/50 [20:12<2:04:16, 173.40s/it, train_acc=88.7%, val_acc=87.8%]Fold 5 Seed 42:  14%|â–ˆâ–        | 7/50 [23:06<2:04:16, 173.40s/it, train_acc=88.7%, val_acc=88.0%]Fold 5 Seed 42:  16%|â–ˆâ–Œ        | 8/50 [23:06<2:01:22, 173.40s/it, train_acc=88.7%, val_acc=88.0%]Fold 5 Seed 42:  16%|â–ˆâ–Œ        | 8/50 [25:58<2:01:22, 173.40s/it, train_acc=89.0%, val_acc=89.5%]Fold 5 Seed 42:  18%|â–ˆâ–Š        | 9/50 [25:58<1:58:21, 173.20s/it, train_acc=89.0%, val_acc=89.5%]Fold 5 Seed 42:  18%|â–ˆâ–Š        | 9/50 [28:51<1:58:21, 173.20s/it, train_acc=88.9%, val_acc=88.7%]Fold 5 Seed 42:  20%|â–ˆâ–ˆ        | 10/50 [28:51<1:55:19, 172.99s/it, train_acc=88.9%, val_acc=88.7%]Fold 5 Seed 42:  20%|â–ˆâ–ˆ        | 10/50 [31:43<1:55:19, 172.99s/it, train_acc=89.9%, val_acc=90.7%]Fold 5 Seed 42:  22%|â–ˆâ–ˆâ–       | 11/50 [31:44<1:52:22, 172.88s/it, train_acc=89.9%, val_acc=90.7%]Fold 5 Seed 42:  22%|â–ˆâ–ˆâ–       | 11/50 [34:36<1:52:22, 172.88s/it, train_acc=90.1%, val_acc=89.9%]Fold 5 Seed 42:  24%|â–ˆâ–ˆâ–       | 12/50 [34:36<1:49:23, 172.72s/it, train_acc=90.1%, val_acc=89.9%]Fold 5 Seed 42:  24%|â–ˆâ–ˆâ–       | 12/50 [37:28<1:49:23, 172.72s/it, train_acc=90.8%, val_acc=90.3%]Fold 5 Seed 42:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [37:28<1:46:23, 172.52s/it, train_acc=90.8%, val_acc=90.3%]Fold 5 Seed 42:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [40:21<1:46:23, 172.52s/it, train_acc=91.0%, val_acc=91.1%]Fold 5 Seed 42:  28%|â–ˆâ–ˆâ–Š       | 14/50 [40:21<1:43:34, 172.61s/it, train_acc=91.0%, val_acc=91.1%]Fold 5 Seed 42:  28%|â–ˆâ–ˆâ–Š       | 14/50 [43:13<1:43:34, 172.61s/it, train_acc=91.2%, val_acc=91.3%]Fold 5 Seed 42:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [43:13<1:40:36, 172.48s/it, train_acc=91.2%, val_acc=91.3%]Fold 5 Seed 42:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [46:05<1:40:36, 172.48s/it, train_acc=91.7%, val_acc=91.3%]Fold 5 Seed 42:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [46:05<1:37:43, 172.47s/it, train_acc=91.7%, val_acc=91.3%]Fold 5 Seed 42:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [48:58<1:37:43, 172.47s/it, train_acc=91.5%, val_acc=92.0%]Fold 5 Seed 42:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [48:59<1:34:58, 172.67s/it, train_acc=91.5%, val_acc=92.0%]Fold 5 Seed 42:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [51:58<1:34:58, 172.67s/it, train_acc=91.8%, val_acc=90.5%]Fold 5 Seed 42:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [51:58<1:33:09, 174.68s/it, train_acc=91.8%, val_acc=90.5%]Fold 5 Seed 42:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [54:57<1:33:09, 174.68s/it, train_acc=92.0%, val_acc=92.0%]Fold 5 Seed 42:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [54:57<1:30:52, 175.88s/it, train_acc=92.0%, val_acc=92.0%]Fold 5 Seed 42:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [57:56<1:30:52, 175.88s/it, train_acc=92.4%, val_acc=92.2%]Fold 5 Seed 42:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [57:56<1:28:30, 177.00s/it, train_acc=92.4%, val_acc=92.2%]Fold 5 Seed 42:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [1:00:50<1:28:30, 177.00s/it, train_acc=92.8%, val_acc=92.2%]Fold 5 Seed 42:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:00:50<1:25:01, 175.90s/it, train_acc=92.8%, val_acc=92.2%]Fold 5 Seed 42:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:03:43<1:25:01, 175.90s/it, train_acc=92.5%, val_acc=91.5%]Fold 5 Seed 42:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:03:43<1:21:46, 175.24s/it, train_acc=92.5%, val_acc=91.5%]Fold 5 Seed 42:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:06:37<1:21:46, 175.24s/it, train_acc=93.1%, val_acc=91.1%]Fold 5 Seed 42:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:06:37<1:18:40, 174.83s/it, train_acc=93.1%, val_acc=91.1%]Fold 5 Seed 42:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:09:30<1:18:40, 174.83s/it, train_acc=93.6%, val_acc=92.8%]Fold 5 Seed 42:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:09:30<1:15:32, 174.32s/it, train_acc=93.6%, val_acc=92.8%]Fold 5 Seed 42:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:12:30<1:15:32, 174.32s/it, train_acc=93.1%, val_acc=90.3%]Fold 5 Seed 42:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:12:30<1:13:19, 175.99s/it, train_acc=93.1%, val_acc=90.3%]Fold 5 Seed 42:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:15:29<1:13:19, 175.99s/it, train_acc=93.6%, val_acc=91.8%]Fold 5 Seed 42:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:15:29<1:10:47, 176.96s/it, train_acc=93.6%, val_acc=91.8%]Fold 5 Seed 42:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:18:29<1:10:47, 176.96s/it, train_acc=94.1%, val_acc=92.4%]Fold 5 Seed 42:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:18:29<1:08:05, 177.62s/it, train_acc=94.1%, val_acc=92.4%]Fold 5 Seed 42:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:21:26<1:08:05, 177.62s/it, train_acc=94.0%, val_acc=90.7%]Fold 5 Seed 42:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:21:26<1:05:08, 177.66s/it, train_acc=94.0%, val_acc=90.7%]Fold 5 Seed 42:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:24:25<1:05:08, 177.66s/it, train_acc=94.2%, val_acc=91.8%]Fold 5 Seed 42:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:24:25<1:02:16, 177.92s/it, train_acc=94.2%, val_acc=91.8%]Fold 5 Seed 42:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:27:24<1:02:16, 177.92s/it, train_acc=94.7%, val_acc=90.5%]Fold 5 Seed 42:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:27:24<59:27, 178.36s/it, train_acc=94.7%, val_acc=90.5%]  Fold 5 Seed 42:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:30:24<59:27, 178.36s/it, train_acc=94.9%, val_acc=91.1%]Fold 5 Seed 42:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:30:24<56:35, 178.69s/it, train_acc=94.9%, val_acc=91.1%]Fold 5 Seed 42:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:33:22<56:35, 178.69s/it, train_acc=94.9%, val_acc=92.0%]Fold 5 Seed 42:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:33:22<53:33, 178.51s/it, train_acc=94.9%, val_acc=92.0%]Fold 5 Seed 42:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:36:21<53:33, 178.51s/it, train_acc=95.2%, val_acc=90.3%]Fold 5 Seed 42:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:36:21<50:37, 178.68s/it, train_acc=95.2%, val_acc=90.3%]Fold 5 Seed 42:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:39:22<50:37, 178.68s/it, train_acc=95.6%, val_acc=91.8%]Fold 5 Seed 42:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 34/50 [1:39:22<47:48, 179.30s/it, train_acc=95.6%, val_acc=91.8%]Fold 5 Seed 42:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 34/50 [1:42:21<47:48, 179.30s/it, train_acc=95.4%, val_acc=92.2%]Fold 5 Seed 42:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 35/50 [1:42:21<44:50, 179.38s/it, train_acc=95.4%, val_acc=92.2%]Fold 5 Seed 42:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 35/50 [1:45:20<44:50, 179.38s/it, train_acc=95.6%, val_acc=92.2%]Fold 5 Seed 42:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [1:45:20<41:50, 179.29s/it, train_acc=95.6%, val_acc=92.2%]Fold 5 Seed 42:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [1:48:20<41:50, 179.29s/it, train_acc=95.9%, val_acc=91.1%]Fold 5 Seed 42:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 37/50 [1:48:20<38:51, 179.36s/it, train_acc=95.9%, val_acc=91.1%]Fold 5 Seed 42:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 37/50 [1:51:19<38:51, 179.36s/it, train_acc=96.2%, val_acc=90.5%]Fold 5 Seed 42:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 38/50 [1:51:19<35:50, 179.21s/it, train_acc=96.2%, val_acc=90.5%]Fold 5 Seed 42:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 38/50 [1:54:18<35:50, 179.21s/it, train_acc=96.3%, val_acc=90.7%]Fold 5 Seed 42:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 38/50 [1:54:18<36:05, 180.48s/it, train_acc=96.3%, val_acc=90.7%]
INFO:__main__:  Subgroup Analysis:
INFO:__main__:    AD: 96.4% (55 samples)
INFO:__main__:    AD_trajectory: 68.8% (160 samples)
INFO:__main__:    CN: 97.4% (949 samples)
INFO:__main__:    MCI_to_AD: 79.6% (49 samples)
INFO:__main__:Fold 5 - Val: 92.78%, Test: 92.83%, Balanced: 86.94%
INFO:__main__:
Seed 42 Summary: 91.33% +/- 1.07%
INFO:__main__:
============================================================
INFO:__main__:SEED: 123
INFO:__main__:============================================================
INFO:__main__:
--- Fold 1/5 ---
INFO:__main__:Train: 4367, Val: 485, Test: 1213
INFO:dataset:Filled 4 missing values in 'AGE' with 69.00
INFO:dataset:Filled 13 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 518 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 525 missing values in 'TRAASCOR' with 30.00
INFO:dataset:Filled 571 missing values in 'TRABSCOR' with 77.00
INFO:dataset:Filled 3348 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 3352 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 3342 missing values in 'BNTTOTAL' with 23.00
INFO:dataset:Filled 2384 missing values in 'VSWEIGHT' with 165.00
INFO:dataset:Filled 2378 missing values in 'BMI' with 29.57
INFO:dataset:Filled 2625 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 2623 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 2623 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 2623 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 4367 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 3419 (78.3%)
INFO:dataset:  Class 1: 948 (21.7%)
INFO:dataset:Filled 1 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 52 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 52 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 57 missing values in 'TRABSCOR' with 77.00
INFO:dataset:Filled 371 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 371 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 370 missing values in 'BNTTOTAL' with 25.00
INFO:dataset:Filled 273 missing values in 'VSWEIGHT' with 166.50
INFO:dataset:Filled 273 missing values in 'BMI' with 29.43
INFO:dataset:Filled 300 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 300 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 300 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 300 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 485 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 378 (77.9%)
INFO:dataset:  Class 1: 107 (22.1%)
INFO:dataset:Filled 2 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 114 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 116 missing values in 'TRAASCOR' with 32.00
INFO:dataset:Filled 125 missing values in 'TRABSCOR' with 78.00
INFO:dataset:Filled 919 missing values in 'DSPANFOR' with 6.50
INFO:dataset:Filled 919 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 913 missing values in 'BNTTOTAL' with 23.00
INFO:dataset:Filled 676 missing values in 'VSWEIGHT' with 165.00
INFO:dataset:Filled 675 missing values in 'BMI' with 29.41
INFO:dataset:Filled 739 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 739 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 739 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 739 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 1213 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 950 (78.3%)
INFO:dataset:  Class 1: 263 (21.7%)
INFO:mri_vit_model:Created ViT3DClassifier with vit_base
INFO:mri_vit_model:  Image size: 128x128x128
INFO:mri_vit_model:  Patch size: 16
INFO:mri_vit_model:  Num patches: 512
INFO:mri_vit_model:  Embed dim: 768, Depth: 12, Heads: 12
INFO:mri_vit_model:Loading MAE pre-trained weights from ../mri_vit_ad/pretrained/vit_mae75_pretrained.pth
INFO:mri_vit_model:  Loaded pos_embed directly (shapes match: torch.Size([1, 513, 768]))
INFO:mri_vit_model:Loaded 150 pretrained weights (including pos_embed, cls_token, patch_embed if matched)
INFO:mri_vit_model:Missing keys: 2
INFO:mri_vit_model:  Missing: ['head.1.weight', 'head.1.bias']
/home/tanguy/medical/alzheimer/env/lib/python3.12/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
ViT backbone: 768-dim features
FT-Transformer tabular encoder: 16 -> 64
  Auxiliary losses: Enabled (MRI + Tabular classifiers)
MultiModalFusion initialized:
  MRI backbone: vit (768-dim)
  Tabular features: 16 -> 64
  Fusion method: cross_modal
  Fusion hidden: 512
Fold 1 Seed 123:   0%|          | 0/50 [00:00<?, ?it/s]Fold 1 Seed 123:   0%|          | 0/50 [02:50<?, ?it/s, train_acc=73.8%, val_acc=77.9%]Fold 1 Seed 123:   2%|â–         | 1/50 [02:50<2:19:18, 170.58s/it, train_acc=73.8%, val_acc=77.9%]Fold 1 Seed 123:   2%|â–         | 1/50 [05:42<2:19:18, 170.58s/it, train_acc=78.7%, val_acc=87.0%]Fold 1 Seed 123:   4%|â–         | 2/50 [05:42<2:17:05, 171.37s/it, train_acc=78.7%, val_acc=87.0%]Fold 1 Seed 123:   4%|â–         | 2/50 [08:37<2:17:05, 171.37s/it, train_acc=85.4%, val_acc=88.0%]Fold 1 Seed 123:   6%|â–Œ         | 3/50 [08:37<2:15:39, 173.19s/it, train_acc=85.4%, val_acc=88.0%]Fold 1 Seed 123:   6%|â–Œ         | 3/50 [11:30<2:15:39, 173.19s/it, train_acc=87.6%, val_acc=87.8%]Fold 1 Seed 123:   8%|â–Š         | 4/50 [11:30<2:12:40, 173.05s/it, train_acc=87.6%, val_acc=87.8%]Fold 1 Seed 123:   8%|â–Š         | 4/50 [14:23<2:12:40, 173.05s/it, train_acc=87.6%, val_acc=87.6%]Fold 1 Seed 123:  10%|â–ˆ         | 5/50 [14:23<2:09:41, 172.93s/it, train_acc=87.6%, val_acc=87.6%]Fold 1 Seed 123:  10%|â–ˆ         | 5/50 [17:16<2:09:41, 172.93s/it, train_acc=88.0%, val_acc=89.5%]Fold 1 Seed 123:  12%|â–ˆâ–        | 6/50 [17:16<2:06:53, 173.03s/it, train_acc=88.0%, val_acc=89.5%]Fold 1 Seed 123:  12%|â–ˆâ–        | 6/50 [20:12<2:06:53, 173.03s/it, train_acc=88.4%, val_acc=89.3%]Fold 1 Seed 123:  14%|â–ˆâ–        | 7/50 [20:12<2:04:46, 174.11s/it, train_acc=88.4%, val_acc=89.3%]Fold 1 Seed 123:  14%|â–ˆâ–        | 7/50 [23:05<2:04:46, 174.11s/it, train_acc=89.3%, val_acc=90.5%]Fold 1 Seed 123:  16%|â–ˆâ–Œ        | 8/50 [23:05<2:01:33, 173.66s/it, train_acc=89.3%, val_acc=90.5%]Fold 1 Seed 123:  16%|â–ˆâ–Œ        | 8/50 [25:58<2:01:33, 173.66s/it, train_acc=89.6%, val_acc=91.8%]Fold 1 Seed 123:  18%|â–ˆâ–Š        | 9/50 [25:58<1:58:27, 173.35s/it, train_acc=89.6%, val_acc=91.8%]Fold 1 Seed 123:  18%|â–ˆâ–Š        | 9/50 [28:58<1:58:27, 173.35s/it, train_acc=90.0%, val_acc=91.8%]Fold 1 Seed 123:  20%|â–ˆâ–ˆ        | 10/50 [28:58<1:56:53, 175.35s/it, train_acc=90.0%, val_acc=91.8%]Fold 1 Seed 123:  20%|â–ˆâ–ˆ        | 10/50 [31:57<1:56:53, 175.35s/it, train_acc=90.3%, val_acc=92.4%]Fold 1 Seed 123:  22%|â–ˆâ–ˆâ–       | 11/50 [31:57<1:54:51, 176.71s/it, train_acc=90.3%, val_acc=92.4%]Fold 1 Seed 123:  22%|â–ˆâ–ˆâ–       | 11/50 [34:52<1:54:51, 176.71s/it, train_acc=90.8%, val_acc=91.3%]Fold 1 Seed 123:  24%|â–ˆâ–ˆâ–       | 12/50 [34:52<1:51:32, 176.12s/it, train_acc=90.8%, val_acc=91.3%]Fold 1 Seed 123:  24%|â–ˆâ–ˆâ–       | 12/50 [37:46<1:51:32, 176.12s/it, train_acc=91.2%, val_acc=91.3%]Fold 1 Seed 123:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [37:46<1:48:07, 175.34s/it, train_acc=91.2%, val_acc=91.3%]Fold 1 Seed 123:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [40:38<1:48:07, 175.34s/it, train_acc=91.5%, val_acc=92.6%]Fold 1 Seed 123:  28%|â–ˆâ–ˆâ–Š       | 14/50 [40:38<1:44:41, 174.48s/it, train_acc=91.5%, val_acc=92.6%]Fold 1 Seed 123:  28%|â–ˆâ–ˆâ–Š       | 14/50 [43:32<1:44:41, 174.48s/it, train_acc=91.5%, val_acc=90.7%]Fold 1 Seed 123:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [43:32<1:41:41, 174.32s/it, train_acc=91.5%, val_acc=90.7%]Fold 1 Seed 123:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [46:24<1:41:41, 174.32s/it, train_acc=91.7%, val_acc=92.0%]Fold 1 Seed 123:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [46:24<1:38:24, 173.65s/it, train_acc=91.7%, val_acc=92.0%]Fold 1 Seed 123:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [49:17<1:38:24, 173.65s/it, train_acc=91.3%, val_acc=91.3%]Fold 1 Seed 123:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [49:17<1:35:24, 173.47s/it, train_acc=91.3%, val_acc=91.3%]Fold 1 Seed 123:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [52:11<1:35:24, 173.47s/it, train_acc=92.6%, val_acc=92.2%]Fold 1 Seed 123:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [52:11<1:32:30, 173.45s/it, train_acc=92.6%, val_acc=92.2%]Fold 1 Seed 123:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [55:03<1:32:30, 173.45s/it, train_acc=92.3%, val_acc=89.9%]Fold 1 Seed 123:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [55:03<1:29:29, 173.21s/it, train_acc=92.3%, val_acc=89.9%]Fold 1 Seed 123:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [57:57<1:29:29, 173.21s/it, train_acc=92.4%, val_acc=91.8%]Fold 1 Seed 123:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [57:57<1:26:39, 173.33s/it, train_acc=92.4%, val_acc=91.8%]Fold 1 Seed 123:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [1:00:52<1:26:39, 173.33s/it, train_acc=92.7%, val_acc=91.5%]Fold 1 Seed 123:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:00:52<1:23:59, 173.77s/it, train_acc=92.7%, val_acc=91.5%]Fold 1 Seed 123:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:03:43<1:23:59, 173.77s/it, train_acc=93.1%, val_acc=91.1%]Fold 1 Seed 123:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:03:43<1:20:42, 172.93s/it, train_acc=93.1%, val_acc=91.1%]Fold 1 Seed 123:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:06:37<1:20:42, 172.93s/it, train_acc=92.8%, val_acc=92.4%]Fold 1 Seed 123:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:06:37<1:18:01, 173.37s/it, train_acc=92.8%, val_acc=92.4%]Fold 1 Seed 123:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:09:30<1:18:01, 173.37s/it, train_acc=93.1%, val_acc=92.6%]Fold 1 Seed 123:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:09:30<1:15:05, 173.30s/it, train_acc=93.1%, val_acc=92.6%]Fold 1 Seed 123:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:12:23<1:15:05, 173.30s/it, train_acc=93.2%, val_acc=92.4%]Fold 1 Seed 123:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:12:23<1:12:08, 173.14s/it, train_acc=93.2%, val_acc=92.4%]Fold 1 Seed 123:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:15:16<1:12:08, 173.14s/it, train_acc=93.7%, val_acc=92.0%]Fold 1 Seed 123:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:15:16<1:09:11, 173.00s/it, train_acc=93.7%, val_acc=92.0%]Fold 1 Seed 123:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:18:08<1:09:11, 173.00s/it, train_acc=93.7%, val_acc=92.4%]Fold 1 Seed 123:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:18:08<1:06:14, 172.80s/it, train_acc=93.7%, val_acc=92.4%]Fold 1 Seed 123:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:21:00<1:06:14, 172.80s/it, train_acc=94.6%, val_acc=91.5%]Fold 1 Seed 123:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:21:00<1:03:15, 172.50s/it, train_acc=94.6%, val_acc=91.5%]Fold 1 Seed 123:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:23:53<1:03:15, 172.50s/it, train_acc=94.5%, val_acc=92.0%]Fold 1 Seed 123:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:23:53<1:05:54, 179.76s/it, train_acc=94.5%, val_acc=92.0%]
INFO:__main__:  Subgroup Analysis:
INFO:__main__:    AD: 95.2% (42 samples)
INFO:__main__:    AD_trajectory: 70.2% (168 samples)
INFO:__main__:    CN: 96.1% (950 samples)
INFO:__main__:    MCI_to_AD: 69.8% (53 samples)
INFO:__main__:Fold 1 - Val: 92.58%, Test: 91.34%, Balanced: 85.12%
INFO:__main__:
--- Fold 2/5 ---
INFO:__main__:Train: 4367, Val: 485, Test: 1213
INFO:dataset:Filled 4 missing values in 'AGE' with 69.00
INFO:dataset:Filled 13 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 479 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 486 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 533 missing values in 'TRABSCOR' with 78.00
INFO:dataset:Filled 3338 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 3340 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 3327 missing values in 'BNTTOTAL' with 24.00
INFO:dataset:Filled 2406 missing values in 'VSWEIGHT' with 166.00
INFO:dataset:Filled 2403 missing values in 'BMI' with 29.79
INFO:dataset:Filled 2656 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 2655 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 2655 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 2655 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 4367 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 3402 (77.9%)
INFO:dataset:  Class 1: 965 (22.1%)
INFO:dataset:Filled 1 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 59 missing values in 'CATANIMSC' with 21.00
INFO:dataset:Filled 60 missing values in 'TRAASCOR' with 30.00
INFO:dataset:Filled 61 missing values in 'TRABSCOR' with 75.00
INFO:dataset:Filled 370 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 370 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 370 missing values in 'BNTTOTAL' with 23.00
INFO:dataset:Filled 266 missing values in 'VSWEIGHT' with 162.60
INFO:dataset:Filled 265 missing values in 'BMI' with 29.38
INFO:dataset:Filled 288 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 288 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 288 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 288 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 485 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 395 (81.4%)
INFO:dataset:  Class 1: 90 (18.6%)
INFO:dataset:Filled 2 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 146 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 147 missing values in 'TRAASCOR' with 30.00
INFO:dataset:Filled 159 missing values in 'TRABSCOR' with 75.00
INFO:dataset:Filled 930 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 932 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 928 missing values in 'BNTTOTAL' with 22.00
INFO:dataset:Filled 661 missing values in 'VSWEIGHT' with 164.00
INFO:dataset:Filled 658 missing values in 'BMI' with 28.80
INFO:dataset:Filled 720 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 719 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 719 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 719 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 1213 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 950 (78.3%)
INFO:dataset:  Class 1: 263 (21.7%)
INFO:mri_vit_model:Created ViT3DClassifier with vit_base
INFO:mri_vit_model:  Image size: 128x128x128
INFO:mri_vit_model:  Patch size: 16
INFO:mri_vit_model:  Num patches: 512
INFO:mri_vit_model:  Embed dim: 768, Depth: 12, Heads: 12
INFO:mri_vit_model:Loading MAE pre-trained weights from ../mri_vit_ad/pretrained/vit_mae75_pretrained.pth
INFO:mri_vit_model:  Loaded pos_embed directly (shapes match: torch.Size([1, 513, 768]))
INFO:mri_vit_model:Loaded 150 pretrained weights (including pos_embed, cls_token, patch_embed if matched)
INFO:mri_vit_model:Missing keys: 2
INFO:mri_vit_model:  Missing: ['head.1.weight', 'head.1.bias']
/home/tanguy/medical/alzheimer/env/lib/python3.12/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
ViT backbone: 768-dim features
FT-Transformer tabular encoder: 16 -> 64
  Auxiliary losses: Enabled (MRI + Tabular classifiers)
MultiModalFusion initialized:
  MRI backbone: vit (768-dim)
  Tabular features: 16 -> 64
  Fusion method: cross_modal
  Fusion hidden: 512
Fold 2 Seed 123:   0%|          | 0/50 [00:00<?, ?it/s]Fold 2 Seed 123:   0%|          | 0/50 [02:52<?, ?it/s, train_acc=73.6%, val_acc=81.4%]Fold 2 Seed 123:   2%|â–         | 1/50 [02:52<2:21:10, 172.88s/it, train_acc=73.6%, val_acc=81.4%]Fold 2 Seed 123:   2%|â–         | 1/50 [05:44<2:21:10, 172.88s/it, train_acc=79.5%, val_acc=86.2%]Fold 2 Seed 123:   4%|â–         | 2/50 [05:44<2:17:50, 172.30s/it, train_acc=79.5%, val_acc=86.2%]Fold 2 Seed 123:   4%|â–         | 2/50 [08:38<2:17:50, 172.30s/it, train_acc=86.4%, val_acc=86.8%]Fold 2 Seed 123:   6%|â–Œ         | 3/50 [08:38<2:15:23, 172.85s/it, train_acc=86.4%, val_acc=86.8%]Fold 2 Seed 123:   6%|â–Œ         | 3/50 [11:31<2:15:23, 172.85s/it, train_acc=87.1%, val_acc=87.8%]Fold 2 Seed 123:   8%|â–Š         | 4/50 [11:32<2:12:48, 173.23s/it, train_acc=87.1%, val_acc=87.8%]Fold 2 Seed 123:   8%|â–Š         | 4/50 [14:26<2:12:48, 173.23s/it, train_acc=87.6%, val_acc=88.9%]Fold 2 Seed 123:  10%|â–ˆ         | 5/50 [14:26<2:10:15, 173.69s/it, train_acc=87.6%, val_acc=88.9%]Fold 2 Seed 123:  10%|â–ˆ         | 5/50 [17:20<2:10:15, 173.69s/it, train_acc=87.7%, val_acc=88.9%]Fold 2 Seed 123:  12%|â–ˆâ–        | 6/50 [17:20<2:07:32, 173.92s/it, train_acc=87.7%, val_acc=88.9%]Fold 2 Seed 123:  12%|â–ˆâ–        | 6/50 [20:13<2:07:32, 173.92s/it, train_acc=88.5%, val_acc=88.9%]Fold 2 Seed 123:  14%|â–ˆâ–        | 7/50 [20:13<2:04:17, 173.42s/it, train_acc=88.5%, val_acc=88.9%]Fold 2 Seed 123:  14%|â–ˆâ–        | 7/50 [23:06<2:04:17, 173.42s/it, train_acc=89.2%, val_acc=89.7%]Fold 2 Seed 123:  16%|â–ˆâ–Œ        | 8/50 [23:06<2:01:20, 173.34s/it, train_acc=89.2%, val_acc=89.7%]Fold 2 Seed 123:  16%|â–ˆâ–Œ        | 8/50 [26:01<2:01:20, 173.34s/it, train_acc=89.8%, val_acc=90.9%]Fold 2 Seed 123:  18%|â–ˆâ–Š        | 9/50 [26:01<1:58:44, 173.78s/it, train_acc=89.8%, val_acc=90.9%]Fold 2 Seed 123:  18%|â–ˆâ–Š        | 9/50 [28:54<1:58:44, 173.78s/it, train_acc=90.4%, val_acc=89.1%]Fold 2 Seed 123:  20%|â–ˆâ–ˆ        | 10/50 [28:54<1:55:43, 173.60s/it, train_acc=90.4%, val_acc=89.1%]Fold 2 Seed 123:  20%|â–ˆâ–ˆ        | 10/50 [31:47<1:55:43, 173.60s/it, train_acc=90.4%, val_acc=91.3%]Fold 2 Seed 123:  22%|â–ˆâ–ˆâ–       | 11/50 [31:47<1:52:44, 173.44s/it, train_acc=90.4%, val_acc=91.3%]Fold 2 Seed 123:  22%|â–ˆâ–ˆâ–       | 11/50 [34:45<1:52:44, 173.44s/it, train_acc=91.1%, val_acc=91.3%]Fold 2 Seed 123:  24%|â–ˆâ–ˆâ–       | 12/50 [34:45<1:50:46, 174.90s/it, train_acc=91.1%, val_acc=91.3%]Fold 2 Seed 123:  24%|â–ˆâ–ˆâ–       | 12/50 [37:45<1:50:46, 174.90s/it, train_acc=91.3%, val_acc=92.2%]Fold 2 Seed 123:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [37:46<1:48:52, 176.55s/it, train_acc=91.3%, val_acc=92.2%]Fold 2 Seed 123:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [40:46<1:48:52, 176.55s/it, train_acc=91.9%, val_acc=91.8%]Fold 2 Seed 123:  28%|â–ˆâ–ˆâ–Š       | 14/50 [40:46<1:46:37, 177.71s/it, train_acc=91.9%, val_acc=91.8%]Fold 2 Seed 123:  28%|â–ˆâ–ˆâ–Š       | 14/50 [43:45<1:46:37, 177.71s/it, train_acc=91.9%, val_acc=92.2%]Fold 2 Seed 123:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [43:45<1:43:48, 177.96s/it, train_acc=91.9%, val_acc=92.2%]Fold 2 Seed 123:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [46:43<1:43:48, 177.96s/it, train_acc=92.0%, val_acc=92.0%]Fold 2 Seed 123:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [46:43<1:40:53, 178.06s/it, train_acc=92.0%, val_acc=92.0%]Fold 2 Seed 123:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [49:40<1:40:53, 178.06s/it, train_acc=92.1%, val_acc=91.5%]Fold 2 Seed 123:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [49:40<1:37:51, 177.92s/it, train_acc=92.1%, val_acc=91.5%]Fold 2 Seed 123:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [52:38<1:37:51, 177.92s/it, train_acc=92.5%, val_acc=92.0%]Fold 2 Seed 123:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [52:38<1:34:49, 177.81s/it, train_acc=92.5%, val_acc=92.0%]Fold 2 Seed 123:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [55:38<1:34:49, 177.81s/it, train_acc=92.6%, val_acc=92.2%]Fold 2 Seed 123:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [55:38<1:32:08, 178.35s/it, train_acc=92.6%, val_acc=92.2%]Fold 2 Seed 123:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [58:36<1:32:08, 178.35s/it, train_acc=93.2%, val_acc=90.3%]Fold 2 Seed 123:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [58:36<1:29:09, 178.30s/it, train_acc=93.2%, val_acc=90.3%]Fold 2 Seed 123:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [1:01:35<1:29:09, 178.30s/it, train_acc=93.2%, val_acc=91.8%]Fold 2 Seed 123:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:01:35<1:26:18, 178.56s/it, train_acc=93.2%, val_acc=91.8%]Fold 2 Seed 123:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:04:33<1:26:18, 178.56s/it, train_acc=93.2%, val_acc=92.0%]Fold 2 Seed 123:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:04:33<1:23:17, 178.48s/it, train_acc=93.2%, val_acc=92.0%]Fold 2 Seed 123:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:07:32<1:23:17, 178.48s/it, train_acc=94.0%, val_acc=91.8%]Fold 2 Seed 123:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:07:32<1:20:17, 178.42s/it, train_acc=94.0%, val_acc=91.8%]Fold 2 Seed 123:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:10:33<1:20:17, 178.42s/it, train_acc=93.8%, val_acc=90.7%]Fold 2 Seed 123:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:10:33<1:17:41, 179.30s/it, train_acc=93.8%, val_acc=90.7%]Fold 2 Seed 123:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:13:32<1:17:41, 179.30s/it, train_acc=94.1%, val_acc=93.2%]Fold 2 Seed 123:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:13:32<1:14:40, 179.20s/it, train_acc=94.1%, val_acc=93.2%]Fold 2 Seed 123:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:16:30<1:14:40, 179.20s/it, train_acc=93.9%, val_acc=90.5%]Fold 2 Seed 123:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:16:30<1:11:36, 179.00s/it, train_acc=93.9%, val_acc=90.5%]Fold 2 Seed 123:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:19:30<1:11:36, 179.00s/it, train_acc=93.9%, val_acc=92.8%]Fold 2 Seed 123:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:19:30<1:08:44, 179.31s/it, train_acc=93.9%, val_acc=92.8%]Fold 2 Seed 123:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:22:30<1:08:44, 179.31s/it, train_acc=94.4%, val_acc=92.4%]Fold 2 Seed 123:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:22:30<1:05:44, 179.28s/it, train_acc=94.4%, val_acc=92.4%]Fold 2 Seed 123:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:25:28<1:05:44, 179.28s/it, train_acc=95.1%, val_acc=91.5%]Fold 2 Seed 123:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:25:28<1:02:41, 179.10s/it, train_acc=95.1%, val_acc=91.5%]Fold 2 Seed 123:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:28:28<1:02:41, 179.10s/it, train_acc=95.2%, val_acc=92.2%]Fold 2 Seed 123:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:28:28<59:45, 179.25s/it, train_acc=95.2%, val_acc=92.2%]  Fold 2 Seed 123:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:31:26<59:45, 179.25s/it, train_acc=95.8%, val_acc=91.5%]Fold 2 Seed 123:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:31:26<56:38, 178.89s/it, train_acc=95.8%, val_acc=91.5%]Fold 2 Seed 123:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:34:25<56:38, 178.89s/it, train_acc=95.7%, val_acc=90.9%]Fold 2 Seed 123:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:34:25<53:40, 178.92s/it, train_acc=95.7%, val_acc=90.9%]Fold 2 Seed 123:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:37:23<53:40, 178.92s/it, train_acc=95.7%, val_acc=91.8%]Fold 2 Seed 123:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:37:23<50:38, 178.76s/it, train_acc=95.7%, val_acc=91.8%]Fold 2 Seed 123:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:40:21<50:38, 178.76s/it, train_acc=96.0%, val_acc=91.3%]Fold 2 Seed 123:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 34/50 [1:40:21<47:37, 178.58s/it, train_acc=96.0%, val_acc=91.3%]Fold 2 Seed 123:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 34/50 [1:43:21<47:37, 178.58s/it, train_acc=96.3%, val_acc=93.0%]Fold 2 Seed 123:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 35/50 [1:43:21<44:43, 178.92s/it, train_acc=96.3%, val_acc=93.0%]Fold 2 Seed 123:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 35/50 [1:46:21<44:43, 178.92s/it, train_acc=96.6%, val_acc=91.5%]Fold 2 Seed 123:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [1:46:21<41:48, 179.15s/it, train_acc=96.6%, val_acc=91.5%]Fold 2 Seed 123:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [1:49:20<41:48, 179.15s/it, train_acc=97.0%, val_acc=91.1%]Fold 2 Seed 123:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 37/50 [1:49:20<38:47, 179.08s/it, train_acc=97.0%, val_acc=91.1%]Fold 2 Seed 123:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 37/50 [1:52:18<38:47, 179.08s/it, train_acc=97.2%, val_acc=91.8%]Fold 2 Seed 123:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 38/50 [1:52:18<35:46, 178.89s/it, train_acc=97.2%, val_acc=91.8%]Fold 2 Seed 123:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 38/50 [1:55:17<35:46, 178.89s/it, train_acc=97.3%, val_acc=92.4%]Fold 2 Seed 123:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 39/50 [1:55:17<32:46, 178.75s/it, train_acc=97.3%, val_acc=92.4%]Fold 2 Seed 123:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 39/50 [1:58:16<32:46, 178.75s/it, train_acc=97.7%, val_acc=91.3%]Fold 2 Seed 123:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 39/50 [1:58:16<33:21, 181.95s/it, train_acc=97.7%, val_acc=91.3%]
INFO:__main__:  Subgroup Analysis:
INFO:__main__:    AD: 94.0% (50 samples)
INFO:__main__:    AD_trajectory: 77.4% (168 samples)
INFO:__main__:    CN: 95.4% (950 samples)
INFO:__main__:    MCI_to_AD: 88.9% (45 samples)
INFO:__main__:Fold 2 - Val: 93.20%, Test: 92.58%, Balanced: 88.94%
INFO:__main__:
--- Fold 3/5 ---
INFO:__main__:Train: 4367, Val: 485, Test: 1213
INFO:dataset:Filled 1 missing values in 'AGE' with 69.00
INFO:dataset:Filled 12 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 486 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 492 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 536 missing values in 'TRABSCOR' with 77.00
INFO:dataset:Filled 3338 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 3341 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 3327 missing values in 'BNTTOTAL' with 23.00
INFO:dataset:Filled 2393 missing values in 'VSWEIGHT' with 164.00
INFO:dataset:Filled 2387 missing values in 'BMI' with 29.38
INFO:dataset:Filled 2634 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 2633 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 2633 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 2633 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 4367 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 3414 (78.2%)
INFO:dataset:  Class 1: 953 (21.8%)
INFO:dataset:Filled 1 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 61 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 62 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 66 missing values in 'TRABSCOR' with 76.00
INFO:dataset:Filled 380 missing values in 'DSPANFOR' with 5.00
INFO:dataset:Filled 381 missing values in 'DSPANBAC' with 3.00
INFO:dataset:Filled 379 missing values in 'BNTTOTAL' with 18.00
INFO:dataset:Filled 272 missing values in 'VSWEIGHT' with 170.00
INFO:dataset:Filled 272 missing values in 'BMI' with 29.68
INFO:dataset:Filled 297 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 296 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 296 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 296 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 485 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 384 (79.2%)
INFO:dataset:  Class 1: 101 (20.8%)
INFO:dataset:Filled 3 missing values in 'AGE' with 69.00
INFO:dataset:Filled 3 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 137 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 139 missing values in 'TRAASCOR' with 30.00
INFO:dataset:Filled 151 missing values in 'TRABSCOR' with 78.00
INFO:dataset:Filled 920 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 920 missing values in 'DSPANBAC' with 5.00
INFO:dataset:Filled 919 missing values in 'BNTTOTAL' with 26.00
INFO:dataset:Filled 668 missing values in 'VSWEIGHT' with 168.00
INFO:dataset:Filled 667 missing values in 'BMI' with 30.10
INFO:dataset:Filled 733 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 733 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 733 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 733 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 1213 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 949 (78.2%)
INFO:dataset:  Class 1: 264 (21.8%)
INFO:mri_vit_model:Created ViT3DClassifier with vit_base
INFO:mri_vit_model:  Image size: 128x128x128
INFO:mri_vit_model:  Patch size: 16
INFO:mri_vit_model:  Num patches: 512
INFO:mri_vit_model:  Embed dim: 768, Depth: 12, Heads: 12
INFO:mri_vit_model:Loading MAE pre-trained weights from ../mri_vit_ad/pretrained/vit_mae75_pretrained.pth
INFO:mri_vit_model:  Loaded pos_embed directly (shapes match: torch.Size([1, 513, 768]))
INFO:mri_vit_model:Loaded 150 pretrained weights (including pos_embed, cls_token, patch_embed if matched)
INFO:mri_vit_model:Missing keys: 2
INFO:mri_vit_model:  Missing: ['head.1.weight', 'head.1.bias']
/home/tanguy/medical/alzheimer/env/lib/python3.12/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
ViT backbone: 768-dim features
FT-Transformer tabular encoder: 16 -> 64
  Auxiliary losses: Enabled (MRI + Tabular classifiers)
MultiModalFusion initialized:
  MRI backbone: vit (768-dim)
  Tabular features: 16 -> 64
  Fusion method: cross_modal
  Fusion hidden: 512
Fold 3 Seed 123:   0%|          | 0/50 [00:00<?, ?it/s]Fold 3 Seed 123:   0%|          | 0/50 [02:52<?, ?it/s, train_acc=73.5%, val_acc=79.2%]Fold 3 Seed 123:   2%|â–         | 1/50 [02:52<2:20:45, 172.36s/it, train_acc=73.5%, val_acc=79.2%]Fold 3 Seed 123:   2%|â–         | 1/50 [05:43<2:20:45, 172.36s/it, train_acc=78.8%, val_acc=88.5%]Fold 3 Seed 123:   4%|â–         | 2/50 [05:44<2:17:33, 171.95s/it, train_acc=78.8%, val_acc=88.5%]Fold 3 Seed 123:   4%|â–         | 2/50 [08:36<2:17:33, 171.95s/it, train_acc=85.8%, val_acc=89.3%]Fold 3 Seed 123:   6%|â–Œ         | 3/50 [08:37<2:15:05, 172.47s/it, train_acc=85.8%, val_acc=89.3%]Fold 3 Seed 123:   6%|â–Œ         | 3/50 [11:30<2:15:05, 172.47s/it, train_acc=86.5%, val_acc=89.1%]Fold 3 Seed 123:   8%|â–Š         | 4/50 [11:30<2:12:35, 172.95s/it, train_acc=86.5%, val_acc=89.1%]Fold 3 Seed 123:   8%|â–Š         | 4/50 [14:24<2:12:35, 172.95s/it, train_acc=87.0%, val_acc=89.5%]Fold 3 Seed 123:  10%|â–ˆ         | 5/50 [14:25<2:10:03, 173.41s/it, train_acc=87.0%, val_acc=89.5%]Fold 3 Seed 123:  10%|â–ˆ         | 5/50 [17:24<2:10:03, 173.41s/it, train_acc=87.6%, val_acc=89.7%]Fold 3 Seed 123:  12%|â–ˆâ–        | 6/50 [17:24<2:08:38, 175.41s/it, train_acc=87.6%, val_acc=89.7%]Fold 3 Seed 123:  12%|â–ˆâ–        | 6/50 [20:17<2:08:38, 175.41s/it, train_acc=87.6%, val_acc=88.0%]Fold 3 Seed 123:  14%|â–ˆâ–        | 7/50 [20:17<2:05:08, 174.62s/it, train_acc=87.6%, val_acc=88.0%]Fold 3 Seed 123:  14%|â–ˆâ–        | 7/50 [23:10<2:05:08, 174.62s/it, train_acc=88.5%, val_acc=90.3%]Fold 3 Seed 123:  16%|â–ˆâ–Œ        | 8/50 [23:10<2:01:54, 174.15s/it, train_acc=88.5%, val_acc=90.3%]Fold 3 Seed 123:  16%|â–ˆâ–Œ        | 8/50 [26:08<2:01:54, 174.15s/it, train_acc=89.2%, val_acc=90.7%]Fold 3 Seed 123:  18%|â–ˆâ–Š        | 9/50 [26:08<1:59:52, 175.43s/it, train_acc=89.2%, val_acc=90.7%]Fold 3 Seed 123:  18%|â–ˆâ–Š        | 9/50 [29:07<1:59:52, 175.43s/it, train_acc=90.1%, val_acc=91.8%]Fold 3 Seed 123:  20%|â–ˆâ–ˆ        | 10/50 [29:07<1:57:40, 176.52s/it, train_acc=90.1%, val_acc=91.8%]Fold 3 Seed 123:  20%|â–ˆâ–ˆ        | 10/50 [32:06<1:57:40, 176.52s/it, train_acc=90.2%, val_acc=91.1%]Fold 3 Seed 123:  22%|â–ˆâ–ˆâ–       | 11/50 [32:06<1:55:14, 177.30s/it, train_acc=90.2%, val_acc=91.1%]Fold 3 Seed 123:  22%|â–ˆâ–ˆâ–       | 11/50 [35:04<1:55:14, 177.30s/it, train_acc=90.7%, val_acc=91.8%]Fold 3 Seed 123:  24%|â–ˆâ–ˆâ–       | 12/50 [35:04<1:52:25, 177.52s/it, train_acc=90.7%, val_acc=91.8%]Fold 3 Seed 123:  24%|â–ˆâ–ˆâ–       | 12/50 [38:03<1:52:25, 177.52s/it, train_acc=91.4%, val_acc=92.0%]Fold 3 Seed 123:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [38:03<1:49:40, 177.85s/it, train_acc=91.4%, val_acc=92.0%]Fold 3 Seed 123:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [41:03<1:49:40, 177.85s/it, train_acc=91.3%, val_acc=91.5%]Fold 3 Seed 123:  28%|â–ˆâ–ˆâ–Š       | 14/50 [41:03<1:47:03, 178.42s/it, train_acc=91.3%, val_acc=91.5%]Fold 3 Seed 123:  28%|â–ˆâ–ˆâ–Š       | 14/50 [44:02<1:47:03, 178.42s/it, train_acc=91.9%, val_acc=92.0%]Fold 3 Seed 123:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [44:02<1:44:12, 178.65s/it, train_acc=91.9%, val_acc=92.0%]Fold 3 Seed 123:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [47:00<1:44:12, 178.65s/it, train_acc=92.1%, val_acc=92.2%]Fold 3 Seed 123:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [47:00<1:41:13, 178.64s/it, train_acc=92.1%, val_acc=92.2%]Fold 3 Seed 123:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [50:07<1:41:13, 178.64s/it, train_acc=92.4%, val_acc=92.2%]Fold 3 Seed 123:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [50:07<1:39:38, 181.17s/it, train_acc=92.4%, val_acc=92.2%]Fold 3 Seed 123:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [53:16<1:39:38, 181.17s/it, train_acc=92.5%, val_acc=90.3%]Fold 3 Seed 123:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [53:16<1:37:47, 183.36s/it, train_acc=92.5%, val_acc=90.3%]Fold 3 Seed 123:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [56:24<1:37:47, 183.36s/it, train_acc=92.8%, val_acc=93.4%]Fold 3 Seed 123:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [56:24<1:35:29, 184.82s/it, train_acc=92.8%, val_acc=93.4%]Fold 3 Seed 123:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [59:23<1:35:29, 184.82s/it, train_acc=92.7%, val_acc=92.8%]Fold 3 Seed 123:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [59:23<1:31:28, 182.95s/it, train_acc=92.7%, val_acc=92.8%]Fold 3 Seed 123:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [1:02:22<1:31:28, 182.95s/it, train_acc=92.9%, val_acc=93.0%]Fold 3 Seed 123:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:02:22<1:27:55, 181.90s/it, train_acc=92.9%, val_acc=93.0%]Fold 3 Seed 123:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:05:22<1:27:55, 181.90s/it, train_acc=93.6%, val_acc=91.8%]Fold 3 Seed 123:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:05:22<1:24:32, 181.15s/it, train_acc=93.6%, val_acc=91.8%]Fold 3 Seed 123:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:08:21<1:24:32, 181.15s/it, train_acc=93.8%, val_acc=92.8%]Fold 3 Seed 123:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:08:21<1:21:17, 180.66s/it, train_acc=93.8%, val_acc=92.8%]Fold 3 Seed 123:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:11:19<1:21:17, 180.66s/it, train_acc=94.2%, val_acc=94.0%]Fold 3 Seed 123:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:11:19<1:17:57, 179.91s/it, train_acc=94.2%, val_acc=94.0%]Fold 3 Seed 123:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:14:18<1:17:57, 179.91s/it, train_acc=94.1%, val_acc=92.4%]Fold 3 Seed 123:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:14:18<1:14:52, 179.68s/it, train_acc=94.1%, val_acc=92.4%]Fold 3 Seed 123:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:17:17<1:14:52, 179.68s/it, train_acc=94.5%, val_acc=90.9%]Fold 3 Seed 123:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:17:17<1:11:41, 179.24s/it, train_acc=94.5%, val_acc=90.9%]Fold 3 Seed 123:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:20:15<1:11:41, 179.24s/it, train_acc=94.6%, val_acc=92.6%]Fold 3 Seed 123:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:20:15<1:08:38, 179.06s/it, train_acc=94.6%, val_acc=92.6%]Fold 3 Seed 123:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:23:15<1:08:38, 179.06s/it, train_acc=95.1%, val_acc=92.4%]Fold 3 Seed 123:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:23:15<1:05:41, 179.15s/it, train_acc=95.1%, val_acc=92.4%]Fold 3 Seed 123:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:26:14<1:05:41, 179.15s/it, train_acc=95.4%, val_acc=93.0%]Fold 3 Seed 123:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:26:14<1:02:41, 179.11s/it, train_acc=95.4%, val_acc=93.0%]Fold 3 Seed 123:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:29:12<1:02:41, 179.11s/it, train_acc=95.5%, val_acc=92.6%]Fold 3 Seed 123:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:29:12<59:37, 178.88s/it, train_acc=95.5%, val_acc=92.6%]  Fold 3 Seed 123:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:32:09<59:37, 178.88s/it, train_acc=96.0%, val_acc=91.8%]Fold 3 Seed 123:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:32:09<56:28, 178.36s/it, train_acc=96.0%, val_acc=91.8%]Fold 3 Seed 123:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:35:08<56:28, 178.36s/it, train_acc=96.1%, val_acc=93.8%]Fold 3 Seed 123:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:35:08<53:32, 178.47s/it, train_acc=96.1%, val_acc=93.8%]Fold 3 Seed 123:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:38:05<53:32, 178.47s/it, train_acc=96.2%, val_acc=90.7%]Fold 3 Seed 123:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:38:05<50:29, 178.21s/it, train_acc=96.2%, val_acc=90.7%]Fold 3 Seed 123:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:41:03<50:29, 178.21s/it, train_acc=96.7%, val_acc=93.6%]Fold 3 Seed 123:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 34/50 [1:41:03<47:29, 178.11s/it, train_acc=96.7%, val_acc=93.6%]Fold 3 Seed 123:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 34/50 [1:44:04<47:29, 178.11s/it, train_acc=96.7%, val_acc=92.8%]Fold 3 Seed 123:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 35/50 [1:44:04<44:44, 178.99s/it, train_acc=96.7%, val_acc=92.8%]Fold 3 Seed 123:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 35/50 [1:47:04<44:44, 178.99s/it, train_acc=96.9%, val_acc=93.4%]Fold 3 Seed 123:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [1:47:04<41:46, 179.04s/it, train_acc=96.9%, val_acc=93.4%]Fold 3 Seed 123:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [1:50:03<41:46, 179.04s/it, train_acc=97.0%, val_acc=92.6%]Fold 3 Seed 123:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 37/50 [1:50:03<38:48, 179.11s/it, train_acc=97.0%, val_acc=92.6%]Fold 3 Seed 123:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 37/50 [1:53:04<38:48, 179.11s/it, train_acc=97.3%, val_acc=93.2%]Fold 3 Seed 123:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 38/50 [1:53:04<35:56, 179.74s/it, train_acc=97.3%, val_acc=93.2%]Fold 3 Seed 123:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 38/50 [1:56:03<35:56, 179.74s/it, train_acc=97.9%, val_acc=90.7%]Fold 3 Seed 123:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 38/50 [1:56:03<36:38, 183.24s/it, train_acc=97.9%, val_acc=90.7%]
INFO:__main__:  Subgroup Analysis:
INFO:__main__:    AD: 93.2% (44 samples)
INFO:__main__:    AD_trajectory: 70.5% (166 samples)
INFO:__main__:    CN: 96.4% (949 samples)
INFO:__main__:    MCI_to_AD: 72.2% (54 samples)
INFO:__main__:Fold 3 - Val: 94.02%, Test: 91.67%, Balanced: 85.52%
INFO:__main__:
--- Fold 4/5 ---
INFO:__main__:Train: 4367, Val: 485, Test: 1213
INFO:dataset:Filled 3 missing values in 'AGE' with 69.00
INFO:dataset:Filled 11 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 497 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 505 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 538 missing values in 'TRABSCOR' with 77.00
INFO:dataset:Filled 3339 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 3342 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 3328 missing values in 'BNTTOTAL' with 24.00
INFO:dataset:Filled 2384 missing values in 'VSWEIGHT' with 165.00
INFO:dataset:Filled 2379 missing values in 'BMI' with 29.49
INFO:dataset:Filled 2616 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 2615 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 2615 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 2615 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 4367 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 3408 (78.0%)
INFO:dataset:  Class 1: 959 (22.0%)
INFO:dataset:Filled 2 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 46 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 46 missing values in 'TRAASCOR' with 30.00
INFO:dataset:Filled 54 missing values in 'TRABSCOR' with 72.00
INFO:dataset:Filled 367 missing values in 'DSPANFOR' with 5.00
INFO:dataset:Filled 367 missing values in 'DSPANBAC' with 3.00
INFO:dataset:Filled 366 missing values in 'BNTTOTAL' with 20.00
INFO:dataset:Filled 268 missing values in 'VSWEIGHT' with 165.00
INFO:dataset:Filled 268 missing values in 'BMI' with 29.63
INFO:dataset:Filled 299 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 298 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 298 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 298 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 485 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 390 (80.4%)
INFO:dataset:  Class 1: 95 (19.6%)
INFO:dataset:Filled 1 missing values in 'AGE' with 69.00
INFO:dataset:Filled 3 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 141 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 142 missing values in 'TRAASCOR' with 30.00
INFO:dataset:Filled 161 missing values in 'TRABSCOR' with 77.00
INFO:dataset:Filled 932 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 933 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 931 missing values in 'BNTTOTAL' with 22.00
INFO:dataset:Filled 681 missing values in 'VSWEIGHT' with 165.00
INFO:dataset:Filled 679 missing values in 'BMI' with 29.57
INFO:dataset:Filled 749 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 749 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 749 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 749 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 1213 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 949 (78.2%)
INFO:dataset:  Class 1: 264 (21.8%)
INFO:mri_vit_model:Created ViT3DClassifier with vit_base
INFO:mri_vit_model:  Image size: 128x128x128
INFO:mri_vit_model:  Patch size: 16
INFO:mri_vit_model:  Num patches: 512
INFO:mri_vit_model:  Embed dim: 768, Depth: 12, Heads: 12
INFO:mri_vit_model:Loading MAE pre-trained weights from ../mri_vit_ad/pretrained/vit_mae75_pretrained.pth
INFO:mri_vit_model:  Loaded pos_embed directly (shapes match: torch.Size([1, 513, 768]))
INFO:mri_vit_model:Loaded 150 pretrained weights (including pos_embed, cls_token, patch_embed if matched)
INFO:mri_vit_model:Missing keys: 2
INFO:mri_vit_model:  Missing: ['head.1.weight', 'head.1.bias']
/home/tanguy/medical/alzheimer/env/lib/python3.12/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
ViT backbone: 768-dim features
FT-Transformer tabular encoder: 16 -> 64
  Auxiliary losses: Enabled (MRI + Tabular classifiers)
MultiModalFusion initialized:
  MRI backbone: vit (768-dim)
  Tabular features: 16 -> 64
  Fusion method: cross_modal
  Fusion hidden: 512
Fold 4 Seed 123:   0%|          | 0/50 [00:00<?, ?it/s]Fold 4 Seed 123:   0%|          | 0/50 [02:52<?, ?it/s, train_acc=74.1%, val_acc=80.4%]Fold 4 Seed 123:   2%|â–         | 1/50 [02:52<2:21:01, 172.69s/it, train_acc=74.1%, val_acc=80.4%]Fold 4 Seed 123:   2%|â–         | 1/50 [05:45<2:21:01, 172.69s/it, train_acc=79.0%, val_acc=86.6%]Fold 4 Seed 123:   4%|â–         | 2/50 [05:45<2:18:24, 173.01s/it, train_acc=79.0%, val_acc=86.6%]Fold 4 Seed 123:   4%|â–         | 2/50 [08:39<2:18:24, 173.01s/it, train_acc=86.1%, val_acc=87.2%]Fold 4 Seed 123:   6%|â–Œ         | 3/50 [08:39<2:15:53, 173.49s/it, train_acc=86.1%, val_acc=87.2%]Fold 4 Seed 123:   6%|â–Œ         | 3/50 [11:31<2:15:53, 173.49s/it, train_acc=87.2%, val_acc=87.4%]Fold 4 Seed 123:   8%|â–Š         | 4/50 [11:31<2:12:28, 172.79s/it, train_acc=87.2%, val_acc=87.4%]Fold 4 Seed 123:   8%|â–Š         | 4/50 [14:25<2:12:28, 172.79s/it, train_acc=87.4%, val_acc=87.8%]Fold 4 Seed 123:  10%|â–ˆ         | 5/50 [14:26<2:10:01, 173.36s/it, train_acc=87.4%, val_acc=87.8%]Fold 4 Seed 123:  10%|â–ˆ         | 5/50 [17:17<2:10:01, 173.36s/it, train_acc=88.5%, val_acc=88.7%]Fold 4 Seed 123:  12%|â–ˆâ–        | 6/50 [17:18<2:06:48, 172.91s/it, train_acc=88.5%, val_acc=88.7%]Fold 4 Seed 123:  12%|â–ˆâ–        | 6/50 [20:17<2:06:48, 172.91s/it, train_acc=89.6%, val_acc=89.3%]Fold 4 Seed 123:  14%|â–ˆâ–        | 7/50 [20:17<2:05:29, 175.09s/it, train_acc=89.6%, val_acc=89.3%]Fold 4 Seed 123:  14%|â–ˆâ–        | 7/50 [23:12<2:05:29, 175.09s/it, train_acc=89.9%, val_acc=89.1%]Fold 4 Seed 123:  16%|â–ˆâ–Œ        | 8/50 [23:12<2:02:28, 174.97s/it, train_acc=89.9%, val_acc=89.1%]Fold 4 Seed 123:  16%|â–ˆâ–Œ        | 8/50 [26:05<2:02:28, 174.97s/it, train_acc=91.0%, val_acc=89.9%]Fold 4 Seed 123:  18%|â–ˆâ–Š        | 9/50 [26:06<1:59:17, 174.58s/it, train_acc=91.0%, val_acc=89.9%]Fold 4 Seed 123:  18%|â–ˆâ–Š        | 9/50 [29:07<1:59:17, 174.58s/it, train_acc=90.7%, val_acc=89.5%]Fold 4 Seed 123:  20%|â–ˆâ–ˆ        | 10/50 [29:07<1:57:49, 176.73s/it, train_acc=90.7%, val_acc=89.5%]Fold 4 Seed 123:  20%|â–ˆâ–ˆ        | 10/50 [32:06<1:57:49, 176.73s/it, train_acc=91.2%, val_acc=90.1%]Fold 4 Seed 123:  22%|â–ˆâ–ˆâ–       | 11/50 [32:07<1:55:25, 177.57s/it, train_acc=91.2%, val_acc=90.1%]Fold 4 Seed 123:  22%|â–ˆâ–ˆâ–       | 11/50 [34:59<1:55:25, 177.57s/it, train_acc=91.5%, val_acc=90.3%]Fold 4 Seed 123:  24%|â–ˆâ–ˆâ–       | 12/50 [35:00<1:51:34, 176.18s/it, train_acc=91.5%, val_acc=90.3%]Fold 4 Seed 123:  24%|â–ˆâ–ˆâ–       | 12/50 [37:59<1:51:34, 176.18s/it, train_acc=91.5%, val_acc=90.7%]Fold 4 Seed 123:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [37:59<1:49:17, 177.24s/it, train_acc=91.5%, val_acc=90.7%]Fold 4 Seed 123:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [40:58<1:49:17, 177.24s/it, train_acc=92.1%, val_acc=89.1%]Fold 4 Seed 123:  28%|â–ˆâ–ˆâ–Š       | 14/50 [40:58<1:46:41, 177.82s/it, train_acc=92.1%, val_acc=89.1%]Fold 4 Seed 123:  28%|â–ˆâ–ˆâ–Š       | 14/50 [43:52<1:46:41, 177.82s/it, train_acc=92.0%, val_acc=87.6%]Fold 4 Seed 123:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [43:52<1:42:56, 176.46s/it, train_acc=92.0%, val_acc=87.6%]Fold 4 Seed 123:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [46:46<1:42:56, 176.46s/it, train_acc=91.9%, val_acc=90.1%]Fold 4 Seed 123:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [46:46<1:39:34, 175.71s/it, train_acc=91.9%, val_acc=90.1%]Fold 4 Seed 123:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [49:39<1:39:34, 175.71s/it, train_acc=92.7%, val_acc=89.9%]Fold 4 Seed 123:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [49:39<1:36:10, 174.86s/it, train_acc=92.7%, val_acc=89.9%]Fold 4 Seed 123:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [52:33<1:36:10, 174.86s/it, train_acc=92.6%, val_acc=89.5%]Fold 4 Seed 123:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [52:33<1:33:07, 174.61s/it, train_acc=92.6%, val_acc=89.5%]Fold 4 Seed 123:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [55:28<1:33:07, 174.61s/it, train_acc=92.9%, val_acc=90.5%]Fold 4 Seed 123:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [55:28<1:30:15, 174.68s/it, train_acc=92.9%, val_acc=90.5%]Fold 4 Seed 123:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [58:21<1:30:15, 174.68s/it, train_acc=93.9%, val_acc=89.9%]Fold 4 Seed 123:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [58:21<1:27:11, 174.37s/it, train_acc=93.9%, val_acc=89.9%]Fold 4 Seed 123:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [1:01:15<1:27:11, 174.37s/it, train_acc=93.2%, val_acc=90.5%]Fold 4 Seed 123:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:01:15<1:24:13, 174.25s/it, train_acc=93.2%, val_acc=90.5%]Fold 4 Seed 123:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:04:07<1:24:13, 174.25s/it, train_acc=93.9%, val_acc=90.7%]Fold 4 Seed 123:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:04:07<1:20:59, 173.56s/it, train_acc=93.9%, val_acc=90.7%]Fold 4 Seed 123:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:07:00<1:20:59, 173.56s/it, train_acc=93.5%, val_acc=89.9%]Fold 4 Seed 123:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:07:00<1:18:04, 173.50s/it, train_acc=93.5%, val_acc=89.9%]Fold 4 Seed 123:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:09:54<1:18:04, 173.50s/it, train_acc=94.2%, val_acc=90.9%]Fold 4 Seed 123:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:09:54<1:15:14, 173.64s/it, train_acc=94.2%, val_acc=90.9%]Fold 4 Seed 123:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:12:54<1:15:14, 173.64s/it, train_acc=94.0%, val_acc=90.7%]Fold 4 Seed 123:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:12:54<1:13:02, 175.29s/it, train_acc=94.0%, val_acc=90.7%]Fold 4 Seed 123:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:15:47<1:13:02, 175.29s/it, train_acc=94.3%, val_acc=90.3%]Fold 4 Seed 123:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:15:47<1:09:53, 174.72s/it, train_acc=94.3%, val_acc=90.3%]Fold 4 Seed 123:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:18:41<1:09:53, 174.72s/it, train_acc=94.5%, val_acc=91.5%]Fold 4 Seed 123:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:18:41<1:06:52, 174.46s/it, train_acc=94.5%, val_acc=91.5%]Fold 4 Seed 123:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:21:40<1:06:52, 174.46s/it, train_acc=94.9%, val_acc=90.7%]Fold 4 Seed 123:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:21:40<1:04:28, 175.85s/it, train_acc=94.9%, val_acc=90.7%]Fold 4 Seed 123:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:24:34<1:04:28, 175.85s/it, train_acc=95.1%, val_acc=91.1%]Fold 4 Seed 123:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:24:34<1:01:19, 175.22s/it, train_acc=95.1%, val_acc=91.1%]Fold 4 Seed 123:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:27:28<1:01:19, 175.22s/it, train_acc=95.2%, val_acc=90.7%]Fold 4 Seed 123:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:27:28<58:21, 175.07s/it, train_acc=95.2%, val_acc=90.7%]  Fold 4 Seed 123:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:30:22<58:21, 175.07s/it, train_acc=95.7%, val_acc=91.8%]Fold 4 Seed 123:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:30:22<55:20, 174.78s/it, train_acc=95.7%, val_acc=91.8%]Fold 4 Seed 123:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:33:22<55:20, 174.78s/it, train_acc=96.1%, val_acc=91.8%]Fold 4 Seed 123:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:33:22<52:54, 176.33s/it, train_acc=96.1%, val_acc=91.8%]Fold 4 Seed 123:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:36:22<52:54, 176.33s/it, train_acc=95.7%, val_acc=91.3%]Fold 4 Seed 123:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:36:22<50:16, 177.43s/it, train_acc=95.7%, val_acc=91.3%]Fold 4 Seed 123:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:39:22<50:16, 177.43s/it, train_acc=96.5%, val_acc=91.1%]Fold 4 Seed 123:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 34/50 [1:39:22<47:29, 178.08s/it, train_acc=96.5%, val_acc=91.1%]Fold 4 Seed 123:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 34/50 [1:42:21<47:29, 178.08s/it, train_acc=96.5%, val_acc=90.9%]Fold 4 Seed 123:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 35/50 [1:42:21<44:34, 178.32s/it, train_acc=96.5%, val_acc=90.9%]Fold 4 Seed 123:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 35/50 [1:45:20<44:34, 178.32s/it, train_acc=96.6%, val_acc=91.3%]Fold 4 Seed 123:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [1:45:20<41:41, 178.69s/it, train_acc=96.6%, val_acc=91.3%]Fold 4 Seed 123:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [1:48:18<41:41, 178.69s/it, train_acc=96.9%, val_acc=90.7%]Fold 4 Seed 123:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 37/50 [1:48:18<38:39, 178.45s/it, train_acc=96.9%, val_acc=90.7%]Fold 4 Seed 123:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 37/50 [1:51:17<38:39, 178.45s/it, train_acc=97.3%, val_acc=90.7%]Fold 4 Seed 123:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 38/50 [1:51:17<35:43, 178.61s/it, train_acc=97.3%, val_acc=90.7%]Fold 4 Seed 123:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 38/50 [1:54:16<35:43, 178.61s/it, train_acc=97.2%, val_acc=91.5%]Fold 4 Seed 123:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 39/50 [1:54:16<32:44, 178.55s/it, train_acc=97.2%, val_acc=91.5%]Fold 4 Seed 123:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 39/50 [1:57:15<32:44, 178.55s/it, train_acc=97.5%, val_acc=91.8%]Fold 4 Seed 123:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 40/50 [1:57:15<29:49, 178.90s/it, train_acc=97.5%, val_acc=91.8%]Fold 4 Seed 123:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 40/50 [2:00:15<29:49, 178.90s/it, train_acc=97.5%, val_acc=90.7%]Fold 4 Seed 123:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 41/50 [2:00:15<26:52, 179.22s/it, train_acc=97.5%, val_acc=90.7%]Fold 4 Seed 123:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 41/50 [2:03:16<26:52, 179.22s/it, train_acc=97.7%, val_acc=90.3%]Fold 4 Seed 123:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 42/50 [2:03:16<23:56, 179.57s/it, train_acc=97.7%, val_acc=90.3%]Fold 4 Seed 123:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 42/50 [2:06:14<23:56, 179.57s/it, train_acc=97.5%, val_acc=90.3%]Fold 4 Seed 123:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 43/50 [2:06:14<20:54, 179.18s/it, train_acc=97.5%, val_acc=90.3%]Fold 4 Seed 123:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 43/50 [2:09:12<20:54, 179.18s/it, train_acc=97.7%, val_acc=91.3%]Fold 4 Seed 123:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 44/50 [2:09:12<17:53, 178.85s/it, train_acc=97.7%, val_acc=91.3%]Fold 4 Seed 123:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 44/50 [2:12:12<17:53, 178.85s/it, train_acc=97.9%, val_acc=91.1%]Fold 4 Seed 123:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 45/50 [2:12:12<14:56, 179.22s/it, train_acc=97.9%, val_acc=91.1%]Fold 4 Seed 123:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 45/50 [2:15:12<14:56, 179.22s/it, train_acc=97.8%, val_acc=91.1%]Fold 4 Seed 123:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 45/50 [2:15:12<15:01, 180.29s/it, train_acc=97.8%, val_acc=91.1%]
INFO:__main__:  Subgroup Analysis:
INFO:__main__:    AD: 92.5% (40 samples)
INFO:__main__:    AD_trajectory: 67.1% (173 samples)
INFO:__main__:    CN: 97.2% (949 samples)
INFO:__main__:    MCI_to_AD: 82.4% (51 samples)
INFO:__main__:Fold 4 - Val: 91.75%, Test: 92.09%, Balanced: 85.51%
INFO:__main__:
--- Fold 5/5 ---
INFO:__main__:Train: 4367, Val: 485, Test: 1213
INFO:dataset:Filled 4 missing values in 'AGE' with 69.00
INFO:dataset:Filled 9 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 487 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 493 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 536 missing values in 'TRABSCOR' with 77.00
INFO:dataset:Filled 3337 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 3340 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 3330 missing values in 'BNTTOTAL' with 24.00
INFO:dataset:Filled 2421 missing values in 'VSWEIGHT' with 165.00
INFO:dataset:Filled 2415 missing values in 'BMI' with 29.40
INFO:dataset:Filled 2649 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 2648 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 2648 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 2648 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 4367 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 3411 (78.1%)
INFO:dataset:  Class 1: 956 (21.9%)
INFO:dataset:Filled 1 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 51 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 51 missing values in 'TRAASCOR' with 29.50
INFO:dataset:Filled 60 missing values in 'TRABSCOR' with 77.00
INFO:dataset:Filled 364 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 364 missing values in 'DSPANBAC' with 3.00
INFO:dataset:Filled 361 missing values in 'BNTTOTAL' with 20.00
INFO:dataset:Filled 265 missing values in 'VSWEIGHT' with 165.50
INFO:dataset:Filled 264 missing values in 'BMI' with 29.80
INFO:dataset:Filled 292 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 292 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 292 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 292 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 485 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 387 (79.8%)
INFO:dataset:  Class 1: 98 (20.2%)
INFO:dataset:Filled 6 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 146 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 149 missing values in 'TRAASCOR' with 30.00
INFO:dataset:Filled 157 missing values in 'TRABSCOR' with 77.00
INFO:dataset:Filled 937 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 938 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 934 missing values in 'BNTTOTAL' with 23.00
INFO:dataset:Filled 647 missing values in 'VSWEIGHT' with 164.00
INFO:dataset:Filled 647 missing values in 'BMI' with 29.80
INFO:dataset:Filled 723 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 722 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 722 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 722 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 1213 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 949 (78.2%)
INFO:dataset:  Class 1: 264 (21.8%)
INFO:mri_vit_model:Created ViT3DClassifier with vit_base
INFO:mri_vit_model:  Image size: 128x128x128
INFO:mri_vit_model:  Patch size: 16
INFO:mri_vit_model:  Num patches: 512
INFO:mri_vit_model:  Embed dim: 768, Depth: 12, Heads: 12
INFO:mri_vit_model:Loading MAE pre-trained weights from ../mri_vit_ad/pretrained/vit_mae75_pretrained.pth
INFO:mri_vit_model:  Loaded pos_embed directly (shapes match: torch.Size([1, 513, 768]))
INFO:mri_vit_model:Loaded 150 pretrained weights (including pos_embed, cls_token, patch_embed if matched)
INFO:mri_vit_model:Missing keys: 2
INFO:mri_vit_model:  Missing: ['head.1.weight', 'head.1.bias']
/home/tanguy/medical/alzheimer/env/lib/python3.12/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
ViT backbone: 768-dim features
FT-Transformer tabular encoder: 16 -> 64
  Auxiliary losses: Enabled (MRI + Tabular classifiers)
MultiModalFusion initialized:
  MRI backbone: vit (768-dim)
  Tabular features: 16 -> 64
  Fusion method: cross_modal
  Fusion hidden: 512
Fold 5 Seed 123:   0%|          | 0/50 [00:00<?, ?it/s]Fold 5 Seed 123:   0%|          | 0/50 [02:51<?, ?it/s, train_acc=73.5%, val_acc=79.8%]Fold 5 Seed 123:   2%|â–         | 1/50 [02:51<2:20:22, 171.89s/it, train_acc=73.5%, val_acc=79.8%]Fold 5 Seed 123:   2%|â–         | 1/50 [05:44<2:20:22, 171.89s/it, train_acc=79.5%, val_acc=87.4%]Fold 5 Seed 123:   4%|â–         | 2/50 [05:44<2:17:57, 172.44s/it, train_acc=79.5%, val_acc=87.4%]Fold 5 Seed 123:   4%|â–         | 2/50 [08:37<2:17:57, 172.44s/it, train_acc=86.6%, val_acc=89.3%]Fold 5 Seed 123:   6%|â–Œ         | 3/50 [08:37<2:15:09, 172.54s/it, train_acc=86.6%, val_acc=89.3%]Fold 5 Seed 123:   6%|â–Œ         | 3/50 [11:31<2:15:09, 172.54s/it, train_acc=87.2%, val_acc=89.9%]Fold 5 Seed 123:   8%|â–Š         | 4/50 [11:31<2:12:43, 173.13s/it, train_acc=87.2%, val_acc=89.9%]Fold 5 Seed 123:   8%|â–Š         | 4/50 [14:25<2:12:43, 173.13s/it, train_acc=86.6%, val_acc=89.1%]Fold 5 Seed 123:  10%|â–ˆ         | 5/50 [14:25<2:10:05, 173.45s/it, train_acc=86.6%, val_acc=89.1%]Fold 5 Seed 123:  10%|â–ˆ         | 5/50 [17:17<2:10:05, 173.45s/it, train_acc=87.5%, val_acc=91.5%]Fold 5 Seed 123:  12%|â–ˆâ–        | 6/50 [17:17<2:06:54, 173.06s/it, train_acc=87.5%, val_acc=91.5%]Fold 5 Seed 123:  12%|â–ˆâ–        | 6/50 [20:09<2:06:54, 173.06s/it, train_acc=87.3%, val_acc=91.3%]Fold 5 Seed 123:  14%|â–ˆâ–        | 7/50 [20:09<2:03:46, 172.70s/it, train_acc=87.3%, val_acc=91.3%]Fold 5 Seed 123:  14%|â–ˆâ–        | 7/50 [23:02<2:03:46, 172.70s/it, train_acc=88.6%, val_acc=92.0%]Fold 5 Seed 123:  16%|â–ˆâ–Œ        | 8/50 [23:02<2:00:59, 172.83s/it, train_acc=88.6%, val_acc=92.0%]Fold 5 Seed 123:  16%|â–ˆâ–Œ        | 8/50 [26:01<2:00:59, 172.83s/it, train_acc=89.0%, val_acc=90.1%]Fold 5 Seed 123:  18%|â–ˆâ–Š        | 9/50 [26:01<1:59:21, 174.66s/it, train_acc=89.0%, val_acc=90.1%]Fold 5 Seed 123:  18%|â–ˆâ–Š        | 9/50 [29:01<1:59:21, 174.66s/it, train_acc=89.7%, val_acc=91.5%]Fold 5 Seed 123:  20%|â–ˆâ–ˆ        | 10/50 [29:01<1:57:31, 176.29s/it, train_acc=89.7%, val_acc=91.5%]Fold 5 Seed 123:  20%|â–ˆâ–ˆ        | 10/50 [32:01<1:57:31, 176.29s/it, train_acc=89.9%, val_acc=93.4%]Fold 5 Seed 123:  22%|â–ˆâ–ˆâ–       | 11/50 [32:01<1:55:18, 177.39s/it, train_acc=89.9%, val_acc=93.4%]Fold 5 Seed 123:  22%|â–ˆâ–ˆâ–       | 11/50 [34:58<1:55:18, 177.39s/it, train_acc=90.8%, val_acc=92.8%]Fold 5 Seed 123:  24%|â–ˆâ–ˆâ–       | 12/50 [34:58<1:52:23, 177.45s/it, train_acc=90.8%, val_acc=92.8%]Fold 5 Seed 123:  24%|â–ˆâ–ˆâ–       | 12/50 [37:51<1:52:23, 177.45s/it, train_acc=90.3%, val_acc=92.6%]Fold 5 Seed 123:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [37:51<1:48:27, 175.87s/it, train_acc=90.3%, val_acc=92.6%]Fold 5 Seed 123:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [40:44<1:48:27, 175.87s/it, train_acc=91.2%, val_acc=93.6%]Fold 5 Seed 123:  28%|â–ˆâ–ˆâ–Š       | 14/50 [40:44<1:45:08, 175.24s/it, train_acc=91.2%, val_acc=93.6%]Fold 5 Seed 123:  28%|â–ˆâ–ˆâ–Š       | 14/50 [43:44<1:45:08, 175.24s/it, train_acc=91.9%, val_acc=92.6%]Fold 5 Seed 123:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [43:44<1:43:01, 176.61s/it, train_acc=91.9%, val_acc=92.6%]Fold 5 Seed 123:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [46:44<1:43:01, 176.61s/it, train_acc=91.3%, val_acc=92.8%]Fold 5 Seed 123:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [46:44<1:40:35, 177.50s/it, train_acc=91.3%, val_acc=92.8%]Fold 5 Seed 123:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [49:42<1:40:35, 177.50s/it, train_acc=91.8%, val_acc=93.0%]Fold 5 Seed 123:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [49:42<1:37:41, 177.63s/it, train_acc=91.8%, val_acc=93.0%]Fold 5 Seed 123:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [52:41<1:37:41, 177.63s/it, train_acc=91.9%, val_acc=93.0%]Fold 5 Seed 123:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [52:41<1:34:56, 178.01s/it, train_acc=91.9%, val_acc=93.0%]Fold 5 Seed 123:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [55:41<1:34:56, 178.01s/it, train_acc=92.4%, val_acc=93.4%]Fold 5 Seed 123:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [55:41<1:32:22, 178.81s/it, train_acc=92.4%, val_acc=93.4%]Fold 5 Seed 123:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [58:40<1:32:22, 178.81s/it, train_acc=92.6%, val_acc=92.6%]Fold 5 Seed 123:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [58:40<1:29:23, 178.77s/it, train_acc=92.6%, val_acc=92.6%]Fold 5 Seed 123:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [1:01:38<1:29:23, 178.77s/it, train_acc=93.1%, val_acc=93.0%]Fold 5 Seed 123:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:01:38<1:26:18, 178.57s/it, train_acc=93.1%, val_acc=93.0%]Fold 5 Seed 123:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:04:37<1:26:18, 178.57s/it, train_acc=92.8%, val_acc=94.2%]Fold 5 Seed 123:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:04:37<1:23:26, 178.82s/it, train_acc=92.8%, val_acc=94.2%]Fold 5 Seed 123:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:07:37<1:23:26, 178.82s/it, train_acc=92.8%, val_acc=94.0%]Fold 5 Seed 123:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:07:37<1:20:34, 179.05s/it, train_acc=92.8%, val_acc=94.0%]Fold 5 Seed 123:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:10:29<1:20:34, 179.05s/it, train_acc=93.1%, val_acc=92.6%]Fold 5 Seed 123:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:10:29<1:16:43, 177.07s/it, train_acc=93.1%, val_acc=92.6%]Fold 5 Seed 123:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:13:23<1:16:43, 177.07s/it, train_acc=93.5%, val_acc=94.4%]Fold 5 Seed 123:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:13:23<1:13:18, 175.94s/it, train_acc=93.5%, val_acc=94.4%]Fold 5 Seed 123:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:16:23<1:13:18, 175.94s/it, train_acc=93.4%, val_acc=94.0%]Fold 5 Seed 123:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:16:23<1:10:52, 177.18s/it, train_acc=93.4%, val_acc=94.0%]Fold 5 Seed 123:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:19:23<1:10:52, 177.18s/it, train_acc=93.6%, val_acc=94.2%]Fold 5 Seed 123:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:19:23<1:08:12, 177.92s/it, train_acc=93.6%, val_acc=94.2%]Fold 5 Seed 123:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:22:22<1:08:12, 177.92s/it, train_acc=94.1%, val_acc=94.0%]Fold 5 Seed 123:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:22:22<1:05:25, 178.42s/it, train_acc=94.1%, val_acc=94.0%]Fold 5 Seed 123:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:25:21<1:05:25, 178.42s/it, train_acc=94.5%, val_acc=93.8%]Fold 5 Seed 123:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:25:21<1:02:27, 178.47s/it, train_acc=94.5%, val_acc=93.8%]Fold 5 Seed 123:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:28:20<1:02:27, 178.47s/it, train_acc=94.0%, val_acc=94.2%]Fold 5 Seed 123:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:28:20<59:37, 178.87s/it, train_acc=94.0%, val_acc=94.2%]  Fold 5 Seed 123:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:31:19<59:37, 178.87s/it, train_acc=94.6%, val_acc=94.2%]Fold 5 Seed 123:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:31:19<56:38, 178.89s/it, train_acc=94.6%, val_acc=94.2%]Fold 5 Seed 123:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:34:19<56:38, 178.89s/it, train_acc=94.8%, val_acc=94.0%]Fold 5 Seed 123:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:34:19<53:41, 178.97s/it, train_acc=94.8%, val_acc=94.0%]Fold 5 Seed 123:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:37:17<53:41, 178.97s/it, train_acc=95.1%, val_acc=94.2%]Fold 5 Seed 123:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:37:17<50:38, 178.75s/it, train_acc=95.1%, val_acc=94.2%]Fold 5 Seed 123:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:40:15<50:38, 178.75s/it, train_acc=95.2%, val_acc=93.0%]Fold 5 Seed 123:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 34/50 [1:40:15<47:36, 178.53s/it, train_acc=95.2%, val_acc=93.0%]Fold 5 Seed 123:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 34/50 [1:43:13<47:36, 178.53s/it, train_acc=95.2%, val_acc=93.4%]Fold 5 Seed 123:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 35/50 [1:43:13<44:34, 178.32s/it, train_acc=95.2%, val_acc=93.4%]Fold 5 Seed 123:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 35/50 [1:46:11<44:34, 178.32s/it, train_acc=95.6%, val_acc=94.0%]Fold 5 Seed 123:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [1:46:11<41:35, 178.24s/it, train_acc=95.6%, val_acc=94.0%]Fold 5 Seed 123:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [1:49:11<41:35, 178.24s/it, train_acc=96.0%, val_acc=93.6%]Fold 5 Seed 123:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 37/50 [1:49:11<38:44, 178.79s/it, train_acc=96.0%, val_acc=93.6%]Fold 5 Seed 123:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 37/50 [1:52:11<38:44, 178.79s/it, train_acc=96.1%, val_acc=94.0%]Fold 5 Seed 123:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 38/50 [1:52:11<35:49, 179.10s/it, train_acc=96.1%, val_acc=94.0%]Fold 5 Seed 123:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 38/50 [1:55:09<35:49, 179.10s/it, train_acc=96.3%, val_acc=94.2%]Fold 5 Seed 123:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 39/50 [1:55:09<32:46, 178.78s/it, train_acc=96.3%, val_acc=94.2%]Fold 5 Seed 123:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 39/50 [1:58:08<32:46, 178.78s/it, train_acc=96.5%, val_acc=93.8%]Fold 5 Seed 123:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 39/50 [1:58:08<33:19, 181.76s/it, train_acc=96.5%, val_acc=93.8%]
INFO:__main__:  Subgroup Analysis:
INFO:__main__:    AD: 95.5% (44 samples)
INFO:__main__:    AD_trajectory: 66.5% (164 samples)
INFO:__main__:    CN: 96.0% (949 samples)
INFO:__main__:    MCI_to_AD: 87.5% (56 samples)
INFO:__main__:Fold 5 - Val: 94.43%, Test: 91.59%, Balanced: 85.88%
INFO:__main__:
Seed 123 Summary: 91.85% +/- 0.43%
INFO:__main__:
============================================================
INFO:__main__:SEED: 456
INFO:__main__:============================================================
INFO:__main__:
--- Fold 1/5 ---
INFO:__main__:Train: 4367, Val: 485, Test: 1213
INFO:dataset:Filled 3 missing values in 'AGE' with 69.00
INFO:dataset:Filled 13 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 501 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 509 missing values in 'TRAASCOR' with 30.00
INFO:dataset:Filled 555 missing values in 'TRABSCOR' with 76.00
INFO:dataset:Filled 3334 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 3337 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 3326 missing values in 'BNTTOTAL' with 24.00
INFO:dataset:Filled 2384 missing values in 'VSWEIGHT' with 165.00
INFO:dataset:Filled 2379 missing values in 'BMI' with 29.44
INFO:dataset:Filled 2624 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 2623 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 2623 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 2623 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 4367 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 3420 (78.3%)
INFO:dataset:  Class 1: 947 (21.7%)
INFO:dataset:Filled 1 missing values in 'AGE' with 69.00
INFO:dataset:Filled 48 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 50 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 56 missing values in 'TRABSCOR' with 75.00
INFO:dataset:Filled 364 missing values in 'DSPANFOR' with 7.00
INFO:dataset:Filled 365 missing values in 'DSPANBAC' with 5.00
INFO:dataset:Filled 360 missing values in 'BNTTOTAL' with 25.00
INFO:dataset:Filled 266 missing values in 'VSWEIGHT' with 163.00
INFO:dataset:Filled 265 missing values in 'BMI' with 30.57
INFO:dataset:Filled 293 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 293 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 293 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 293 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 485 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 377 (77.7%)
INFO:dataset:  Class 1: 108 (22.3%)
INFO:dataset:Filled 3 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 135 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 134 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 142 missing values in 'TRABSCOR' with 78.00
INFO:dataset:Filled 940 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 940 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 939 missing values in 'BNTTOTAL' with 17.50
INFO:dataset:Filled 683 missing values in 'VSWEIGHT' with 165.40
INFO:dataset:Filled 682 missing values in 'BMI' with 29.40
INFO:dataset:Filled 747 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 746 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 746 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 746 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 1213 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 950 (78.3%)
INFO:dataset:  Class 1: 263 (21.7%)
INFO:mri_vit_model:Created ViT3DClassifier with vit_base
INFO:mri_vit_model:  Image size: 128x128x128
INFO:mri_vit_model:  Patch size: 16
INFO:mri_vit_model:  Num patches: 512
INFO:mri_vit_model:  Embed dim: 768, Depth: 12, Heads: 12
INFO:mri_vit_model:Loading MAE pre-trained weights from ../mri_vit_ad/pretrained/vit_mae75_pretrained.pth
INFO:mri_vit_model:  Loaded pos_embed directly (shapes match: torch.Size([1, 513, 768]))
INFO:mri_vit_model:Loaded 150 pretrained weights (including pos_embed, cls_token, patch_embed if matched)
INFO:mri_vit_model:Missing keys: 2
INFO:mri_vit_model:  Missing: ['head.1.weight', 'head.1.bias']
/home/tanguy/medical/alzheimer/env/lib/python3.12/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
ViT backbone: 768-dim features
FT-Transformer tabular encoder: 16 -> 64
  Auxiliary losses: Enabled (MRI + Tabular classifiers)
MultiModalFusion initialized:
  MRI backbone: vit (768-dim)
  Tabular features: 16 -> 64
  Fusion method: cross_modal
  Fusion hidden: 512
Fold 1 Seed 456:   0%|          | 0/50 [00:00<?, ?it/s]Fold 1 Seed 456:   0%|          | 0/50 [02:53<?, ?it/s, train_acc=62.7%, val_acc=77.7%]Fold 1 Seed 456:   2%|â–         | 1/50 [02:53<2:21:43, 173.54s/it, train_acc=62.7%, val_acc=77.7%]Fold 1 Seed 456:   2%|â–         | 1/50 [05:48<2:21:43, 173.54s/it, train_acc=77.8%, val_acc=78.6%]Fold 1 Seed 456:   4%|â–         | 2/50 [05:48<2:19:34, 174.47s/it, train_acc=77.8%, val_acc=78.6%]Fold 1 Seed 456:   4%|â–         | 2/50 [08:42<2:19:34, 174.47s/it, train_acc=83.9%, val_acc=84.9%]Fold 1 Seed 456:   6%|â–Œ         | 3/50 [08:42<2:16:23, 174.12s/it, train_acc=83.9%, val_acc=84.9%]Fold 1 Seed 456:   6%|â–Œ         | 3/50 [11:35<2:16:23, 174.12s/it, train_acc=87.5%, val_acc=86.0%]Fold 1 Seed 456:   8%|â–Š         | 4/50 [11:36<2:13:21, 173.95s/it, train_acc=87.5%, val_acc=86.0%]Fold 1 Seed 456:   8%|â–Š         | 4/50 [14:29<2:13:21, 173.95s/it, train_acc=87.9%, val_acc=84.5%]Fold 1 Seed 456:  10%|â–ˆ         | 5/50 [14:29<2:10:14, 173.66s/it, train_acc=87.9%, val_acc=84.5%]Fold 1 Seed 456:  10%|â–ˆ         | 5/50 [17:23<2:10:14, 173.66s/it, train_acc=88.1%, val_acc=86.2%]Fold 1 Seed 456:  12%|â–ˆâ–        | 6/50 [17:23<2:07:26, 173.79s/it, train_acc=88.1%, val_acc=86.2%]Fold 1 Seed 456:  12%|â–ˆâ–        | 6/50 [20:17<2:07:26, 173.79s/it, train_acc=87.9%, val_acc=87.4%]Fold 1 Seed 456:  14%|â–ˆâ–        | 7/50 [20:17<2:04:43, 174.03s/it, train_acc=87.9%, val_acc=87.4%]Fold 1 Seed 456:  14%|â–ˆâ–        | 7/50 [23:16<2:04:43, 174.03s/it, train_acc=88.4%, val_acc=86.4%]Fold 1 Seed 456:  16%|â–ˆâ–Œ        | 8/50 [23:16<2:02:51, 175.51s/it, train_acc=88.4%, val_acc=86.4%]Fold 1 Seed 456:  16%|â–ˆâ–Œ        | 8/50 [26:10<2:02:51, 175.51s/it, train_acc=88.2%, val_acc=87.2%]Fold 1 Seed 456:  18%|â–ˆâ–Š        | 9/50 [26:10<1:59:42, 175.18s/it, train_acc=88.2%, val_acc=87.2%]Fold 1 Seed 456:  18%|â–ˆâ–Š        | 9/50 [29:05<1:59:42, 175.18s/it, train_acc=87.6%, val_acc=86.4%]Fold 1 Seed 456:  20%|â–ˆâ–ˆ        | 10/50 [29:05<1:56:37, 174.94s/it, train_acc=87.6%, val_acc=86.4%]Fold 1 Seed 456:  20%|â–ˆâ–ˆ        | 10/50 [31:59<1:56:37, 174.94s/it, train_acc=88.5%, val_acc=86.0%]Fold 1 Seed 456:  22%|â–ˆâ–ˆâ–       | 11/50 [31:59<1:53:35, 174.76s/it, train_acc=88.5%, val_acc=86.0%]Fold 1 Seed 456:  22%|â–ˆâ–ˆâ–       | 11/50 [34:53<1:53:35, 174.76s/it, train_acc=87.9%, val_acc=86.4%]Fold 1 Seed 456:  24%|â–ˆâ–ˆâ–       | 12/50 [34:53<1:50:29, 174.46s/it, train_acc=87.9%, val_acc=86.4%]Fold 1 Seed 456:  24%|â–ˆâ–ˆâ–       | 12/50 [37:47<1:50:29, 174.46s/it, train_acc=88.9%, val_acc=86.4%]Fold 1 Seed 456:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [37:47<1:47:26, 174.23s/it, train_acc=88.9%, val_acc=86.4%]Fold 1 Seed 456:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [40:39<1:47:26, 174.23s/it, train_acc=88.6%, val_acc=87.0%]Fold 1 Seed 456:  28%|â–ˆâ–ˆâ–Š       | 14/50 [40:39<1:44:10, 173.63s/it, train_acc=88.6%, val_acc=87.0%]Fold 1 Seed 456:  28%|â–ˆâ–ˆâ–Š       | 14/50 [43:31<1:44:10, 173.63s/it, train_acc=88.3%, val_acc=87.2%]Fold 1 Seed 456:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [43:31<1:41:04, 173.27s/it, train_acc=88.3%, val_acc=87.2%]Fold 1 Seed 456:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [46:25<1:41:04, 173.27s/it, train_acc=88.5%, val_acc=86.8%]Fold 1 Seed 456:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [46:25<1:38:20, 173.53s/it, train_acc=88.5%, val_acc=86.8%]Fold 1 Seed 456:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [49:18<1:38:20, 173.53s/it, train_acc=88.7%, val_acc=86.2%]Fold 1 Seed 456:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [49:18<1:35:14, 173.16s/it, train_acc=88.7%, val_acc=86.2%]Fold 1 Seed 456:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [52:12<1:35:14, 173.16s/it, train_acc=88.5%, val_acc=86.8%]Fold 1 Seed 456:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [52:12<1:32:31, 173.49s/it, train_acc=88.5%, val_acc=86.8%]Fold 1 Seed 456:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [55:05<1:32:31, 173.49s/it, train_acc=88.5%, val_acc=86.6%]Fold 1 Seed 456:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [55:05<1:29:32, 173.32s/it, train_acc=88.5%, val_acc=86.6%]Fold 1 Seed 456:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [57:59<1:29:32, 173.32s/it, train_acc=88.8%, val_acc=86.2%]Fold 1 Seed 456:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [57:59<1:26:45, 173.51s/it, train_acc=88.8%, val_acc=86.2%]Fold 1 Seed 456:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [1:00:54<1:26:45, 173.51s/it, train_acc=88.6%, val_acc=86.0%]Fold 1 Seed 456:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:00:54<1:24:03, 173.92s/it, train_acc=88.6%, val_acc=86.0%]Fold 1 Seed 456:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:03:48<1:24:03, 173.92s/it, train_acc=89.0%, val_acc=86.6%]Fold 1 Seed 456:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:03:48<1:28:06, 182.29s/it, train_acc=89.0%, val_acc=86.6%]
INFO:__main__:  Subgroup Analysis:
INFO:__main__:    AD: 92.9% (42 samples)
INFO:__main__:    AD_trajectory: 49.7% (173 samples)
INFO:__main__:    CN: 96.4% (950 samples)
INFO:__main__:    MCI_to_AD: 77.1% (48 samples)
INFO:__main__:Fold 1 - Val: 87.42%, Test: 88.87%, Balanced: 79.01%
INFO:__main__:
--- Fold 2/5 ---
INFO:__main__:Train: 4367, Val: 485, Test: 1213
INFO:dataset:Filled 3 missing values in 'AGE' with 69.00
INFO:dataset:Filled 11 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 504 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 512 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 560 missing values in 'TRABSCOR' with 78.00
INFO:dataset:Filled 3345 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 3348 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 3334 missing values in 'BNTTOTAL' with 23.00
INFO:dataset:Filled 2400 missing values in 'VSWEIGHT' with 165.80
INFO:dataset:Filled 2397 missing values in 'BMI' with 29.54
INFO:dataset:Filled 2629 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 2628 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 2628 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 2628 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 4367 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 3413 (78.2%)
INFO:dataset:  Class 1: 954 (21.8%)
INFO:dataset:Filled 1 missing values in 'AGE' with 69.00
INFO:dataset:Filled 4 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 46 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 46 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 51 missing values in 'TRABSCOR' with 75.50
INFO:dataset:Filled 354 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 354 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 354 missing values in 'BNTTOTAL' with 24.00
INFO:dataset:Filled 256 missing values in 'VSWEIGHT' with 163.00
INFO:dataset:Filled 254 missing values in 'BMI' with 29.70
INFO:dataset:Filled 284 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 283 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 283 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 283 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 485 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 384 (79.2%)
INFO:dataset:  Class 1: 101 (20.8%)
INFO:dataset:Filled 1 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 134 missing values in 'CATANIMSC' with 21.00
INFO:dataset:Filled 135 missing values in 'TRAASCOR' with 30.00
INFO:dataset:Filled 142 missing values in 'TRABSCOR' with 75.00
INFO:dataset:Filled 939 missing values in 'DSPANFOR' with 7.00
INFO:dataset:Filled 940 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 937 missing values in 'BNTTOTAL' with 24.00
INFO:dataset:Filled 677 missing values in 'VSWEIGHT' with 164.00
INFO:dataset:Filled 675 missing values in 'BMI' with 29.46
INFO:dataset:Filled 751 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 751 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 751 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 751 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 1213 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 950 (78.3%)
INFO:dataset:  Class 1: 263 (21.7%)
INFO:mri_vit_model:Created ViT3DClassifier with vit_base
INFO:mri_vit_model:  Image size: 128x128x128
INFO:mri_vit_model:  Patch size: 16
INFO:mri_vit_model:  Num patches: 512
INFO:mri_vit_model:  Embed dim: 768, Depth: 12, Heads: 12
INFO:mri_vit_model:Loading MAE pre-trained weights from ../mri_vit_ad/pretrained/vit_mae75_pretrained.pth
INFO:mri_vit_model:  Loaded pos_embed directly (shapes match: torch.Size([1, 513, 768]))
INFO:mri_vit_model:Loaded 150 pretrained weights (including pos_embed, cls_token, patch_embed if matched)
INFO:mri_vit_model:Missing keys: 2
INFO:mri_vit_model:  Missing: ['head.1.weight', 'head.1.bias']
/home/tanguy/medical/alzheimer/env/lib/python3.12/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
ViT backbone: 768-dim features
FT-Transformer tabular encoder: 16 -> 64
  Auxiliary losses: Enabled (MRI + Tabular classifiers)
MultiModalFusion initialized:
  MRI backbone: vit (768-dim)
  Tabular features: 16 -> 64
  Fusion method: cross_modal
  Fusion hidden: 512
Fold 2 Seed 456:   0%|          | 0/50 [00:00<?, ?it/s]Fold 2 Seed 456:   0%|          | 0/50 [02:53<?, ?it/s, train_acc=61.1%, val_acc=79.2%]Fold 2 Seed 456:   2%|â–         | 1/50 [02:53<2:21:43, 173.54s/it, train_acc=61.1%, val_acc=79.2%]Fold 2 Seed 456:   2%|â–         | 1/50 [05:46<2:21:43, 173.54s/it, train_acc=78.0%, val_acc=79.2%]Fold 2 Seed 456:   4%|â–         | 2/50 [05:46<2:18:23, 172.99s/it, train_acc=78.0%, val_acc=79.2%]Fold 2 Seed 456:   4%|â–         | 2/50 [08:39<2:18:23, 172.99s/it, train_acc=85.7%, val_acc=87.4%]Fold 2 Seed 456:   6%|â–Œ         | 3/50 [08:39<2:15:36, 173.11s/it, train_acc=85.7%, val_acc=87.4%]Fold 2 Seed 456:   6%|â–Œ         | 3/50 [11:32<2:15:36, 173.11s/it, train_acc=88.4%, val_acc=86.0%]Fold 2 Seed 456:   8%|â–Š         | 4/50 [11:32<2:12:43, 173.11s/it, train_acc=88.4%, val_acc=86.0%]Fold 2 Seed 456:   8%|â–Š         | 4/50 [14:26<2:12:43, 173.11s/it, train_acc=88.7%, val_acc=87.4%]Fold 2 Seed 456:  10%|â–ˆ         | 5/50 [14:26<2:10:05, 173.46s/it, train_acc=88.7%, val_acc=87.4%]Fold 2 Seed 456:  10%|â–ˆ         | 5/50 [17:19<2:10:05, 173.46s/it, train_acc=87.8%, val_acc=87.6%]Fold 2 Seed 456:  12%|â–ˆâ–        | 6/50 [17:19<2:07:09, 173.39s/it, train_acc=87.8%, val_acc=87.6%]Fold 2 Seed 456:  12%|â–ˆâ–        | 6/50 [20:13<2:07:09, 173.39s/it, train_acc=88.2%, val_acc=87.2%]Fold 2 Seed 456:  14%|â–ˆâ–        | 7/50 [20:13<2:04:13, 173.34s/it, train_acc=88.2%, val_acc=87.2%]Fold 2 Seed 456:  14%|â–ˆâ–        | 7/50 [23:05<2:04:13, 173.34s/it, train_acc=88.9%, val_acc=88.2%]Fold 2 Seed 456:  16%|â–ˆâ–Œ        | 8/50 [23:05<2:01:14, 173.21s/it, train_acc=88.9%, val_acc=88.2%]Fold 2 Seed 456:  16%|â–ˆâ–Œ        | 8/50 [26:00<2:01:14, 173.21s/it, train_acc=88.8%, val_acc=88.2%]Fold 2 Seed 456:  18%|â–ˆâ–Š        | 9/50 [26:00<1:58:43, 173.74s/it, train_acc=88.8%, val_acc=88.2%]Fold 2 Seed 456:  18%|â–ˆâ–Š        | 9/50 [28:52<1:58:43, 173.74s/it, train_acc=88.7%, val_acc=87.8%]Fold 2 Seed 456:  20%|â–ˆâ–ˆ        | 10/50 [28:52<1:55:27, 173.18s/it, train_acc=88.7%, val_acc=87.8%]Fold 2 Seed 456:  20%|â–ˆâ–ˆ        | 10/50 [31:45<1:55:27, 173.18s/it, train_acc=89.3%, val_acc=87.8%]Fold 2 Seed 456:  22%|â–ˆâ–ˆâ–       | 11/50 [31:45<1:52:29, 173.07s/it, train_acc=89.3%, val_acc=87.8%]Fold 2 Seed 456:  22%|â–ˆâ–ˆâ–       | 11/50 [34:39<1:52:29, 173.07s/it, train_acc=89.4%, val_acc=88.9%]Fold 2 Seed 456:  24%|â–ˆâ–ˆâ–       | 12/50 [34:39<1:49:45, 173.29s/it, train_acc=89.4%, val_acc=88.9%]Fold 2 Seed 456:  24%|â–ˆâ–ˆâ–       | 12/50 [37:31<1:49:45, 173.29s/it, train_acc=89.2%, val_acc=88.0%]Fold 2 Seed 456:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [37:31<1:46:43, 173.05s/it, train_acc=89.2%, val_acc=88.0%]Fold 2 Seed 456:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [40:26<1:46:43, 173.05s/it, train_acc=89.5%, val_acc=88.0%]Fold 2 Seed 456:  28%|â–ˆâ–ˆâ–Š       | 14/50 [40:26<1:44:02, 173.39s/it, train_acc=89.5%, val_acc=88.0%]Fold 2 Seed 456:  28%|â–ˆâ–ˆâ–Š       | 14/50 [43:18<1:44:02, 173.39s/it, train_acc=89.9%, val_acc=89.7%]Fold 2 Seed 456:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [43:18<1:41:00, 173.15s/it, train_acc=89.9%, val_acc=89.7%]Fold 2 Seed 456:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [46:17<1:41:00, 173.15s/it, train_acc=90.5%, val_acc=88.9%]Fold 2 Seed 456:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [46:17<1:39:04, 174.84s/it, train_acc=90.5%, val_acc=88.9%]Fold 2 Seed 456:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [49:12<1:39:04, 174.84s/it, train_acc=91.0%, val_acc=90.9%]Fold 2 Seed 456:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [49:12<1:36:10, 174.87s/it, train_acc=91.0%, val_acc=90.9%]Fold 2 Seed 456:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [52:10<1:36:10, 174.87s/it, train_acc=91.5%, val_acc=87.8%]Fold 2 Seed 456:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [52:10<1:33:51, 175.97s/it, train_acc=91.5%, val_acc=87.8%]Fold 2 Seed 456:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [55:05<1:33:51, 175.97s/it, train_acc=91.6%, val_acc=89.3%]Fold 2 Seed 456:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [55:05<1:30:45, 175.67s/it, train_acc=91.6%, val_acc=89.3%]Fold 2 Seed 456:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [57:58<1:30:45, 175.67s/it, train_acc=92.4%, val_acc=89.3%]Fold 2 Seed 456:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [57:58<1:27:20, 174.69s/it, train_acc=92.4%, val_acc=89.3%]Fold 2 Seed 456:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [1:00:52<1:27:20, 174.69s/it, train_acc=92.5%, val_acc=89.9%]Fold 2 Seed 456:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:00:52<1:24:20, 174.48s/it, train_acc=92.5%, val_acc=89.9%]Fold 2 Seed 456:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:03:45<1:24:20, 174.48s/it, train_acc=92.3%, val_acc=90.1%]Fold 2 Seed 456:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:03:45<1:21:10, 173.94s/it, train_acc=92.3%, val_acc=90.1%]Fold 2 Seed 456:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:06:38<1:21:10, 173.94s/it, train_acc=92.9%, val_acc=91.8%]Fold 2 Seed 456:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:06:38<1:18:10, 173.74s/it, train_acc=92.9%, val_acc=91.8%]Fold 2 Seed 456:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:09:37<1:18:10, 173.74s/it, train_acc=93.4%, val_acc=91.8%]Fold 2 Seed 456:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:09:37<1:16:01, 175.43s/it, train_acc=93.4%, val_acc=91.8%]Fold 2 Seed 456:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:12:37<1:16:01, 175.43s/it, train_acc=93.0%, val_acc=90.1%]Fold 2 Seed 456:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:12:37<1:13:36, 176.64s/it, train_acc=93.0%, val_acc=90.1%]Fold 2 Seed 456:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:15:37<1:13:36, 176.64s/it, train_acc=93.2%, val_acc=90.7%]Fold 2 Seed 456:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:15:37<1:11:03, 177.63s/it, train_acc=93.2%, val_acc=90.7%]Fold 2 Seed 456:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:18:36<1:11:03, 177.63s/it, train_acc=93.6%, val_acc=90.5%]Fold 2 Seed 456:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:18:36<1:08:17, 178.15s/it, train_acc=93.6%, val_acc=90.5%]Fold 2 Seed 456:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:21:36<1:08:17, 178.15s/it, train_acc=93.6%, val_acc=90.9%]Fold 2 Seed 456:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:21:36<1:05:31, 178.70s/it, train_acc=93.6%, val_acc=90.9%]Fold 2 Seed 456:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:24:34<1:05:31, 178.70s/it, train_acc=94.1%, val_acc=91.5%]Fold 2 Seed 456:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:24:34<1:02:29, 178.55s/it, train_acc=94.1%, val_acc=91.5%]Fold 2 Seed 456:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:27:32<1:02:29, 178.55s/it, train_acc=93.8%, val_acc=91.1%]Fold 2 Seed 456:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:27:32<59:28, 178.44s/it, train_acc=93.8%, val_acc=91.1%]  Fold 2 Seed 456:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:30:31<59:28, 178.44s/it, train_acc=94.5%, val_acc=91.3%]Fold 2 Seed 456:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:30:31<56:33, 178.63s/it, train_acc=94.5%, val_acc=91.3%]Fold 2 Seed 456:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:33:29<56:33, 178.63s/it, train_acc=94.5%, val_acc=92.0%]Fold 2 Seed 456:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:33:29<53:32, 178.45s/it, train_acc=94.5%, val_acc=92.0%]Fold 2 Seed 456:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:36:29<53:32, 178.45s/it, train_acc=94.6%, val_acc=91.3%]Fold 2 Seed 456:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:36:29<50:41, 178.93s/it, train_acc=94.6%, val_acc=91.3%]Fold 2 Seed 456:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:39:29<50:41, 178.93s/it, train_acc=94.9%, val_acc=92.2%]Fold 2 Seed 456:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 34/50 [1:39:29<47:46, 179.18s/it, train_acc=94.9%, val_acc=92.2%]Fold 2 Seed 456:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 34/50 [1:42:28<47:46, 179.18s/it, train_acc=95.3%, val_acc=91.8%]Fold 2 Seed 456:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 35/50 [1:42:28<44:43, 178.93s/it, train_acc=95.3%, val_acc=91.8%]Fold 2 Seed 456:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 35/50 [1:45:27<44:43, 178.93s/it, train_acc=95.3%, val_acc=91.3%]Fold 2 Seed 456:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [1:45:27<41:46, 179.07s/it, train_acc=95.3%, val_acc=91.3%]Fold 2 Seed 456:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [1:48:28<41:46, 179.07s/it, train_acc=95.3%, val_acc=92.2%]Fold 2 Seed 456:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 37/50 [1:48:28<38:54, 179.58s/it, train_acc=95.3%, val_acc=92.2%]Fold 2 Seed 456:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 37/50 [1:51:26<38:54, 179.58s/it, train_acc=95.6%, val_acc=93.0%]Fold 2 Seed 456:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 38/50 [1:51:26<35:49, 179.12s/it, train_acc=95.6%, val_acc=93.0%]Fold 2 Seed 456:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 38/50 [1:54:24<35:49, 179.12s/it, train_acc=95.8%, val_acc=93.0%]Fold 2 Seed 456:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 39/50 [1:54:24<32:48, 178.95s/it, train_acc=95.8%, val_acc=93.0%]Fold 2 Seed 456:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 39/50 [1:57:17<32:48, 178.95s/it, train_acc=95.8%, val_acc=91.8%]Fold 2 Seed 456:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 40/50 [1:57:17<29:29, 176.95s/it, train_acc=95.8%, val_acc=91.8%]Fold 2 Seed 456:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 40/50 [2:00:09<29:29, 176.95s/it, train_acc=95.8%, val_acc=92.6%]Fold 2 Seed 456:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 41/50 [2:00:09<26:21, 175.70s/it, train_acc=95.8%, val_acc=92.6%]Fold 2 Seed 456:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 41/50 [2:03:03<26:21, 175.70s/it, train_acc=96.1%, val_acc=92.0%]Fold 2 Seed 456:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 42/50 [2:03:03<23:20, 175.05s/it, train_acc=96.1%, val_acc=92.0%]Fold 2 Seed 456:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 42/50 [2:05:57<23:20, 175.05s/it, train_acc=96.4%, val_acc=91.8%]Fold 2 Seed 456:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 43/50 [2:05:57<20:23, 174.76s/it, train_acc=96.4%, val_acc=91.8%]Fold 2 Seed 456:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 43/50 [2:08:50<20:23, 174.76s/it, train_acc=96.6%, val_acc=92.6%]Fold 2 Seed 456:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 44/50 [2:08:50<17:25, 174.33s/it, train_acc=96.6%, val_acc=92.6%]Fold 2 Seed 456:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 44/50 [2:11:45<17:25, 174.33s/it, train_acc=96.5%, val_acc=92.2%]Fold 2 Seed 456:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 45/50 [2:11:45<14:32, 174.48s/it, train_acc=96.5%, val_acc=92.2%]Fold 2 Seed 456:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 45/50 [2:14:39<14:32, 174.48s/it, train_acc=96.8%, val_acc=92.4%]Fold 2 Seed 456:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 46/50 [2:14:39<11:37, 174.27s/it, train_acc=96.8%, val_acc=92.4%]Fold 2 Seed 456:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 46/50 [2:17:33<11:37, 174.27s/it, train_acc=96.5%, val_acc=92.4%]Fold 2 Seed 456:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 47/50 [2:17:33<08:42, 174.27s/it, train_acc=96.5%, val_acc=92.4%]Fold 2 Seed 456:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 47/50 [2:20:27<08:42, 174.27s/it, train_acc=96.8%, val_acc=92.2%]Fold 2 Seed 456:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 48/50 [2:20:27<05:48, 174.24s/it, train_acc=96.8%, val_acc=92.2%]Fold 2 Seed 456:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 48/50 [2:23:21<05:48, 174.24s/it, train_acc=96.7%, val_acc=92.2%]Fold 2 Seed 456:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 49/50 [2:23:21<02:54, 174.16s/it, train_acc=96.7%, val_acc=92.2%]Fold 2 Seed 456:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 49/50 [2:26:15<02:54, 174.16s/it, train_acc=96.3%, val_acc=92.2%]Fold 2 Seed 456: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 50/50 [2:26:15<00:00, 174.00s/it, train_acc=96.3%, val_acc=92.2%]Fold 2 Seed 456: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 50/50 [2:26:15<00:00, 175.51s/it, train_acc=96.3%, val_acc=92.2%]
INFO:__main__:  Subgroup Analysis:
INFO:__main__:    AD: 100.0% (33 samples)
INFO:__main__:    AD_trajectory: 75.7% (177 samples)
INFO:__main__:    CN: 95.6% (950 samples)
INFO:__main__:    MCI_to_AD: 79.2% (53 samples)
INFO:__main__:Fold 2 - Val: 92.99%, Test: 92.09%, Balanced: 87.52%
INFO:__main__:
--- Fold 3/5 ---
INFO:__main__:Train: 4367, Val: 485, Test: 1213
INFO:dataset:Filled 2 missing values in 'AGE' with 69.00
INFO:dataset:Filled 12 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 487 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 492 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 529 missing values in 'TRABSCOR' with 77.00
INFO:dataset:Filled 3341 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 3344 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 3333 missing values in 'BNTTOTAL' with 23.00
INFO:dataset:Filled 2411 missing values in 'VSWEIGHT' with 165.90
INFO:dataset:Filled 2407 missing values in 'BMI' with 29.60
INFO:dataset:Filled 2654 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 2652 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 2652 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 2652 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 4367 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 3409 (78.1%)
INFO:dataset:  Class 1: 958 (21.9%)
INFO:dataset:Filled 58 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 58 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 66 missing values in 'TRABSCOR' with 75.00
INFO:dataset:Filled 363 missing values in 'DSPANFOR' with 7.00
INFO:dataset:Filled 363 missing values in 'DSPANBAC' with 5.00
INFO:dataset:Filled 362 missing values in 'BNTTOTAL' with 23.00
INFO:dataset:Filled 254 missing values in 'VSWEIGHT' with 165.00
INFO:dataset:Filled 254 missing values in 'BMI' with 30.09
INFO:dataset:Filled 283 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 283 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 283 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 283 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 485 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 389 (80.2%)
INFO:dataset:  Class 1: 96 (19.8%)
INFO:dataset:Filled 2 missing values in 'AGE' with 69.00
INFO:dataset:Filled 4 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 139 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 143 missing values in 'TRAASCOR' with 30.00
INFO:dataset:Filled 158 missing values in 'TRABSCOR' with 78.00
INFO:dataset:Filled 934 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 935 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 930 missing values in 'BNTTOTAL' with 24.00
INFO:dataset:Filled 668 missing values in 'VSWEIGHT' with 164.00
INFO:dataset:Filled 665 missing values in 'BMI' with 28.78
INFO:dataset:Filled 727 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 727 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 727 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 727 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 1213 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 949 (78.2%)
INFO:dataset:  Class 1: 264 (21.8%)
INFO:mri_vit_model:Created ViT3DClassifier with vit_base
INFO:mri_vit_model:  Image size: 128x128x128
INFO:mri_vit_model:  Patch size: 16
INFO:mri_vit_model:  Num patches: 512
INFO:mri_vit_model:  Embed dim: 768, Depth: 12, Heads: 12
INFO:mri_vit_model:Loading MAE pre-trained weights from ../mri_vit_ad/pretrained/vit_mae75_pretrained.pth
INFO:mri_vit_model:  Loaded pos_embed directly (shapes match: torch.Size([1, 513, 768]))
INFO:mri_vit_model:Loaded 150 pretrained weights (including pos_embed, cls_token, patch_embed if matched)
INFO:mri_vit_model:Missing keys: 2
INFO:mri_vit_model:  Missing: ['head.1.weight', 'head.1.bias']
/home/tanguy/medical/alzheimer/env/lib/python3.12/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
ViT backbone: 768-dim features
FT-Transformer tabular encoder: 16 -> 64
  Auxiliary losses: Enabled (MRI + Tabular classifiers)
MultiModalFusion initialized:
  MRI backbone: vit (768-dim)
  Tabular features: 16 -> 64
  Fusion method: cross_modal
  Fusion hidden: 512
Fold 3 Seed 456:   0%|          | 0/50 [00:00<?, ?it/s]Fold 3 Seed 456:   0%|          | 0/50 [02:52<?, ?it/s, train_acc=62.7%, val_acc=80.2%]Fold 3 Seed 456:   2%|â–         | 1/50 [02:52<2:21:11, 172.88s/it, train_acc=62.7%, val_acc=80.2%]Fold 3 Seed 456:   2%|â–         | 1/50 [05:46<2:21:11, 172.88s/it, train_acc=77.8%, val_acc=80.4%]Fold 3 Seed 456:   4%|â–         | 2/50 [05:47<2:18:53, 173.61s/it, train_acc=77.8%, val_acc=80.4%]Fold 3 Seed 456:   4%|â–         | 2/50 [08:39<2:18:53, 173.61s/it, train_acc=84.7%, val_acc=86.2%]Fold 3 Seed 456:   6%|â–Œ         | 3/50 [08:39<2:15:32, 173.03s/it, train_acc=84.7%, val_acc=86.2%]Fold 3 Seed 456:   6%|â–Œ         | 3/50 [11:34<2:15:32, 173.03s/it, train_acc=87.3%, val_acc=88.2%]Fold 3 Seed 456:   8%|â–Š         | 4/50 [11:34<2:13:15, 173.81s/it, train_acc=87.3%, val_acc=88.2%]Fold 3 Seed 456:   8%|â–Š         | 4/50 [14:26<2:13:15, 173.81s/it, train_acc=88.3%, val_acc=88.2%]Fold 3 Seed 456:  10%|â–ˆ         | 5/50 [14:26<2:09:57, 173.29s/it, train_acc=88.3%, val_acc=88.2%]Fold 3 Seed 456:  10%|â–ˆ         | 5/50 [17:19<2:09:57, 173.29s/it, train_acc=88.3%, val_acc=87.8%]Fold 3 Seed 456:  12%|â–ˆâ–        | 6/50 [17:19<2:06:55, 173.08s/it, train_acc=88.3%, val_acc=87.8%]Fold 3 Seed 456:  12%|â–ˆâ–        | 6/50 [20:13<2:06:55, 173.08s/it, train_acc=88.7%, val_acc=89.7%]Fold 3 Seed 456:  14%|â–ˆâ–        | 7/50 [20:13<2:04:17, 173.44s/it, train_acc=88.7%, val_acc=89.7%]Fold 3 Seed 456:  14%|â–ˆâ–        | 7/50 [23:06<2:04:17, 173.44s/it, train_acc=89.3%, val_acc=87.8%]Fold 3 Seed 456:  16%|â–ˆâ–Œ        | 8/50 [23:06<2:01:21, 173.37s/it, train_acc=89.3%, val_acc=87.8%]Fold 3 Seed 456:  16%|â–ˆâ–Œ        | 8/50 [25:58<2:01:21, 173.37s/it, train_acc=89.1%, val_acc=90.3%]Fold 3 Seed 456:  18%|â–ˆâ–Š        | 9/50 [25:59<1:58:15, 173.05s/it, train_acc=89.1%, val_acc=90.3%]Fold 3 Seed 456:  18%|â–ˆâ–Š        | 9/50 [28:50<1:58:15, 173.05s/it, train_acc=90.0%, val_acc=91.1%]Fold 3 Seed 456:  20%|â–ˆâ–ˆ        | 10/50 [28:50<1:55:04, 172.62s/it, train_acc=90.0%, val_acc=91.1%]Fold 3 Seed 456:  20%|â–ˆâ–ˆ        | 10/50 [31:43<1:55:04, 172.62s/it, train_acc=90.6%, val_acc=88.7%]Fold 3 Seed 456:  22%|â–ˆâ–ˆâ–       | 11/50 [31:43<1:52:17, 172.75s/it, train_acc=90.6%, val_acc=88.7%]Fold 3 Seed 456:  22%|â–ˆâ–ˆâ–       | 11/50 [34:36<1:52:17, 172.75s/it, train_acc=91.1%, val_acc=91.8%]Fold 3 Seed 456:  24%|â–ˆâ–ˆâ–       | 12/50 [34:36<1:49:26, 172.80s/it, train_acc=91.1%, val_acc=91.8%]Fold 3 Seed 456:  24%|â–ˆâ–ˆâ–       | 12/50 [37:35<1:49:26, 172.80s/it, train_acc=91.4%, val_acc=91.5%]Fold 3 Seed 456:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [37:35<1:47:45, 174.74s/it, train_acc=91.4%, val_acc=91.5%]Fold 3 Seed 456:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [40:35<1:47:45, 174.74s/it, train_acc=92.1%, val_acc=92.2%]Fold 3 Seed 456:  28%|â–ˆâ–ˆâ–Š       | 14/50 [40:35<1:45:44, 176.24s/it, train_acc=92.1%, val_acc=92.2%]Fold 3 Seed 456:  28%|â–ˆâ–ˆâ–Š       | 14/50 [43:34<1:45:44, 176.24s/it, train_acc=92.4%, val_acc=92.2%]Fold 3 Seed 456:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [43:34<1:43:16, 177.04s/it, train_acc=92.4%, val_acc=92.2%]Fold 3 Seed 456:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [46:27<1:43:16, 177.04s/it, train_acc=92.3%, val_acc=91.3%]Fold 3 Seed 456:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [46:27<1:39:34, 175.73s/it, train_acc=92.3%, val_acc=91.3%]Fold 3 Seed 456:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [49:20<1:39:34, 175.73s/it, train_acc=92.5%, val_acc=92.2%]Fold 3 Seed 456:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [49:20<1:36:14, 174.97s/it, train_acc=92.5%, val_acc=92.2%]Fold 3 Seed 456:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [52:14<1:36:14, 174.97s/it, train_acc=92.9%, val_acc=91.5%]Fold 3 Seed 456:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [52:14<1:33:06, 174.58s/it, train_acc=92.9%, val_acc=91.5%]Fold 3 Seed 456:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [55:08<1:33:06, 174.58s/it, train_acc=92.9%, val_acc=91.5%]Fold 3 Seed 456:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [55:08<1:30:10, 174.52s/it, train_acc=92.9%, val_acc=91.5%]Fold 3 Seed 456:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [58:02<1:30:10, 174.52s/it, train_acc=93.4%, val_acc=91.8%]Fold 3 Seed 456:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [58:02<1:27:13, 174.46s/it, train_acc=93.4%, val_acc=91.8%]Fold 3 Seed 456:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [1:00:55<1:27:13, 174.46s/it, train_acc=93.7%, val_acc=91.8%]Fold 3 Seed 456:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:00:55<1:24:07, 174.06s/it, train_acc=93.7%, val_acc=91.8%]Fold 3 Seed 456:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:03:49<1:24:07, 174.06s/it, train_acc=94.1%, val_acc=93.0%]Fold 3 Seed 456:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:03:49<1:21:07, 173.85s/it, train_acc=94.1%, val_acc=93.0%]Fold 3 Seed 456:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:06:48<1:21:07, 173.85s/it, train_acc=94.3%, val_acc=92.4%]Fold 3 Seed 456:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:06:48<1:19:00, 175.58s/it, train_acc=94.3%, val_acc=92.4%]Fold 3 Seed 456:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:09:47<1:19:00, 175.58s/it, train_acc=94.5%, val_acc=92.4%]Fold 3 Seed 456:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:09:47<1:16:30, 176.56s/it, train_acc=94.5%, val_acc=92.4%]Fold 3 Seed 456:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:12:46<1:16:30, 176.56s/it, train_acc=94.3%, val_acc=92.8%]Fold 3 Seed 456:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:12:46<1:13:48, 177.14s/it, train_acc=94.3%, val_acc=92.8%]Fold 3 Seed 456:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:15:44<1:13:48, 177.14s/it, train_acc=94.8%, val_acc=92.6%]Fold 3 Seed 456:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:15:44<1:11:02, 177.59s/it, train_acc=94.8%, val_acc=92.6%]Fold 3 Seed 456:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:18:46<1:11:02, 177.59s/it, train_acc=94.8%, val_acc=92.0%]Fold 3 Seed 456:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:18:46<1:08:30, 178.73s/it, train_acc=94.8%, val_acc=92.0%]Fold 3 Seed 456:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:21:46<1:08:30, 178.73s/it, train_acc=94.8%, val_acc=92.6%]Fold 3 Seed 456:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:21:46<1:05:40, 179.12s/it, train_acc=94.8%, val_acc=92.6%]Fold 3 Seed 456:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:24:46<1:05:40, 179.12s/it, train_acc=95.8%, val_acc=93.0%]Fold 3 Seed 456:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:24:46<1:02:46, 179.37s/it, train_acc=95.8%, val_acc=93.0%]Fold 3 Seed 456:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:27:45<1:02:46, 179.37s/it, train_acc=96.0%, val_acc=90.3%]Fold 3 Seed 456:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:27:45<59:47, 179.37s/it, train_acc=96.0%, val_acc=90.3%]  Fold 3 Seed 456:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:30:45<59:47, 179.37s/it, train_acc=96.4%, val_acc=92.0%]Fold 3 Seed 456:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:30:45<56:53, 179.63s/it, train_acc=96.4%, val_acc=92.0%]Fold 3 Seed 456:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:33:43<56:53, 179.63s/it, train_acc=96.3%, val_acc=92.0%]Fold 3 Seed 456:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:33:43<53:42, 179.03s/it, train_acc=96.3%, val_acc=92.0%]Fold 3 Seed 456:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:36:42<53:42, 179.03s/it, train_acc=96.3%, val_acc=92.8%]Fold 3 Seed 456:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:36:42<50:45, 179.12s/it, train_acc=96.3%, val_acc=92.8%]Fold 3 Seed 456:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:39:41<50:45, 179.12s/it, train_acc=96.8%, val_acc=92.2%]Fold 3 Seed 456:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 34/50 [1:39:41<47:42, 178.92s/it, train_acc=96.8%, val_acc=92.2%]Fold 3 Seed 456:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 34/50 [1:42:41<47:42, 178.92s/it, train_acc=97.0%, val_acc=92.2%]Fold 3 Seed 456:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 35/50 [1:42:41<44:49, 179.30s/it, train_acc=97.0%, val_acc=92.2%]Fold 3 Seed 456:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 35/50 [1:45:40<44:49, 179.30s/it, train_acc=97.4%, val_acc=92.2%]Fold 3 Seed 456:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [1:45:40<41:50, 179.35s/it, train_acc=97.4%, val_acc=92.2%]Fold 3 Seed 456:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [1:48:40<41:50, 179.35s/it, train_acc=97.4%, val_acc=92.6%]Fold 3 Seed 456:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [1:48:40<42:15, 181.12s/it, train_acc=97.4%, val_acc=92.6%]
INFO:__main__:  Subgroup Analysis:
INFO:__main__:    AD: 94.3% (35 samples)
INFO:__main__:    AD_trajectory: 70.5% (173 samples)
INFO:__main__:    CN: 96.7% (949 samples)
INFO:__main__:    MCI_to_AD: 82.1% (56 samples)
INFO:__main__:Fold 3 - Val: 92.99%, Test: 92.25%, Balanced: 86.43%
INFO:__main__:
--- Fold 4/5 ---
INFO:__main__:Train: 4367, Val: 485, Test: 1213
INFO:dataset:Filled 2 missing values in 'AGE' with 69.00
INFO:dataset:Filled 12 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 485 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 491 missing values in 'TRAASCOR' with 30.00
INFO:dataset:Filled 526 missing values in 'TRABSCOR' with 76.00
INFO:dataset:Filled 3364 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 3365 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 3355 missing values in 'BNTTOTAL' with 23.00
INFO:dataset:Filled 2421 missing values in 'VSWEIGHT' with 164.00
INFO:dataset:Filled 2418 missing values in 'BMI' with 29.26
INFO:dataset:Filled 2662 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 2660 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 2660 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 2660 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 4367 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 3425 (78.4%)
INFO:dataset:  Class 1: 942 (21.6%)
INFO:dataset:Filled 52 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 53 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 60 missing values in 'TRABSCOR' with 79.00
INFO:dataset:Filled 376 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 377 missing values in 'DSPANBAC' with 4.50
INFO:dataset:Filled 375 missing values in 'BNTTOTAL' with 25.00
INFO:dataset:Filled 276 missing values in 'VSWEIGHT' with 165.00
INFO:dataset:Filled 273 missing values in 'BMI' with 30.31
INFO:dataset:Filled 301 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 301 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 301 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 301 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 485 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 373 (76.9%)
INFO:dataset:  Class 1: 112 (23.1%)
INFO:dataset:Filled 2 missing values in 'AGE' with 69.74
INFO:dataset:Filled 4 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 147 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 149 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 167 missing values in 'TRABSCOR' with 78.00
INFO:dataset:Filled 898 missing values in 'DSPANFOR' with 7.00
INFO:dataset:Filled 900 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 895 missing values in 'BNTTOTAL' with 24.50
INFO:dataset:Filled 636 missing values in 'VSWEIGHT' with 168.00
INFO:dataset:Filled 635 missing values in 'BMI' with 30.64
INFO:dataset:Filled 701 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 701 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 701 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 701 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 1213 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 949 (78.2%)
INFO:dataset:  Class 1: 264 (21.8%)
INFO:mri_vit_model:Created ViT3DClassifier with vit_base
INFO:mri_vit_model:  Image size: 128x128x128
INFO:mri_vit_model:  Patch size: 16
INFO:mri_vit_model:  Num patches: 512
INFO:mri_vit_model:  Embed dim: 768, Depth: 12, Heads: 12
INFO:mri_vit_model:Loading MAE pre-trained weights from ../mri_vit_ad/pretrained/vit_mae75_pretrained.pth
INFO:mri_vit_model:  Loaded pos_embed directly (shapes match: torch.Size([1, 513, 768]))
INFO:mri_vit_model:Loaded 150 pretrained weights (including pos_embed, cls_token, patch_embed if matched)
INFO:mri_vit_model:Missing keys: 2
INFO:mri_vit_model:  Missing: ['head.1.weight', 'head.1.bias']
/home/tanguy/medical/alzheimer/env/lib/python3.12/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
ViT backbone: 768-dim features
FT-Transformer tabular encoder: 16 -> 64
  Auxiliary losses: Enabled (MRI + Tabular classifiers)
MultiModalFusion initialized:
  MRI backbone: vit (768-dim)
  Tabular features: 16 -> 64
  Fusion method: cross_modal
  Fusion hidden: 512
Fold 4 Seed 456:   0%|          | 0/50 [00:00<?, ?it/s]Fold 4 Seed 456:   0%|          | 0/50 [02:53<?, ?it/s, train_acc=60.8%, val_acc=76.9%]Fold 4 Seed 456:   2%|â–         | 1/50 [02:53<2:21:38, 173.43s/it, train_acc=60.8%, val_acc=76.9%]Fold 4 Seed 456:   2%|â–         | 1/50 [05:48<2:21:38, 173.43s/it, train_acc=77.4%, val_acc=77.1%]Fold 4 Seed 456:   4%|â–         | 2/50 [05:48<2:19:28, 174.35s/it, train_acc=77.4%, val_acc=77.1%]Fold 4 Seed 456:   4%|â–         | 2/50 [08:42<2:19:28, 174.35s/it, train_acc=84.3%, val_acc=88.2%]Fold 4 Seed 456:   6%|â–Œ         | 3/50 [08:42<2:16:34, 174.36s/it, train_acc=84.3%, val_acc=88.2%]Fold 4 Seed 456:   6%|â–Œ         | 3/50 [11:35<2:16:34, 174.36s/it, train_acc=87.7%, val_acc=89.5%]Fold 4 Seed 456:   8%|â–Š         | 4/50 [11:36<2:13:20, 173.93s/it, train_acc=87.7%, val_acc=89.5%]Fold 4 Seed 456:   8%|â–Š         | 4/50 [14:29<2:13:20, 173.93s/it, train_acc=87.4%, val_acc=89.1%]Fold 4 Seed 456:  10%|â–ˆ         | 5/50 [14:29<2:10:20, 173.78s/it, train_acc=87.4%, val_acc=89.1%]Fold 4 Seed 456:  10%|â–ˆ         | 5/50 [17:22<2:10:20, 173.78s/it, train_acc=87.7%, val_acc=88.0%]Fold 4 Seed 456:  12%|â–ˆâ–        | 6/50 [17:22<2:07:14, 173.52s/it, train_acc=87.7%, val_acc=88.0%]Fold 4 Seed 456:  12%|â–ˆâ–        | 6/50 [20:16<2:07:14, 173.52s/it, train_acc=88.2%, val_acc=89.7%]Fold 4 Seed 456:  14%|â–ˆâ–        | 7/50 [20:16<2:04:26, 173.64s/it, train_acc=88.2%, val_acc=89.7%]Fold 4 Seed 456:  14%|â–ˆâ–        | 7/50 [23:08<2:04:26, 173.64s/it, train_acc=88.2%, val_acc=88.9%]Fold 4 Seed 456:  16%|â–ˆâ–Œ        | 8/50 [23:08<2:01:16, 173.26s/it, train_acc=88.2%, val_acc=88.9%]Fold 4 Seed 456:  16%|â–ˆâ–Œ        | 8/50 [26:02<2:01:16, 173.26s/it, train_acc=87.8%, val_acc=88.0%]Fold 4 Seed 456:  18%|â–ˆâ–Š        | 9/50 [26:02<1:58:23, 173.25s/it, train_acc=87.8%, val_acc=88.0%]Fold 4 Seed 456:  18%|â–ˆâ–Š        | 9/50 [28:55<1:58:23, 173.25s/it, train_acc=88.6%, val_acc=92.2%]Fold 4 Seed 456:  20%|â–ˆâ–ˆ        | 10/50 [28:55<1:55:28, 173.21s/it, train_acc=88.6%, val_acc=92.2%]Fold 4 Seed 456:  20%|â–ˆâ–ˆ        | 10/50 [31:55<1:55:28, 173.21s/it, train_acc=89.3%, val_acc=92.0%]Fold 4 Seed 456:  22%|â–ˆâ–ˆâ–       | 11/50 [31:55<1:54:00, 175.40s/it, train_acc=89.3%, val_acc=92.0%]Fold 4 Seed 456:  22%|â–ˆâ–ˆâ–       | 11/50 [34:49<1:54:00, 175.40s/it, train_acc=90.1%, val_acc=91.3%]Fold 4 Seed 456:  24%|â–ˆâ–ˆâ–       | 12/50 [34:49<1:50:52, 175.06s/it, train_acc=90.1%, val_acc=91.3%]Fold 4 Seed 456:  24%|â–ˆâ–ˆâ–       | 12/50 [37:45<1:50:52, 175.06s/it, train_acc=90.4%, val_acc=92.6%]Fold 4 Seed 456:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [37:45<1:47:59, 175.13s/it, train_acc=90.4%, val_acc=92.6%]Fold 4 Seed 456:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [40:44<1:47:59, 175.13s/it, train_acc=91.1%, val_acc=92.2%]Fold 4 Seed 456:  28%|â–ˆâ–ˆâ–Š       | 14/50 [40:44<1:45:53, 176.49s/it, train_acc=91.1%, val_acc=92.2%]Fold 4 Seed 456:  28%|â–ˆâ–ˆâ–Š       | 14/50 [43:38<1:45:53, 176.49s/it, train_acc=91.3%, val_acc=91.5%]Fold 4 Seed 456:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [43:38<1:42:30, 175.72s/it, train_acc=91.3%, val_acc=91.5%]Fold 4 Seed 456:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [46:33<1:42:30, 175.72s/it, train_acc=91.5%, val_acc=92.2%]Fold 4 Seed 456:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [46:33<1:39:25, 175.47s/it, train_acc=91.5%, val_acc=92.2%]Fold 4 Seed 456:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [49:26<1:39:25, 175.47s/it, train_acc=92.3%, val_acc=93.0%]Fold 4 Seed 456:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [49:26<1:36:08, 174.79s/it, train_acc=92.3%, val_acc=93.0%]Fold 4 Seed 456:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [52:26<1:36:08, 174.79s/it, train_acc=92.2%, val_acc=92.2%]Fold 4 Seed 456:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [52:26<1:34:00, 176.28s/it, train_acc=92.2%, val_acc=92.2%]Fold 4 Seed 456:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [55:25<1:34:00, 176.28s/it, train_acc=92.2%, val_acc=90.9%]Fold 4 Seed 456:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [55:25<1:31:30, 177.12s/it, train_acc=92.2%, val_acc=90.9%]Fold 4 Seed 456:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [58:23<1:31:30, 177.12s/it, train_acc=92.6%, val_acc=92.0%]Fold 4 Seed 456:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [58:23<1:28:43, 177.44s/it, train_acc=92.6%, val_acc=92.0%]Fold 4 Seed 456:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [1:01:23<1:28:43, 177.44s/it, train_acc=92.8%, val_acc=93.2%]Fold 4 Seed 456:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:01:23<1:26:05, 178.12s/it, train_acc=92.8%, val_acc=93.2%]Fold 4 Seed 456:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:04:23<1:26:05, 178.12s/it, train_acc=92.9%, val_acc=92.2%]Fold 4 Seed 456:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:04:23<1:23:20, 178.58s/it, train_acc=92.9%, val_acc=92.2%]Fold 4 Seed 456:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:07:24<1:23:20, 178.58s/it, train_acc=93.1%, val_acc=92.6%]Fold 4 Seed 456:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:07:24<1:20:44, 179.41s/it, train_acc=93.1%, val_acc=92.6%]Fold 4 Seed 456:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:10:24<1:20:44, 179.41s/it, train_acc=93.7%, val_acc=92.4%]Fold 4 Seed 456:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:10:24<1:17:45, 179.46s/it, train_acc=93.7%, val_acc=92.4%]Fold 4 Seed 456:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:13:22<1:17:45, 179.46s/it, train_acc=93.7%, val_acc=92.4%]Fold 4 Seed 456:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:13:22<1:14:38, 179.13s/it, train_acc=93.7%, val_acc=92.4%]Fold 4 Seed 456:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:16:24<1:14:38, 179.13s/it, train_acc=94.0%, val_acc=92.0%]Fold 4 Seed 456:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:16:24<1:11:56, 179.86s/it, train_acc=94.0%, val_acc=92.0%]Fold 4 Seed 456:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:19:23<1:11:56, 179.86s/it, train_acc=94.3%, val_acc=92.2%]Fold 4 Seed 456:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:19:23<1:08:52, 179.67s/it, train_acc=94.3%, val_acc=92.2%]Fold 4 Seed 456:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:22:22<1:08:52, 179.67s/it, train_acc=93.9%, val_acc=93.4%]Fold 4 Seed 456:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:22:22<1:05:49, 179.51s/it, train_acc=93.9%, val_acc=93.4%]Fold 4 Seed 456:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:25:22<1:05:49, 179.51s/it, train_acc=94.8%, val_acc=92.4%]Fold 4 Seed 456:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:25:22<1:02:50, 179.56s/it, train_acc=94.8%, val_acc=92.4%]Fold 4 Seed 456:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:28:19<1:02:50, 179.56s/it, train_acc=95.1%, val_acc=93.6%]Fold 4 Seed 456:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:28:20<59:41, 179.07s/it, train_acc=95.1%, val_acc=93.6%]  Fold 4 Seed 456:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:31:19<59:41, 179.07s/it, train_acc=95.4%, val_acc=92.2%]Fold 4 Seed 456:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:31:19<56:45, 179.26s/it, train_acc=95.4%, val_acc=92.2%]Fold 4 Seed 456:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:34:17<56:45, 179.26s/it, train_acc=95.1%, val_acc=92.6%]Fold 4 Seed 456:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:34:17<53:40, 178.91s/it, train_acc=95.1%, val_acc=92.6%]Fold 4 Seed 456:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:37:17<53:40, 178.91s/it, train_acc=95.8%, val_acc=92.6%]Fold 4 Seed 456:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:37:17<50:42, 178.99s/it, train_acc=95.8%, val_acc=92.6%]Fold 4 Seed 456:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:40:16<50:42, 178.99s/it, train_acc=96.0%, val_acc=91.8%]Fold 4 Seed 456:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 34/50 [1:40:16<47:47, 179.20s/it, train_acc=96.0%, val_acc=91.8%]Fold 4 Seed 456:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 34/50 [1:43:15<47:47, 179.20s/it, train_acc=95.9%, val_acc=92.4%]Fold 4 Seed 456:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 35/50 [1:43:15<44:47, 179.19s/it, train_acc=95.9%, val_acc=92.4%]Fold 4 Seed 456:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 35/50 [1:46:15<44:47, 179.19s/it, train_acc=96.3%, val_acc=92.2%]Fold 4 Seed 456:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [1:46:15<41:51, 179.41s/it, train_acc=96.3%, val_acc=92.2%]Fold 4 Seed 456:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [1:49:15<41:51, 179.41s/it, train_acc=96.7%, val_acc=91.8%]Fold 4 Seed 456:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 37/50 [1:49:15<38:53, 179.52s/it, train_acc=96.7%, val_acc=91.8%]Fold 4 Seed 456:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 37/50 [1:52:14<38:53, 179.52s/it, train_acc=96.6%, val_acc=92.0%]Fold 4 Seed 456:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 38/50 [1:52:14<35:50, 179.22s/it, train_acc=96.6%, val_acc=92.0%]Fold 4 Seed 456:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 38/50 [1:55:13<35:50, 179.22s/it, train_acc=96.6%, val_acc=92.8%]Fold 4 Seed 456:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 39/50 [1:55:13<32:52, 179.36s/it, train_acc=96.6%, val_acc=92.8%]Fold 4 Seed 456:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 39/50 [1:58:12<32:52, 179.36s/it, train_acc=97.1%, val_acc=92.6%]Fold 4 Seed 456:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 40/50 [1:58:12<29:50, 179.07s/it, train_acc=97.1%, val_acc=92.6%]Fold 4 Seed 456:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 40/50 [2:01:12<29:50, 179.07s/it, train_acc=97.1%, val_acc=92.4%]Fold 4 Seed 456:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 41/50 [2:01:12<26:55, 179.49s/it, train_acc=97.1%, val_acc=92.4%]Fold 4 Seed 456:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 41/50 [2:04:13<26:55, 179.49s/it, train_acc=97.5%, val_acc=91.5%]Fold 4 Seed 456:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 42/50 [2:04:13<23:58, 179.75s/it, train_acc=97.5%, val_acc=91.5%]Fold 4 Seed 456:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 42/50 [2:07:13<23:58, 179.75s/it, train_acc=97.1%, val_acc=92.4%]Fold 4 Seed 456:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 43/50 [2:07:13<20:59, 179.90s/it, train_acc=97.1%, val_acc=92.4%]Fold 4 Seed 456:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 43/50 [2:10:11<20:59, 179.90s/it, train_acc=97.3%, val_acc=92.8%]Fold 4 Seed 456:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 44/50 [2:10:11<17:56, 179.37s/it, train_acc=97.3%, val_acc=92.8%]Fold 4 Seed 456:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 44/50 [2:13:10<17:56, 179.37s/it, train_acc=97.6%, val_acc=92.6%]Fold 4 Seed 456:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 44/50 [2:13:10<18:09, 181.61s/it, train_acc=97.6%, val_acc=92.6%]
INFO:__main__:  Subgroup Analysis:
INFO:__main__:    AD: 95.2% (62 samples)
INFO:__main__:    AD_trajectory: 72.1% (147 samples)
INFO:__main__:    CN: 96.8% (949 samples)
INFO:__main__:    MCI_to_AD: 78.2% (55 samples)
INFO:__main__:Fold 4 - Val: 93.61%, Test: 92.91%, Balanced: 87.81%
INFO:__main__:
--- Fold 5/5 ---
INFO:__main__:Train: 4367, Val: 485, Test: 1213
INFO:dataset:Filled 4 missing values in 'AGE' with 69.00
INFO:dataset:Filled 10 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 494 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 499 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 544 missing values in 'TRABSCOR' with 77.00
INFO:dataset:Filled 3331 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 3335 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 3324 missing values in 'BNTTOTAL' with 23.00
INFO:dataset:Filled 2390 missing values in 'VSWEIGHT' with 165.80
INFO:dataset:Filled 2385 missing values in 'BMI' with 29.68
INFO:dataset:Filled 2627 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 2627 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 2627 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 2627 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 4367 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 3427 (78.5%)
INFO:dataset:  Class 1: 940 (21.5%)
INFO:dataset:Filled 2 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 61 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 62 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 65 missing values in 'TRABSCOR' with 75.00
INFO:dataset:Filled 380 missing values in 'DSPANFOR' with 7.00
INFO:dataset:Filled 380 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 377 missing values in 'BNTTOTAL' with 24.00
INFO:dataset:Filled 274 missing values in 'VSWEIGHT' with 165.00
INFO:dataset:Filled 272 missing values in 'BMI' with 28.89
INFO:dataset:Filled 299 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 298 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 298 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 298 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 485 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 371 (76.5%)
INFO:dataset:  Class 1: 114 (23.5%)
INFO:dataset:Filled 4 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 129 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 132 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 144 missing values in 'TRABSCOR' with 76.00
INFO:dataset:Filled 927 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 927 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 924 missing values in 'BNTTOTAL' with 23.00
INFO:dataset:Filled 669 missing values in 'VSWEIGHT' with 163.65
INFO:dataset:Filled 669 missing values in 'BMI' with 29.41
INFO:dataset:Filled 738 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 737 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 737 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 737 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 1213 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 949 (78.2%)
INFO:dataset:  Class 1: 264 (21.8%)
INFO:mri_vit_model:Created ViT3DClassifier with vit_base
INFO:mri_vit_model:  Image size: 128x128x128
INFO:mri_vit_model:  Patch size: 16
INFO:mri_vit_model:  Num patches: 512
INFO:mri_vit_model:  Embed dim: 768, Depth: 12, Heads: 12
INFO:mri_vit_model:Loading MAE pre-trained weights from ../mri_vit_ad/pretrained/vit_mae75_pretrained.pth
INFO:mri_vit_model:  Loaded pos_embed directly (shapes match: torch.Size([1, 513, 768]))
INFO:mri_vit_model:Loaded 150 pretrained weights (including pos_embed, cls_token, patch_embed if matched)
INFO:mri_vit_model:Missing keys: 2
INFO:mri_vit_model:  Missing: ['head.1.weight', 'head.1.bias']
/home/tanguy/medical/alzheimer/env/lib/python3.12/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
ViT backbone: 768-dim features
FT-Transformer tabular encoder: 16 -> 64
  Auxiliary losses: Enabled (MRI + Tabular classifiers)
MultiModalFusion initialized:
  MRI backbone: vit (768-dim)
  Tabular features: 16 -> 64
  Fusion method: cross_modal
  Fusion hidden: 512
Fold 5 Seed 456:   0%|          | 0/50 [00:00<?, ?it/s]Fold 5 Seed 456:   0%|          | 0/50 [02:54<?, ?it/s, train_acc=64.9%, val_acc=76.5%]Fold 5 Seed 456:   2%|â–         | 1/50 [02:54<2:22:26, 174.42s/it, train_acc=64.9%, val_acc=76.5%]Fold 5 Seed 456:   2%|â–         | 1/50 [05:47<2:22:26, 174.42s/it, train_acc=78.1%, val_acc=76.5%]Fold 5 Seed 456:   4%|â–         | 2/50 [05:47<2:18:48, 173.52s/it, train_acc=78.1%, val_acc=76.5%]Fold 5 Seed 456:   4%|â–         | 2/50 [08:40<2:18:48, 173.52s/it, train_acc=84.8%, val_acc=86.6%]Fold 5 Seed 456:   6%|â–Œ         | 3/50 [08:40<2:15:45, 173.32s/it, train_acc=84.8%, val_acc=86.6%]Fold 5 Seed 456:   6%|â–Œ         | 3/50 [11:34<2:15:45, 173.32s/it, train_acc=87.4%, val_acc=86.4%]Fold 5 Seed 456:   8%|â–Š         | 4/50 [11:34<2:13:02, 173.54s/it, train_acc=87.4%, val_acc=86.4%]Fold 5 Seed 456:   8%|â–Š         | 4/50 [14:26<2:13:02, 173.54s/it, train_acc=87.5%, val_acc=87.2%]Fold 5 Seed 456:  10%|â–ˆ         | 5/50 [14:27<2:09:56, 173.25s/it, train_acc=87.5%, val_acc=87.2%]Fold 5 Seed 456:  10%|â–ˆ         | 5/50 [17:20<2:09:56, 173.25s/it, train_acc=88.5%, val_acc=86.6%]Fold 5 Seed 456:  12%|â–ˆâ–        | 6/50 [17:20<2:07:09, 173.41s/it, train_acc=88.5%, val_acc=86.6%]Fold 5 Seed 456:  12%|â–ˆâ–        | 6/50 [20:13<2:07:09, 173.41s/it, train_acc=87.1%, val_acc=86.0%]Fold 5 Seed 456:  14%|â–ˆâ–        | 7/50 [20:13<2:04:10, 173.26s/it, train_acc=87.1%, val_acc=86.0%]Fold 5 Seed 456:  14%|â–ˆâ–        | 7/50 [23:07<2:04:10, 173.26s/it, train_acc=87.8%, val_acc=86.4%]Fold 5 Seed 456:  16%|â–ˆâ–Œ        | 8/50 [23:07<2:01:21, 173.37s/it, train_acc=87.8%, val_acc=86.4%]Fold 5 Seed 456:  16%|â–ˆâ–Œ        | 8/50 [26:00<2:01:21, 173.37s/it, train_acc=88.3%, val_acc=85.2%]Fold 5 Seed 456:  18%|â–ˆâ–Š        | 9/50 [26:00<1:58:25, 173.31s/it, train_acc=88.3%, val_acc=85.2%]Fold 5 Seed 456:  18%|â–ˆâ–Š        | 9/50 [28:54<1:58:25, 173.31s/it, train_acc=88.7%, val_acc=86.0%]Fold 5 Seed 456:  20%|â–ˆâ–ˆ        | 10/50 [28:54<1:55:40, 173.52s/it, train_acc=88.7%, val_acc=86.0%]Fold 5 Seed 456:  20%|â–ˆâ–ˆ        | 10/50 [31:47<1:55:40, 173.52s/it, train_acc=88.5%, val_acc=87.6%]Fold 5 Seed 456:  22%|â–ˆâ–ˆâ–       | 11/50 [31:47<1:52:47, 173.51s/it, train_acc=88.5%, val_acc=87.6%]Fold 5 Seed 456:  22%|â–ˆâ–ˆâ–       | 11/50 [34:39<1:52:47, 173.51s/it, train_acc=89.3%, val_acc=88.0%]Fold 5 Seed 456:  24%|â–ˆâ–ˆâ–       | 12/50 [34:39<1:49:35, 173.03s/it, train_acc=89.3%, val_acc=88.0%]Fold 5 Seed 456:  24%|â–ˆâ–ˆâ–       | 12/50 [37:35<1:49:35, 173.03s/it, train_acc=89.0%, val_acc=88.0%]Fold 5 Seed 456:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [37:35<1:47:07, 173.71s/it, train_acc=89.0%, val_acc=88.0%]Fold 5 Seed 456:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [40:29<1:47:07, 173.71s/it, train_acc=89.0%, val_acc=87.0%]Fold 5 Seed 456:  28%|â–ˆâ–ˆâ–Š       | 14/50 [40:29<1:44:17, 173.83s/it, train_acc=89.0%, val_acc=87.0%]Fold 5 Seed 456:  28%|â–ˆâ–ˆâ–Š       | 14/50 [43:24<1:44:17, 173.83s/it, train_acc=90.3%, val_acc=89.5%]Fold 5 Seed 456:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [43:25<1:41:44, 174.42s/it, train_acc=90.3%, val_acc=89.5%]Fold 5 Seed 456:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [46:24<1:41:44, 174.42s/it, train_acc=90.0%, val_acc=90.5%]Fold 5 Seed 456:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [46:24<1:39:40, 175.91s/it, train_acc=90.0%, val_acc=90.5%]Fold 5 Seed 456:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [49:22<1:39:40, 175.91s/it, train_acc=90.9%, val_acc=91.8%]Fold 5 Seed 456:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [49:22<1:37:04, 176.49s/it, train_acc=90.9%, val_acc=91.8%]Fold 5 Seed 456:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [52:21<1:37:04, 176.49s/it, train_acc=91.3%, val_acc=91.1%]Fold 5 Seed 456:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [52:21<1:34:32, 177.28s/it, train_acc=91.3%, val_acc=91.1%]Fold 5 Seed 456:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [55:14<1:34:32, 177.28s/it, train_acc=91.8%, val_acc=90.9%]Fold 5 Seed 456:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [55:14<1:30:54, 175.95s/it, train_acc=91.8%, val_acc=90.9%]Fold 5 Seed 456:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [58:07<1:30:54, 175.95s/it, train_acc=92.2%, val_acc=91.8%]Fold 5 Seed 456:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [58:07<1:27:33, 175.12s/it, train_acc=92.2%, val_acc=91.8%]Fold 5 Seed 456:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [1:01:01<1:27:33, 175.12s/it, train_acc=92.3%, val_acc=90.5%]Fold 5 Seed 456:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:01:01<1:24:28, 174.78s/it, train_acc=92.3%, val_acc=90.5%]Fold 5 Seed 456:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:03:55<1:24:28, 174.78s/it, train_acc=92.1%, val_acc=92.6%]Fold 5 Seed 456:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:03:55<1:21:29, 174.62s/it, train_acc=92.1%, val_acc=92.6%]Fold 5 Seed 456:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:06:55<1:21:29, 174.62s/it, train_acc=92.8%, val_acc=90.9%]Fold 5 Seed 456:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:06:55<1:19:17, 176.21s/it, train_acc=92.8%, val_acc=90.9%]Fold 5 Seed 456:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:09:53<1:19:17, 176.21s/it, train_acc=92.7%, val_acc=92.2%]Fold 5 Seed 456:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:09:53<1:16:38, 176.85s/it, train_acc=92.7%, val_acc=92.2%]Fold 5 Seed 456:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:12:53<1:16:38, 176.85s/it, train_acc=93.2%, val_acc=92.8%]Fold 5 Seed 456:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:12:53<1:14:00, 177.62s/it, train_acc=93.2%, val_acc=92.8%]Fold 5 Seed 456:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:15:53<1:14:00, 177.62s/it, train_acc=93.4%, val_acc=92.4%]Fold 5 Seed 456:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:15:53<1:11:20, 178.34s/it, train_acc=93.4%, val_acc=92.4%]Fold 5 Seed 456:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:18:52<1:11:20, 178.34s/it, train_acc=93.6%, val_acc=93.0%]Fold 5 Seed 456:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:18:52<1:08:28, 178.63s/it, train_acc=93.6%, val_acc=93.0%]Fold 5 Seed 456:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:21:51<1:08:28, 178.63s/it, train_acc=93.7%, val_acc=92.8%]Fold 5 Seed 456:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:21:51<1:05:33, 178.80s/it, train_acc=93.7%, val_acc=92.8%]Fold 5 Seed 456:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:24:50<1:05:33, 178.80s/it, train_acc=93.9%, val_acc=93.0%]Fold 5 Seed 456:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:24:50<1:02:35, 178.82s/it, train_acc=93.9%, val_acc=93.0%]Fold 5 Seed 456:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:27:50<1:02:35, 178.82s/it, train_acc=94.2%, val_acc=92.4%]Fold 5 Seed 456:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:27:50<59:43, 179.19s/it, train_acc=94.2%, val_acc=92.4%]  Fold 5 Seed 456:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:30:50<59:43, 179.19s/it, train_acc=94.2%, val_acc=91.8%]Fold 5 Seed 456:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:30:50<56:46, 179.28s/it, train_acc=94.2%, val_acc=91.8%]Fold 5 Seed 456:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:33:49<56:46, 179.28s/it, train_acc=94.9%, val_acc=91.5%]Fold 5 Seed 456:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:33:49<53:46, 179.28s/it, train_acc=94.9%, val_acc=91.5%]Fold 5 Seed 456:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:36:49<53:46, 179.28s/it, train_acc=95.1%, val_acc=91.5%]Fold 5 Seed 456:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:36:49<50:53, 179.63s/it, train_acc=95.1%, val_acc=91.5%]Fold 5 Seed 456:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:39:51<50:53, 179.63s/it, train_acc=95.2%, val_acc=92.0%]Fold 5 Seed 456:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 34/50 [1:39:51<48:02, 180.14s/it, train_acc=95.2%, val_acc=92.0%]Fold 5 Seed 456:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 34/50 [1:42:51<48:02, 180.14s/it, train_acc=95.0%, val_acc=92.6%]Fold 5 Seed 456:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 35/50 [1:42:51<45:03, 180.23s/it, train_acc=95.0%, val_acc=92.6%]Fold 5 Seed 456:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 35/50 [1:45:51<45:03, 180.23s/it, train_acc=95.4%, val_acc=90.9%]Fold 5 Seed 456:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [1:45:51<42:01, 180.11s/it, train_acc=95.4%, val_acc=90.9%]Fold 5 Seed 456:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [1:48:51<42:01, 180.11s/it, train_acc=95.9%, val_acc=93.2%]Fold 5 Seed 456:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 37/50 [1:48:51<39:01, 180.08s/it, train_acc=95.9%, val_acc=93.2%]Fold 5 Seed 456:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 37/50 [1:51:51<39:01, 180.08s/it, train_acc=95.9%, val_acc=91.8%]Fold 5 Seed 456:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 38/50 [1:51:51<36:00, 180.02s/it, train_acc=95.9%, val_acc=91.8%]Fold 5 Seed 456:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 38/50 [1:54:50<36:00, 180.02s/it, train_acc=96.2%, val_acc=92.8%]Fold 5 Seed 456:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 39/50 [1:54:50<32:58, 179.86s/it, train_acc=96.2%, val_acc=92.8%]Fold 5 Seed 456:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 39/50 [1:57:51<32:58, 179.86s/it, train_acc=96.3%, val_acc=92.8%]Fold 5 Seed 456:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 40/50 [1:57:51<29:59, 179.96s/it, train_acc=96.3%, val_acc=92.8%]Fold 5 Seed 456:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 40/50 [2:00:50<29:59, 179.96s/it, train_acc=96.2%, val_acc=93.2%]Fold 5 Seed 456:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 41/50 [2:00:50<26:58, 179.80s/it, train_acc=96.2%, val_acc=93.2%]Fold 5 Seed 456:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 41/50 [2:03:49<26:58, 179.80s/it, train_acc=96.3%, val_acc=93.0%]Fold 5 Seed 456:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 42/50 [2:03:49<23:55, 179.44s/it, train_acc=96.3%, val_acc=93.0%]Fold 5 Seed 456:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 42/50 [2:06:49<23:55, 179.44s/it, train_acc=96.4%, val_acc=92.6%]Fold 5 Seed 456:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 43/50 [2:06:49<20:56, 179.57s/it, train_acc=96.4%, val_acc=92.6%]Fold 5 Seed 456:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 43/50 [2:09:49<20:56, 179.57s/it, train_acc=96.4%, val_acc=92.6%]Fold 5 Seed 456:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 44/50 [2:09:49<17:58, 179.71s/it, train_acc=96.4%, val_acc=92.6%]Fold 5 Seed 456:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 44/50 [2:12:48<17:58, 179.71s/it, train_acc=96.8%, val_acc=92.0%]Fold 5 Seed 456:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 45/50 [2:12:48<14:57, 179.60s/it, train_acc=96.8%, val_acc=92.0%]Fold 5 Seed 456:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 45/50 [2:15:48<14:57, 179.60s/it, train_acc=96.6%, val_acc=92.2%]Fold 5 Seed 456:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 46/50 [2:15:48<11:59, 179.86s/it, train_acc=96.6%, val_acc=92.2%]Fold 5 Seed 456:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 46/50 [2:18:49<11:59, 179.86s/it, train_acc=96.7%, val_acc=92.0%]Fold 5 Seed 456:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 47/50 [2:18:49<08:59, 179.97s/it, train_acc=96.7%, val_acc=92.0%]Fold 5 Seed 456:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 47/50 [2:21:47<08:59, 179.97s/it, train_acc=97.0%, val_acc=92.0%]Fold 5 Seed 456:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 48/50 [2:21:47<05:59, 179.50s/it, train_acc=97.0%, val_acc=92.0%]Fold 5 Seed 456:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 48/50 [2:24:46<05:59, 179.50s/it, train_acc=96.7%, val_acc=92.0%]Fold 5 Seed 456:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 49/50 [2:24:46<02:59, 179.26s/it, train_acc=96.7%, val_acc=92.0%]Fold 5 Seed 456:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 49/50 [2:27:46<02:59, 179.26s/it, train_acc=96.7%, val_acc=91.8%]Fold 5 Seed 456: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 50/50 [2:27:46<00:00, 179.58s/it, train_acc=96.7%, val_acc=91.8%]Fold 5 Seed 456: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 50/50 [2:27:46<00:00, 177.33s/it, train_acc=96.7%, val_acc=91.8%]
INFO:__main__:  Subgroup Analysis:
INFO:__main__:    AD: 95.8% (48 samples)
INFO:__main__:    AD_trajectory: 77.5% (169 samples)
INFO:__main__:    CN: 94.5% (949 samples)
INFO:__main__:    MCI_to_AD: 87.2% (47 samples)
INFO:__main__:Fold 5 - Val: 93.20%, Test: 91.92%, Balanced: 88.55%
INFO:__main__:
Seed 456 Summary: 91.61% +/- 1.41%
INFO:__main__:
============================================================
INFO:__main__:SEED: 789
INFO:__main__:============================================================
INFO:__main__:
--- Fold 1/5 ---
INFO:__main__:Train: 4367, Val: 485, Test: 1213
INFO:dataset:Filled 4 missing values in 'AGE' with 69.00
INFO:dataset:Filled 12 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 485 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 490 missing values in 'TRAASCOR' with 30.00
INFO:dataset:Filled 527 missing values in 'TRABSCOR' with 76.00
INFO:dataset:Filled 3350 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 3353 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 3339 missing values in 'BNTTOTAL' with 24.00
INFO:dataset:Filled 2425 missing values in 'VSWEIGHT' with 165.00
INFO:dataset:Filled 2420 missing values in 'BMI' with 29.41
INFO:dataset:Filled 2666 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 2664 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 2664 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 2664 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 4367 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 3415 (78.2%)
INFO:dataset:  Class 1: 952 (21.8%)
INFO:dataset:Filled 53 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 53 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 58 missing values in 'TRABSCOR' with 75.00
INFO:dataset:Filled 367 missing values in 'DSPANFOR' with 5.00
INFO:dataset:Filled 368 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 367 missing values in 'BNTTOTAL' with 21.00
INFO:dataset:Filled 264 missing values in 'VSWEIGHT' with 167.00
INFO:dataset:Filled 264 missing values in 'BMI' with 28.62
INFO:dataset:Filled 284 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 284 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 284 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 284 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 485 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 382 (78.8%)
INFO:dataset:  Class 1: 103 (21.2%)
INFO:dataset:Filled 4 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 146 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 150 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 168 missing values in 'TRABSCOR' with 80.00
INFO:dataset:Filled 921 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 921 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 919 missing values in 'BNTTOTAL' with 23.00
INFO:dataset:Filled 644 missing values in 'VSWEIGHT' with 165.00
INFO:dataset:Filled 642 missing values in 'BMI' with 30.20
INFO:dataset:Filled 714 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 714 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 714 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 714 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 1213 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 950 (78.3%)
INFO:dataset:  Class 1: 263 (21.7%)
INFO:mri_vit_model:Created ViT3DClassifier with vit_base
INFO:mri_vit_model:  Image size: 128x128x128
INFO:mri_vit_model:  Patch size: 16
INFO:mri_vit_model:  Num patches: 512
INFO:mri_vit_model:  Embed dim: 768, Depth: 12, Heads: 12
INFO:mri_vit_model:Loading MAE pre-trained weights from ../mri_vit_ad/pretrained/vit_mae75_pretrained.pth
INFO:mri_vit_model:  Loaded pos_embed directly (shapes match: torch.Size([1, 513, 768]))
INFO:mri_vit_model:Loaded 150 pretrained weights (including pos_embed, cls_token, patch_embed if matched)
INFO:mri_vit_model:Missing keys: 2
INFO:mri_vit_model:  Missing: ['head.1.weight', 'head.1.bias']
/home/tanguy/medical/alzheimer/env/lib/python3.12/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
ViT backbone: 768-dim features
FT-Transformer tabular encoder: 16 -> 64
  Auxiliary losses: Enabled (MRI + Tabular classifiers)
MultiModalFusion initialized:
  MRI backbone: vit (768-dim)
  Tabular features: 16 -> 64
  Fusion method: cross_modal
  Fusion hidden: 512
Fold 1 Seed 789:   0%|          | 0/50 [00:00<?, ?it/s]Fold 1 Seed 789:   0%|          | 0/50 [02:50<?, ?it/s, train_acc=56.9%, val_acc=78.8%]Fold 1 Seed 789:   2%|â–         | 1/50 [02:50<2:19:20, 170.62s/it, train_acc=56.9%, val_acc=78.8%]Fold 1 Seed 789:   2%|â–         | 1/50 [05:43<2:19:20, 170.62s/it, train_acc=78.3%, val_acc=79.2%]Fold 1 Seed 789:   4%|â–         | 2/50 [05:43<2:17:28, 171.85s/it, train_acc=78.3%, val_acc=79.2%]Fold 1 Seed 789:   4%|â–         | 2/50 [08:36<2:17:28, 171.85s/it, train_acc=86.0%, val_acc=87.2%]Fold 1 Seed 789:   6%|â–Œ         | 3/50 [08:36<2:15:01, 172.38s/it, train_acc=86.0%, val_acc=87.2%]Fold 1 Seed 789:   6%|â–Œ         | 3/50 [11:28<2:15:01, 172.38s/it, train_acc=87.1%, val_acc=86.0%]Fold 1 Seed 789:   8%|â–Š         | 4/50 [11:28<2:12:10, 172.41s/it, train_acc=87.1%, val_acc=86.0%]Fold 1 Seed 789:   8%|â–Š         | 4/50 [14:21<2:12:10, 172.41s/it, train_acc=87.1%, val_acc=85.8%]Fold 1 Seed 789:  10%|â–ˆ         | 5/50 [14:21<2:09:26, 172.59s/it, train_acc=87.1%, val_acc=85.8%]Fold 1 Seed 789:  10%|â–ˆ         | 5/50 [17:14<2:09:26, 172.59s/it, train_acc=87.4%, val_acc=85.6%]Fold 1 Seed 789:  12%|â–ˆâ–        | 6/50 [17:14<2:06:30, 172.51s/it, train_acc=87.4%, val_acc=85.6%]Fold 1 Seed 789:  12%|â–ˆâ–        | 6/50 [20:06<2:06:30, 172.51s/it, train_acc=87.6%, val_acc=86.8%]Fold 1 Seed 789:  14%|â–ˆâ–        | 7/50 [20:06<2:03:38, 172.52s/it, train_acc=87.6%, val_acc=86.8%]Fold 1 Seed 789:  14%|â–ˆâ–        | 7/50 [22:58<2:03:38, 172.52s/it, train_acc=88.2%, val_acc=86.8%]Fold 1 Seed 789:  16%|â–ˆâ–Œ        | 8/50 [22:58<2:00:42, 172.44s/it, train_acc=88.2%, val_acc=86.8%]Fold 1 Seed 789:  16%|â–ˆâ–Œ        | 8/50 [25:52<2:00:42, 172.44s/it, train_acc=88.1%, val_acc=86.6%]Fold 1 Seed 789:  18%|â–ˆâ–Š        | 9/50 [25:52<1:58:07, 172.86s/it, train_acc=88.1%, val_acc=86.6%]Fold 1 Seed 789:  18%|â–ˆâ–Š        | 9/50 [28:44<1:58:07, 172.86s/it, train_acc=88.3%, val_acc=86.6%]Fold 1 Seed 789:  20%|â–ˆâ–ˆ        | 10/50 [28:44<1:54:59, 172.49s/it, train_acc=88.3%, val_acc=86.6%]Fold 1 Seed 789:  20%|â–ˆâ–ˆ        | 10/50 [31:36<1:54:59, 172.49s/it, train_acc=87.9%, val_acc=87.8%]Fold 1 Seed 789:  22%|â–ˆâ–ˆâ–       | 11/50 [31:36<1:52:02, 172.38s/it, train_acc=87.9%, val_acc=87.8%]Fold 1 Seed 789:  22%|â–ˆâ–ˆâ–       | 11/50 [34:29<1:52:02, 172.38s/it, train_acc=88.0%, val_acc=86.2%]Fold 1 Seed 789:  24%|â–ˆâ–ˆâ–       | 12/50 [34:29<1:49:14, 172.50s/it, train_acc=88.0%, val_acc=86.2%]Fold 1 Seed 789:  24%|â–ˆâ–ˆâ–       | 12/50 [37:21<1:49:14, 172.50s/it, train_acc=88.1%, val_acc=87.0%]Fold 1 Seed 789:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [37:21<1:46:20, 172.46s/it, train_acc=88.1%, val_acc=87.0%]Fold 1 Seed 789:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [40:15<1:46:20, 172.46s/it, train_acc=87.9%, val_acc=87.8%]Fold 1 Seed 789:  28%|â–ˆâ–ˆâ–Š       | 14/50 [40:15<1:43:46, 172.96s/it, train_acc=87.9%, val_acc=87.8%]Fold 1 Seed 789:  28%|â–ˆâ–ˆâ–Š       | 14/50 [43:07<1:43:46, 172.96s/it, train_acc=88.2%, val_acc=87.6%]Fold 1 Seed 789:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [43:07<1:40:39, 172.55s/it, train_acc=88.2%, val_acc=87.6%]Fold 1 Seed 789:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [46:01<1:40:39, 172.55s/it, train_acc=88.7%, val_acc=87.6%]Fold 1 Seed 789:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [46:01<1:38:02, 173.03s/it, train_acc=88.7%, val_acc=87.6%]Fold 1 Seed 789:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [48:52<1:38:02, 173.03s/it, train_acc=89.0%, val_acc=89.7%]Fold 1 Seed 789:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [48:53<1:34:55, 172.60s/it, train_acc=89.0%, val_acc=89.7%]Fold 1 Seed 789:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [51:46<1:34:55, 172.60s/it, train_acc=89.6%, val_acc=90.3%]Fold 1 Seed 789:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [51:47<1:32:16, 173.02s/it, train_acc=89.6%, val_acc=90.3%]Fold 1 Seed 789:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [54:40<1:32:16, 173.02s/it, train_acc=90.0%, val_acc=90.3%]Fold 1 Seed 789:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [54:40<1:29:31, 173.28s/it, train_acc=90.0%, val_acc=90.3%]Fold 1 Seed 789:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [57:32<1:29:31, 173.28s/it, train_acc=90.7%, val_acc=90.1%]Fold 1 Seed 789:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [57:32<1:26:25, 172.85s/it, train_acc=90.7%, val_acc=90.1%]Fold 1 Seed 789:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [1:00:25<1:26:25, 172.85s/it, train_acc=91.5%, val_acc=89.9%]Fold 1 Seed 789:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:00:26<1:23:35, 172.96s/it, train_acc=91.5%, val_acc=89.9%]Fold 1 Seed 789:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:03:17<1:23:35, 172.96s/it, train_acc=91.2%, val_acc=90.7%]Fold 1 Seed 789:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:03:17<1:20:31, 172.56s/it, train_acc=91.2%, val_acc=90.7%]Fold 1 Seed 789:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:06:09<1:20:31, 172.56s/it, train_acc=91.8%, val_acc=91.8%]Fold 1 Seed 789:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:06:09<1:17:31, 172.29s/it, train_acc=91.8%, val_acc=91.8%]Fold 1 Seed 789:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:09:04<1:17:31, 172.29s/it, train_acc=92.0%, val_acc=91.5%]Fold 1 Seed 789:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:09:04<1:15:01, 173.13s/it, train_acc=92.0%, val_acc=91.5%]Fold 1 Seed 789:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:11:57<1:15:01, 173.13s/it, train_acc=92.3%, val_acc=90.9%]Fold 1 Seed 789:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:11:57<1:12:11, 173.25s/it, train_acc=92.3%, val_acc=90.9%]Fold 1 Seed 789:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:14:51<1:12:11, 173.25s/it, train_acc=92.3%, val_acc=92.2%]Fold 1 Seed 789:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:14:51<1:09:23, 173.48s/it, train_acc=92.3%, val_acc=92.2%]Fold 1 Seed 789:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:17:44<1:09:23, 173.48s/it, train_acc=92.9%, val_acc=91.3%]Fold 1 Seed 789:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:17:44<1:06:25, 173.27s/it, train_acc=92.9%, val_acc=91.3%]Fold 1 Seed 789:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:20:38<1:06:25, 173.27s/it, train_acc=92.5%, val_acc=89.9%]Fold 1 Seed 789:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:20:38<1:03:36, 173.50s/it, train_acc=92.5%, val_acc=89.9%]Fold 1 Seed 789:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:23:30<1:03:36, 173.50s/it, train_acc=93.2%, val_acc=92.0%]Fold 1 Seed 789:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:23:30<1:00:33, 173.01s/it, train_acc=93.2%, val_acc=92.0%]Fold 1 Seed 789:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:26:24<1:00:33, 173.01s/it, train_acc=93.0%, val_acc=91.8%]Fold 1 Seed 789:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:26:24<57:46, 173.31s/it, train_acc=93.0%, val_acc=91.8%]  Fold 1 Seed 789:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:29:18<57:46, 173.31s/it, train_acc=93.5%, val_acc=91.5%]Fold 1 Seed 789:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:29:18<54:54, 173.42s/it, train_acc=93.5%, val_acc=91.5%]Fold 1 Seed 789:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:32:12<54:54, 173.42s/it, train_acc=93.6%, val_acc=91.5%]Fold 1 Seed 789:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:32:12<52:04, 173.57s/it, train_acc=93.6%, val_acc=91.5%]Fold 1 Seed 789:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:35:07<52:04, 173.57s/it, train_acc=93.7%, val_acc=92.4%]Fold 1 Seed 789:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:35:07<49:17, 173.98s/it, train_acc=93.7%, val_acc=92.4%]Fold 1 Seed 789:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:38:07<49:17, 173.98s/it, train_acc=93.7%, val_acc=92.4%]Fold 1 Seed 789:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 34/50 [1:38:07<46:53, 175.84s/it, train_acc=93.7%, val_acc=92.4%]Fold 1 Seed 789:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 34/50 [1:41:05<46:53, 175.84s/it, train_acc=94.1%, val_acc=90.7%]Fold 1 Seed 789:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 35/50 [1:41:05<44:10, 176.69s/it, train_acc=94.1%, val_acc=90.7%]Fold 1 Seed 789:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 35/50 [1:44:06<44:10, 176.69s/it, train_acc=94.2%, val_acc=93.0%]Fold 1 Seed 789:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [1:44:06<41:31, 177.98s/it, train_acc=94.2%, val_acc=93.0%]Fold 1 Seed 789:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [1:47:01<41:31, 177.98s/it, train_acc=94.2%, val_acc=92.2%]Fold 1 Seed 789:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 37/50 [1:47:01<38:19, 176.86s/it, train_acc=94.2%, val_acc=92.2%]Fold 1 Seed 789:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 37/50 [1:49:55<38:19, 176.86s/it, train_acc=94.5%, val_acc=92.0%]Fold 1 Seed 789:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 38/50 [1:49:55<35:11, 176.00s/it, train_acc=94.5%, val_acc=92.0%]Fold 1 Seed 789:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 38/50 [1:52:48<35:11, 176.00s/it, train_acc=94.5%, val_acc=91.8%]Fold 1 Seed 789:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 39/50 [1:52:48<32:07, 175.20s/it, train_acc=94.5%, val_acc=91.8%]Fold 1 Seed 789:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 39/50 [1:55:42<32:07, 175.20s/it, train_acc=94.7%, val_acc=91.5%]Fold 1 Seed 789:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 40/50 [1:55:42<29:07, 174.72s/it, train_acc=94.7%, val_acc=91.5%]Fold 1 Seed 789:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 40/50 [1:58:35<29:07, 174.72s/it, train_acc=94.6%, val_acc=92.0%]Fold 1 Seed 789:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 41/50 [1:58:35<26:07, 174.16s/it, train_acc=94.6%, val_acc=92.0%]Fold 1 Seed 789:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 41/50 [2:01:29<26:07, 174.16s/it, train_acc=94.7%, val_acc=92.0%]Fold 1 Seed 789:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 42/50 [2:01:29<23:12, 174.12s/it, train_acc=94.7%, val_acc=92.0%]Fold 1 Seed 789:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 42/50 [2:04:22<23:12, 174.12s/it, train_acc=95.1%, val_acc=91.8%]Fold 1 Seed 789:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 43/50 [2:04:22<20:17, 173.89s/it, train_acc=95.1%, val_acc=91.8%]Fold 1 Seed 789:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 43/50 [2:07:17<20:17, 173.89s/it, train_acc=95.0%, val_acc=92.0%]Fold 1 Seed 789:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 44/50 [2:07:17<17:25, 174.21s/it, train_acc=95.0%, val_acc=92.0%]Fold 1 Seed 789:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 44/50 [2:10:11<17:25, 174.21s/it, train_acc=94.8%, val_acc=91.5%]Fold 1 Seed 789:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 45/50 [2:10:11<14:30, 174.19s/it, train_acc=94.8%, val_acc=91.5%]Fold 1 Seed 789:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 45/50 [2:13:05<14:30, 174.19s/it, train_acc=95.1%, val_acc=92.0%]Fold 1 Seed 789:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 46/50 [2:13:05<11:36, 174.16s/it, train_acc=95.1%, val_acc=92.0%]Fold 1 Seed 789:  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 46/50 [2:16:00<11:36, 174.16s/it, train_acc=95.4%, val_acc=92.0%]Fold 1 Seed 789:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 47/50 [2:16:00<08:43, 174.52s/it, train_acc=95.4%, val_acc=92.0%]Fold 1 Seed 789:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 47/50 [2:18:54<08:43, 174.52s/it, train_acc=95.0%, val_acc=92.0%]Fold 1 Seed 789:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 48/50 [2:18:54<05:48, 174.10s/it, train_acc=95.0%, val_acc=92.0%]Fold 1 Seed 789:  96%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 48/50 [2:21:48<05:48, 174.10s/it, train_acc=95.0%, val_acc=92.0%]Fold 1 Seed 789:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 49/50 [2:21:48<02:54, 174.11s/it, train_acc=95.0%, val_acc=92.0%]Fold 1 Seed 789:  98%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š| 49/50 [2:24:42<02:54, 174.11s/it, train_acc=95.0%, val_acc=92.0%]Fold 1 Seed 789: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 50/50 [2:24:42<00:00, 174.15s/it, train_acc=95.0%, val_acc=92.0%]Fold 1 Seed 789: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 50/50 [2:24:42<00:00, 173.65s/it, train_acc=95.0%, val_acc=92.0%]
INFO:__main__:  Subgroup Analysis:
INFO:__main__:    AD: 95.8% (48 samples)
INFO:__main__:    AD_trajectory: 71.3% (157 samples)
INFO:__main__:    CN: 95.6% (950 samples)
INFO:__main__:    MCI_to_AD: 77.6% (58 samples)
INFO:__main__:Fold 1 - Val: 92.99%, Test: 91.59%, Balanced: 86.38%
INFO:__main__:
--- Fold 2/5 ---
INFO:__main__:Train: 4367, Val: 485, Test: 1213
INFO:dataset:Filled 3 missing values in 'AGE' with 69.00
INFO:dataset:Filled 11 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 486 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 493 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 542 missing values in 'TRABSCOR' with 78.00
INFO:dataset:Filled 3313 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 3317 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 3302 missing values in 'BNTTOTAL' with 24.00
INFO:dataset:Filled 2389 missing values in 'VSWEIGHT' with 166.00
INFO:dataset:Filled 2381 missing values in 'BMI' with 29.70
INFO:dataset:Filled 2616 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 2614 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 2614 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 2614 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 4367 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 3413 (78.2%)
INFO:dataset:  Class 1: 954 (21.8%)
INFO:dataset:Filled 61 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 61 missing values in 'TRAASCOR' with 30.00
INFO:dataset:Filled 67 missing values in 'TRABSCOR' with 73.00
INFO:dataset:Filled 368 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 368 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 368 missing values in 'BNTTOTAL' with 21.00
INFO:dataset:Filled 251 missing values in 'VSWEIGHT' with 164.00
INFO:dataset:Filled 252 missing values in 'BMI' with 30.11
INFO:dataset:Filled 289 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 289 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 289 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 289 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 485 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 384 (79.2%)
INFO:dataset:  Class 1: 101 (20.8%)
INFO:dataset:Filled 1 missing values in 'AGE' with 69.00
INFO:dataset:Filled 5 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 137 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 139 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 144 missing values in 'TRABSCOR' with 76.00
INFO:dataset:Filled 957 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 957 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 955 missing values in 'BNTTOTAL' with 22.50
INFO:dataset:Filled 693 missing values in 'VSWEIGHT' with 163.90
INFO:dataset:Filled 693 missing values in 'BMI' with 28.90
INFO:dataset:Filled 759 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 759 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 759 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 759 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 1213 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 950 (78.3%)
INFO:dataset:  Class 1: 263 (21.7%)
INFO:mri_vit_model:Created ViT3DClassifier with vit_base
INFO:mri_vit_model:  Image size: 128x128x128
INFO:mri_vit_model:  Patch size: 16
INFO:mri_vit_model:  Num patches: 512
INFO:mri_vit_model:  Embed dim: 768, Depth: 12, Heads: 12
INFO:mri_vit_model:Loading MAE pre-trained weights from ../mri_vit_ad/pretrained/vit_mae75_pretrained.pth
INFO:mri_vit_model:  Loaded pos_embed directly (shapes match: torch.Size([1, 513, 768]))
INFO:mri_vit_model:Loaded 150 pretrained weights (including pos_embed, cls_token, patch_embed if matched)
INFO:mri_vit_model:Missing keys: 2
INFO:mri_vit_model:  Missing: ['head.1.weight', 'head.1.bias']
/home/tanguy/medical/alzheimer/env/lib/python3.12/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
ViT backbone: 768-dim features
FT-Transformer tabular encoder: 16 -> 64
  Auxiliary losses: Enabled (MRI + Tabular classifiers)
MultiModalFusion initialized:
  MRI backbone: vit (768-dim)
  Tabular features: 16 -> 64
  Fusion method: cross_modal
  Fusion hidden: 512
Fold 2 Seed 789:   0%|          | 0/50 [00:00<?, ?it/s]Fold 2 Seed 789:   0%|          | 0/50 [02:53<?, ?it/s, train_acc=57.5%, val_acc=79.2%]Fold 2 Seed 789:   2%|â–         | 1/50 [02:53<2:21:34, 173.35s/it, train_acc=57.5%, val_acc=79.2%]Fold 2 Seed 789:   2%|â–         | 1/50 [05:46<2:21:34, 173.35s/it, train_acc=77.9%, val_acc=79.4%]Fold 2 Seed 789:   4%|â–         | 2/50 [05:46<2:18:33, 173.20s/it, train_acc=77.9%, val_acc=79.4%]Fold 2 Seed 789:   4%|â–         | 2/50 [08:40<2:18:33, 173.20s/it, train_acc=85.7%, val_acc=89.1%]Fold 2 Seed 789:   6%|â–Œ         | 3/50 [08:40<2:15:52, 173.47s/it, train_acc=85.7%, val_acc=89.1%]Fold 2 Seed 789:   6%|â–Œ         | 3/50 [11:31<2:15:52, 173.47s/it, train_acc=87.1%, val_acc=88.2%]Fold 2 Seed 789:   8%|â–Š         | 4/50 [11:31<2:12:19, 172.59s/it, train_acc=87.1%, val_acc=88.2%]Fold 2 Seed 789:   8%|â–Š         | 4/50 [14:24<2:12:19, 172.59s/it, train_acc=87.9%, val_acc=88.7%]Fold 2 Seed 789:  10%|â–ˆ         | 5/50 [14:24<2:09:29, 172.65s/it, train_acc=87.9%, val_acc=88.7%]Fold 2 Seed 789:  10%|â–ˆ         | 5/50 [17:18<2:09:29, 172.65s/it, train_acc=87.8%, val_acc=88.0%]Fold 2 Seed 789:  12%|â–ˆâ–        | 6/50 [17:18<2:06:55, 173.09s/it, train_acc=87.8%, val_acc=88.0%]Fold 2 Seed 789:  12%|â–ˆâ–        | 6/50 [20:10<2:06:55, 173.09s/it, train_acc=88.4%, val_acc=89.9%]Fold 2 Seed 789:  14%|â–ˆâ–        | 7/50 [20:10<2:03:48, 172.77s/it, train_acc=88.4%, val_acc=89.9%]Fold 2 Seed 789:  14%|â–ˆâ–        | 7/50 [23:03<2:03:48, 172.77s/it, train_acc=89.0%, val_acc=87.0%]Fold 2 Seed 789:  16%|â–ˆâ–Œ        | 8/50 [23:03<2:01:06, 173.02s/it, train_acc=89.0%, val_acc=87.0%]Fold 2 Seed 789:  16%|â–ˆâ–Œ        | 8/50 [25:55<2:01:06, 173.02s/it, train_acc=89.8%, val_acc=89.5%]Fold 2 Seed 789:  18%|â–ˆâ–Š        | 9/50 [25:55<1:58:02, 172.74s/it, train_acc=89.8%, val_acc=89.5%]Fold 2 Seed 789:  18%|â–ˆâ–Š        | 9/50 [28:47<1:58:02, 172.74s/it, train_acc=90.4%, val_acc=91.8%]Fold 2 Seed 789:  20%|â–ˆâ–ˆ        | 10/50 [28:47<1:54:54, 172.36s/it, train_acc=90.4%, val_acc=91.8%]Fold 2 Seed 789:  20%|â–ˆâ–ˆ        | 10/50 [31:41<1:54:54, 172.36s/it, train_acc=91.2%, val_acc=90.1%]Fold 2 Seed 789:  22%|â–ˆâ–ˆâ–       | 11/50 [31:41<1:52:19, 172.82s/it, train_acc=91.2%, val_acc=90.1%]Fold 2 Seed 789:  22%|â–ˆâ–ˆâ–       | 11/50 [34:33<1:52:19, 172.82s/it, train_acc=91.4%, val_acc=91.1%]Fold 2 Seed 789:  24%|â–ˆâ–ˆâ–       | 12/50 [34:33<1:49:20, 172.65s/it, train_acc=91.4%, val_acc=91.1%]Fold 2 Seed 789:  24%|â–ˆâ–ˆâ–       | 12/50 [37:25<1:49:20, 172.65s/it, train_acc=91.5%, val_acc=92.0%]Fold 2 Seed 789:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [37:25<1:46:24, 172.56s/it, train_acc=91.5%, val_acc=92.0%]Fold 2 Seed 789:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [40:25<1:46:24, 172.56s/it, train_acc=91.6%, val_acc=90.7%]Fold 2 Seed 789:  28%|â–ˆâ–ˆâ–Š       | 14/50 [40:25<1:44:46, 174.62s/it, train_acc=91.6%, val_acc=90.7%]Fold 2 Seed 789:  28%|â–ˆâ–ˆâ–Š       | 14/50 [43:19<1:44:46, 174.62s/it, train_acc=92.3%, val_acc=91.5%]Fold 2 Seed 789:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [43:19<1:41:46, 174.46s/it, train_acc=92.3%, val_acc=91.5%]Fold 2 Seed 789:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [46:13<1:41:46, 174.46s/it, train_acc=92.7%, val_acc=92.6%]Fold 2 Seed 789:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [46:13<1:38:44, 174.25s/it, train_acc=92.7%, val_acc=92.6%]Fold 2 Seed 789:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [49:05<1:38:44, 174.25s/it, train_acc=92.7%, val_acc=91.3%]Fold 2 Seed 789:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [49:05<1:35:34, 173.76s/it, train_acc=92.7%, val_acc=91.3%]Fold 2 Seed 789:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [52:00<1:35:34, 173.76s/it, train_acc=93.1%, val_acc=89.9%]Fold 2 Seed 789:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [52:00<1:32:47, 174.00s/it, train_acc=93.1%, val_acc=89.9%]Fold 2 Seed 789:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [54:52<1:32:47, 174.00s/it, train_acc=93.2%, val_acc=92.8%]Fold 2 Seed 789:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [54:52<1:29:38, 173.51s/it, train_acc=93.2%, val_acc=92.8%]Fold 2 Seed 789:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [57:51<1:29:38, 173.51s/it, train_acc=93.6%, val_acc=91.1%]Fold 2 Seed 789:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [57:51<1:27:30, 175.03s/it, train_acc=93.6%, val_acc=91.1%]Fold 2 Seed 789:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [1:00:51<1:27:30, 175.03s/it, train_acc=93.8%, val_acc=92.4%]Fold 2 Seed 789:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:00:51<1:25:18, 176.51s/it, train_acc=93.8%, val_acc=92.4%]Fold 2 Seed 789:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:03:49<1:25:18, 176.51s/it, train_acc=93.7%, val_acc=92.4%]Fold 2 Seed 789:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:03:49<1:22:34, 176.96s/it, train_acc=93.7%, val_acc=92.4%]Fold 2 Seed 789:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:06:47<1:22:34, 176.96s/it, train_acc=93.7%, val_acc=92.0%]Fold 2 Seed 789:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:06:47<1:19:51, 177.47s/it, train_acc=93.7%, val_acc=92.0%]Fold 2 Seed 789:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:09:47<1:19:51, 177.47s/it, train_acc=93.7%, val_acc=92.4%]Fold 2 Seed 789:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:09:47<1:17:08, 178.01s/it, train_acc=93.7%, val_acc=92.4%]Fold 2 Seed 789:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:12:45<1:17:08, 178.01s/it, train_acc=94.8%, val_acc=92.4%]Fold 2 Seed 789:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:12:45<1:14:10, 178.03s/it, train_acc=94.8%, val_acc=92.4%]Fold 2 Seed 789:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:15:44<1:14:10, 178.03s/it, train_acc=94.6%, val_acc=91.1%]Fold 2 Seed 789:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:15:44<1:11:23, 178.49s/it, train_acc=94.6%, val_acc=91.1%]Fold 2 Seed 789:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:18:43<1:11:23, 178.49s/it, train_acc=94.7%, val_acc=90.9%]Fold 2 Seed 789:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:18:43<1:08:24, 178.44s/it, train_acc=94.7%, val_acc=90.9%]Fold 2 Seed 789:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:21:41<1:08:24, 178.44s/it, train_acc=94.9%, val_acc=91.3%]Fold 2 Seed 789:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:21:41<1:05:28, 178.56s/it, train_acc=94.9%, val_acc=91.3%]Fold 2 Seed 789:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:24:41<1:05:28, 178.56s/it, train_acc=95.0%, val_acc=92.2%]Fold 2 Seed 789:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:24:41<1:02:36, 178.90s/it, train_acc=95.0%, val_acc=92.2%]Fold 2 Seed 789:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:27:41<1:02:36, 178.90s/it, train_acc=95.1%, val_acc=92.0%]Fold 2 Seed 789:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:27:41<59:44, 179.23s/it, train_acc=95.1%, val_acc=92.0%]  Fold 2 Seed 789:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:30:40<59:44, 179.23s/it, train_acc=95.5%, val_acc=91.3%]Fold 2 Seed 789:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:30:40<56:44, 179.20s/it, train_acc=95.5%, val_acc=91.3%]Fold 2 Seed 789:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:33:39<56:44, 179.20s/it, train_acc=95.7%, val_acc=90.5%]Fold 2 Seed 789:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:33:39<53:43, 179.06s/it, train_acc=95.7%, val_acc=90.5%]Fold 2 Seed 789:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:36:38<53:43, 179.06s/it, train_acc=95.9%, val_acc=91.3%]Fold 2 Seed 789:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:36:38<50:45, 179.13s/it, train_acc=95.9%, val_acc=91.3%]Fold 2 Seed 789:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:39:37<50:45, 179.13s/it, train_acc=96.0%, val_acc=92.4%]Fold 2 Seed 789:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:39:37<51:19, 181.13s/it, train_acc=96.0%, val_acc=92.4%]
INFO:__main__:  Subgroup Analysis:
INFO:__main__:    AD: 92.3% (39 samples)
INFO:__main__:    AD_trajectory: 65.4% (188 samples)
INFO:__main__:    CN: 97.4% (950 samples)
INFO:__main__:    MCI_to_AD: 83.3% (36 samples)
INFO:__main__:Fold 2 - Val: 92.78%, Test: 91.84%, Balanced: 84.62%
INFO:__main__:
--- Fold 3/5 ---
INFO:__main__:Train: 4367, Val: 485, Test: 1213
INFO:dataset:Filled 2 missing values in 'AGE' with 69.00
INFO:dataset:Filled 12 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 497 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 503 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 550 missing values in 'TRABSCOR' with 78.00
INFO:dataset:Filled 3352 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 3353 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 3340 missing values in 'BNTTOTAL' with 23.00
INFO:dataset:Filled 2396 missing values in 'VSWEIGHT' with 165.00
INFO:dataset:Filled 2391 missing values in 'BMI' with 29.49
INFO:dataset:Filled 2642 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 2641 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 2641 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 2641 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 4367 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 3413 (78.2%)
INFO:dataset:  Class 1: 954 (21.8%)
INFO:dataset:Filled 2 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 50 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 53 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 54 missing values in 'TRABSCOR' with 76.00
INFO:dataset:Filled 355 missing values in 'DSPANFOR' with 5.00
INFO:dataset:Filled 356 missing values in 'DSPANBAC' with 3.00
INFO:dataset:Filled 355 missing values in 'BNTTOTAL' with 19.50
INFO:dataset:Filled 262 missing values in 'VSWEIGHT' with 166.00
INFO:dataset:Filled 262 missing values in 'BMI' with 30.42
INFO:dataset:Filled 279 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 279 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 279 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 279 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 485 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 385 (79.4%)
INFO:dataset:  Class 1: 100 (20.6%)
INFO:dataset:Filled 2 missing values in 'AGE' with 69.00
INFO:dataset:Filled 2 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 137 missing values in 'CATANIMSC' with 21.00
INFO:dataset:Filled 137 missing values in 'TRAASCOR' with 30.00
INFO:dataset:Filled 149 missing values in 'TRABSCOR' with 75.00
INFO:dataset:Filled 931 missing values in 'DSPANFOR' with 7.00
INFO:dataset:Filled 933 missing values in 'DSPANBAC' with 5.00
INFO:dataset:Filled 930 missing values in 'BNTTOTAL' with 25.00
INFO:dataset:Filled 675 missing values in 'VSWEIGHT' with 163.90
INFO:dataset:Filled 673 missing values in 'BMI' with 29.35
INFO:dataset:Filled 743 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 742 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 742 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 742 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 1213 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 949 (78.2%)
INFO:dataset:  Class 1: 264 (21.8%)
INFO:mri_vit_model:Created ViT3DClassifier with vit_base
INFO:mri_vit_model:  Image size: 128x128x128
INFO:mri_vit_model:  Patch size: 16
INFO:mri_vit_model:  Num patches: 512
INFO:mri_vit_model:  Embed dim: 768, Depth: 12, Heads: 12
INFO:mri_vit_model:Loading MAE pre-trained weights from ../mri_vit_ad/pretrained/vit_mae75_pretrained.pth
INFO:mri_vit_model:  Loaded pos_embed directly (shapes match: torch.Size([1, 513, 768]))
INFO:mri_vit_model:Loaded 150 pretrained weights (including pos_embed, cls_token, patch_embed if matched)
INFO:mri_vit_model:Missing keys: 2
INFO:mri_vit_model:  Missing: ['head.1.weight', 'head.1.bias']
/home/tanguy/medical/alzheimer/env/lib/python3.12/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
ViT backbone: 768-dim features
FT-Transformer tabular encoder: 16 -> 64
  Auxiliary losses: Enabled (MRI + Tabular classifiers)
MultiModalFusion initialized:
  MRI backbone: vit (768-dim)
  Tabular features: 16 -> 64
  Fusion method: cross_modal
  Fusion hidden: 512
Fold 3 Seed 789:   0%|          | 0/50 [00:00<?, ?it/s]Fold 3 Seed 789:   0%|          | 0/50 [02:51<?, ?it/s, train_acc=57.3%, val_acc=79.4%]Fold 3 Seed 789:   2%|â–         | 1/50 [02:51<2:19:59, 171.43s/it, train_acc=57.3%, val_acc=79.4%]Fold 3 Seed 789:   2%|â–         | 1/50 [05:45<2:19:59, 171.43s/it, train_acc=77.9%, val_acc=79.6%]Fold 3 Seed 789:   4%|â–         | 2/50 [05:45<2:18:35, 173.23s/it, train_acc=77.9%, val_acc=79.6%]Fold 3 Seed 789:   4%|â–         | 2/50 [08:40<2:18:35, 173.23s/it, train_acc=86.2%, val_acc=88.5%]Fold 3 Seed 789:   6%|â–Œ         | 3/50 [08:40<2:16:13, 173.91s/it, train_acc=86.2%, val_acc=88.5%]Fold 3 Seed 789:   6%|â–Œ         | 3/50 [11:33<2:16:13, 173.91s/it, train_acc=87.5%, val_acc=90.5%]Fold 3 Seed 789:   8%|â–Š         | 4/50 [11:33<2:12:55, 173.38s/it, train_acc=87.5%, val_acc=90.5%]Fold 3 Seed 789:   8%|â–Š         | 4/50 [14:26<2:12:55, 173.38s/it, train_acc=88.1%, val_acc=88.5%]Fold 3 Seed 789:  10%|â–ˆ         | 5/50 [14:26<2:09:57, 173.28s/it, train_acc=88.1%, val_acc=88.5%]Fold 3 Seed 789:  10%|â–ˆ         | 5/50 [17:20<2:09:57, 173.28s/it, train_acc=88.1%, val_acc=89.5%]Fold 3 Seed 789:  12%|â–ˆâ–        | 6/50 [17:20<2:07:24, 173.73s/it, train_acc=88.1%, val_acc=89.5%]Fold 3 Seed 789:  12%|â–ˆâ–        | 6/50 [20:14<2:07:24, 173.73s/it, train_acc=89.2%, val_acc=86.4%]Fold 3 Seed 789:  14%|â–ˆâ–        | 7/50 [20:14<2:04:25, 173.62s/it, train_acc=89.2%, val_acc=86.4%]Fold 3 Seed 789:  14%|â–ˆâ–        | 7/50 [23:07<2:04:25, 173.62s/it, train_acc=89.3%, val_acc=89.5%]Fold 3 Seed 789:  16%|â–ˆâ–Œ        | 8/50 [23:07<2:01:23, 173.41s/it, train_acc=89.3%, val_acc=89.5%]Fold 3 Seed 789:  16%|â–ˆâ–Œ        | 8/50 [25:59<2:01:23, 173.41s/it, train_acc=89.7%, val_acc=90.3%]Fold 3 Seed 789:  18%|â–ˆâ–Š        | 9/50 [25:59<1:58:20, 173.18s/it, train_acc=89.7%, val_acc=90.3%]Fold 3 Seed 789:  18%|â–ˆâ–Š        | 9/50 [28:53<1:58:20, 173.18s/it, train_acc=90.3%, val_acc=91.8%]Fold 3 Seed 789:  20%|â–ˆâ–ˆ        | 10/50 [28:54<1:55:39, 173.48s/it, train_acc=90.3%, val_acc=91.8%]Fold 3 Seed 789:  20%|â–ˆâ–ˆ        | 10/50 [31:49<1:55:39, 173.48s/it, train_acc=91.0%, val_acc=92.4%]Fold 3 Seed 789:  22%|â–ˆâ–ˆâ–       | 11/50 [31:49<1:53:07, 174.04s/it, train_acc=91.0%, val_acc=92.4%]Fold 3 Seed 789:  22%|â–ˆâ–ˆâ–       | 11/50 [34:48<1:53:07, 174.04s/it, train_acc=90.9%, val_acc=86.4%]Fold 3 Seed 789:  24%|â–ˆâ–ˆâ–       | 12/50 [34:48<1:51:16, 175.69s/it, train_acc=90.9%, val_acc=86.4%]Fold 3 Seed 789:  24%|â–ˆâ–ˆâ–       | 12/50 [37:42<1:51:16, 175.69s/it, train_acc=91.7%, val_acc=92.4%]Fold 3 Seed 789:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [37:42<1:48:01, 175.17s/it, train_acc=91.7%, val_acc=92.4%]Fold 3 Seed 789:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [40:35<1:48:01, 175.17s/it, train_acc=92.1%, val_acc=92.2%]Fold 3 Seed 789:  28%|â–ˆâ–ˆâ–Š       | 14/50 [40:35<1:44:42, 174.52s/it, train_acc=92.1%, val_acc=92.2%]Fold 3 Seed 789:  28%|â–ˆâ–ˆâ–Š       | 14/50 [43:29<1:44:42, 174.52s/it, train_acc=92.2%, val_acc=92.6%]Fold 3 Seed 789:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [43:29<1:41:43, 174.39s/it, train_acc=92.2%, val_acc=92.6%]Fold 3 Seed 789:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [46:22<1:41:43, 174.39s/it, train_acc=91.8%, val_acc=92.6%]Fold 3 Seed 789:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [46:22<1:38:28, 173.79s/it, train_acc=91.8%, val_acc=92.6%]Fold 3 Seed 789:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [49:16<1:38:28, 173.79s/it, train_acc=92.3%, val_acc=92.0%]Fold 3 Seed 789:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [49:16<1:35:41, 173.99s/it, train_acc=92.3%, val_acc=92.0%]Fold 3 Seed 789:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [52:11<1:35:41, 173.99s/it, train_acc=92.6%, val_acc=91.1%]Fold 3 Seed 789:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [52:11<1:32:53, 174.18s/it, train_acc=92.6%, val_acc=91.1%]Fold 3 Seed 789:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [55:05<1:32:53, 174.18s/it, train_acc=92.9%, val_acc=93.4%]Fold 3 Seed 789:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [55:05<1:29:56, 174.07s/it, train_acc=92.9%, val_acc=93.4%]Fold 3 Seed 789:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [58:05<1:29:56, 174.07s/it, train_acc=93.3%, val_acc=93.2%]Fold 3 Seed 789:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [58:05<1:28:00, 176.01s/it, train_acc=93.3%, val_acc=93.2%]Fold 3 Seed 789:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [1:01:05<1:28:00, 176.01s/it, train_acc=92.9%, val_acc=92.6%]Fold 3 Seed 789:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:01:05<1:25:35, 177.07s/it, train_acc=92.9%, val_acc=92.6%]Fold 3 Seed 789:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:04:05<1:25:35, 177.07s/it, train_acc=93.6%, val_acc=92.4%]Fold 3 Seed 789:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:04:05<1:23:01, 177.91s/it, train_acc=93.6%, val_acc=92.4%]Fold 3 Seed 789:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:07:04<1:23:01, 177.91s/it, train_acc=94.1%, val_acc=92.4%]Fold 3 Seed 789:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:07:04<1:20:15, 178.34s/it, train_acc=94.1%, val_acc=92.4%]Fold 3 Seed 789:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:10:04<1:20:15, 178.34s/it, train_acc=94.0%, val_acc=92.6%]Fold 3 Seed 789:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:10:04<1:17:27, 178.75s/it, train_acc=94.0%, val_acc=92.6%]Fold 3 Seed 789:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:13:04<1:17:27, 178.75s/it, train_acc=94.6%, val_acc=93.0%]Fold 3 Seed 789:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:13:04<1:14:38, 179.13s/it, train_acc=94.6%, val_acc=93.0%]Fold 3 Seed 789:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:16:04<1:14:38, 179.13s/it, train_acc=94.7%, val_acc=88.9%]Fold 3 Seed 789:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:16:04<1:11:46, 179.44s/it, train_acc=94.7%, val_acc=88.9%]Fold 3 Seed 789:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:19:03<1:11:46, 179.44s/it, train_acc=94.4%, val_acc=93.2%]Fold 3 Seed 789:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:19:03<1:08:45, 179.37s/it, train_acc=94.4%, val_acc=93.2%]Fold 3 Seed 789:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:22:02<1:08:45, 179.37s/it, train_acc=95.1%, val_acc=93.2%]Fold 3 Seed 789:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:22:02<1:05:45, 179.35s/it, train_acc=95.1%, val_acc=93.2%]Fold 3 Seed 789:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:25:03<1:05:45, 179.35s/it, train_acc=95.3%, val_acc=93.2%]Fold 3 Seed 789:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:25:03<1:02:53, 179.67s/it, train_acc=95.3%, val_acc=93.2%]Fold 3 Seed 789:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:28:02<1:02:53, 179.67s/it, train_acc=95.3%, val_acc=92.8%]Fold 3 Seed 789:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:28:02<59:53, 179.67s/it, train_acc=95.3%, val_acc=92.8%]  Fold 3 Seed 789:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:31:04<59:53, 179.67s/it, train_acc=95.8%, val_acc=92.8%]Fold 3 Seed 789:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:31:04<57:06, 180.34s/it, train_acc=95.8%, val_acc=92.8%]Fold 3 Seed 789:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:34:04<57:06, 180.34s/it, train_acc=95.7%, val_acc=93.0%]Fold 3 Seed 789:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:34:04<54:04, 180.24s/it, train_acc=95.7%, val_acc=93.0%]Fold 3 Seed 789:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:37:03<54:04, 180.24s/it, train_acc=95.9%, val_acc=92.8%]Fold 3 Seed 789:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:37:03<50:55, 179.75s/it, train_acc=95.9%, val_acc=92.8%]Fold 3 Seed 789:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:40:01<50:55, 179.75s/it, train_acc=96.3%, val_acc=93.0%]Fold 3 Seed 789:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:40:01<51:31, 181.85s/it, train_acc=96.3%, val_acc=93.0%]
INFO:__main__:  Subgroup Analysis:
INFO:__main__:    AD: 97.4% (39 samples)
INFO:__main__:    AD_trajectory: 67.6% (170 samples)
INFO:__main__:    CN: 95.7% (949 samples)
INFO:__main__:    MCI_to_AD: 81.8% (55 samples)
INFO:__main__:Fold 3 - Val: 93.40%, Test: 91.18%, Balanced: 85.34%
INFO:__main__:
--- Fold 4/5 ---
INFO:__main__:Train: 4367, Val: 485, Test: 1213
INFO:dataset:Filled 3 missing values in 'AGE' with 69.00
INFO:dataset:Filled 14 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 501 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 508 missing values in 'TRAASCOR' with 30.00
INFO:dataset:Filled 547 missing values in 'TRABSCOR' with 77.00
INFO:dataset:Filled 3341 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 3344 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 3336 missing values in 'BNTTOTAL' with 23.00
INFO:dataset:Filled 2385 missing values in 'VSWEIGHT' with 164.10
INFO:dataset:Filled 2380 missing values in 'BMI' with 29.30
INFO:dataset:Filled 2630 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 2628 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 2628 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 2628 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 4367 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 3414 (78.2%)
INFO:dataset:  Class 1: 953 (21.8%)
INFO:dataset:Filled 51 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 51 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 59 missing values in 'TRABSCOR' with 78.00
INFO:dataset:Filled 379 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 379 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 376 missing values in 'BNTTOTAL' with 22.00
INFO:dataset:Filled 284 missing values in 'VSWEIGHT' with 165.00
INFO:dataset:Filled 284 missing values in 'BMI' with 29.40
INFO:dataset:Filled 303 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 303 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 303 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 303 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 485 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 384 (79.2%)
INFO:dataset:  Class 1: 101 (20.8%)
INFO:dataset:Filled 1 missing values in 'AGE' with 69.00
INFO:dataset:Filled 2 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 132 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 134 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 147 missing values in 'TRABSCOR' with 76.00
INFO:dataset:Filled 918 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 919 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 913 missing values in 'BNTTOTAL' with 24.00
INFO:dataset:Filled 664 missing values in 'VSWEIGHT' with 168.00
INFO:dataset:Filled 662 missing values in 'BMI' with 30.40
INFO:dataset:Filled 731 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 731 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 731 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 731 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 1213 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 949 (78.2%)
INFO:dataset:  Class 1: 264 (21.8%)
INFO:mri_vit_model:Created ViT3DClassifier with vit_base
INFO:mri_vit_model:  Image size: 128x128x128
INFO:mri_vit_model:  Patch size: 16
INFO:mri_vit_model:  Num patches: 512
INFO:mri_vit_model:  Embed dim: 768, Depth: 12, Heads: 12
INFO:mri_vit_model:Loading MAE pre-trained weights from ../mri_vit_ad/pretrained/vit_mae75_pretrained.pth
INFO:mri_vit_model:  Loaded pos_embed directly (shapes match: torch.Size([1, 513, 768]))
INFO:mri_vit_model:Loaded 150 pretrained weights (including pos_embed, cls_token, patch_embed if matched)
INFO:mri_vit_model:Missing keys: 2
INFO:mri_vit_model:  Missing: ['head.1.weight', 'head.1.bias']
/home/tanguy/medical/alzheimer/env/lib/python3.12/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
ViT backbone: 768-dim features
FT-Transformer tabular encoder: 16 -> 64
  Auxiliary losses: Enabled (MRI + Tabular classifiers)
MultiModalFusion initialized:
  MRI backbone: vit (768-dim)
  Tabular features: 16 -> 64
  Fusion method: cross_modal
  Fusion hidden: 512
Fold 4 Seed 789:   0%|          | 0/50 [00:00<?, ?it/s]Fold 4 Seed 789:   0%|          | 0/50 [02:53<?, ?it/s, train_acc=55.6%, val_acc=79.2%]Fold 4 Seed 789:   2%|â–         | 1/50 [02:53<2:21:34, 173.35s/it, train_acc=55.6%, val_acc=79.2%]Fold 4 Seed 789:   2%|â–         | 1/50 [05:47<2:21:34, 173.35s/it, train_acc=78.2%, val_acc=79.2%]Fold 4 Seed 789:   4%|â–         | 2/50 [05:47<2:18:51, 173.58s/it, train_acc=78.2%, val_acc=79.2%]Fold 4 Seed 789:   4%|â–         | 2/50 [08:39<2:18:51, 173.58s/it, train_acc=85.3%, val_acc=87.8%]Fold 4 Seed 789:   6%|â–Œ         | 3/50 [08:39<2:15:30, 172.99s/it, train_acc=85.3%, val_acc=87.8%]Fold 4 Seed 789:   6%|â–Œ         | 3/50 [11:32<2:15:30, 172.99s/it, train_acc=86.7%, val_acc=90.1%]Fold 4 Seed 789:   8%|â–Š         | 4/50 [11:32<2:12:33, 172.91s/it, train_acc=86.7%, val_acc=90.1%]Fold 4 Seed 789:   8%|â–Š         | 4/50 [14:25<2:12:33, 172.91s/it, train_acc=87.0%, val_acc=87.6%]Fold 4 Seed 789:  10%|â–ˆ         | 5/50 [14:25<2:09:42, 172.95s/it, train_acc=87.0%, val_acc=87.6%]Fold 4 Seed 789:  10%|â–ˆ         | 5/50 [17:19<2:09:42, 172.95s/it, train_acc=87.5%, val_acc=86.6%]Fold 4 Seed 789:  12%|â–ˆâ–        | 6/50 [17:19<2:07:10, 173.41s/it, train_acc=87.5%, val_acc=86.6%]Fold 4 Seed 789:  12%|â–ˆâ–        | 6/50 [20:11<2:07:10, 173.41s/it, train_acc=87.9%, val_acc=89.9%]Fold 4 Seed 789:  14%|â–ˆâ–        | 7/50 [20:11<2:04:01, 173.06s/it, train_acc=87.9%, val_acc=89.9%]Fold 4 Seed 789:  14%|â–ˆâ–        | 7/50 [23:04<2:04:01, 173.06s/it, train_acc=88.1%, val_acc=90.3%]Fold 4 Seed 789:  16%|â–ˆâ–Œ        | 8/50 [23:04<2:01:00, 172.87s/it, train_acc=88.1%, val_acc=90.3%]Fold 4 Seed 789:  16%|â–ˆâ–Œ        | 8/50 [25:57<2:01:00, 172.87s/it, train_acc=87.6%, val_acc=89.1%]Fold 4 Seed 789:  18%|â–ˆâ–Š        | 9/50 [25:57<1:58:06, 172.84s/it, train_acc=87.6%, val_acc=89.1%]Fold 4 Seed 789:  18%|â–ˆâ–Š        | 9/50 [28:49<1:58:06, 172.84s/it, train_acc=88.5%, val_acc=90.1%]Fold 4 Seed 789:  20%|â–ˆâ–ˆ        | 10/50 [28:49<1:55:06, 172.66s/it, train_acc=88.5%, val_acc=90.1%]Fold 4 Seed 789:  20%|â–ˆâ–ˆ        | 10/50 [31:44<1:55:06, 172.66s/it, train_acc=89.6%, val_acc=89.3%]Fold 4 Seed 789:  22%|â–ˆâ–ˆâ–       | 11/50 [31:44<1:52:40, 173.35s/it, train_acc=89.6%, val_acc=89.3%]Fold 4 Seed 789:  22%|â–ˆâ–ˆâ–       | 11/50 [34:36<1:52:40, 173.35s/it, train_acc=90.1%, val_acc=92.0%]Fold 4 Seed 789:  24%|â–ˆâ–ˆâ–       | 12/50 [34:36<1:49:31, 172.92s/it, train_acc=90.1%, val_acc=92.0%]Fold 4 Seed 789:  24%|â–ˆâ–ˆâ–       | 12/50 [37:31<1:49:31, 172.92s/it, train_acc=89.0%, val_acc=92.4%]Fold 4 Seed 789:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [37:31<1:47:03, 173.60s/it, train_acc=89.0%, val_acc=92.4%]Fold 4 Seed 789:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [40:25<1:47:03, 173.60s/it, train_acc=90.0%, val_acc=91.8%]Fold 4 Seed 789:  28%|â–ˆâ–ˆâ–Š       | 14/50 [40:25<1:44:12, 173.69s/it, train_acc=90.0%, val_acc=91.8%]Fold 4 Seed 789:  28%|â–ˆâ–ˆâ–Š       | 14/50 [43:19<1:44:12, 173.69s/it, train_acc=90.8%, val_acc=92.0%]Fold 4 Seed 789:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [43:19<1:41:28, 173.96s/it, train_acc=90.8%, val_acc=92.0%]Fold 4 Seed 789:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [46:14<1:41:28, 173.96s/it, train_acc=91.5%, val_acc=91.3%]Fold 4 Seed 789:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [46:14<1:38:40, 174.13s/it, train_acc=91.5%, val_acc=91.3%]Fold 4 Seed 789:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [49:06<1:38:40, 174.13s/it, train_acc=91.3%, val_acc=93.2%]Fold 4 Seed 789:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [49:06<1:35:30, 173.66s/it, train_acc=91.3%, val_acc=93.2%]Fold 4 Seed 789:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [52:00<1:35:30, 173.66s/it, train_acc=91.1%, val_acc=92.6%]Fold 4 Seed 789:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [52:00<1:32:35, 173.59s/it, train_acc=91.1%, val_acc=92.6%]Fold 4 Seed 789:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [54:54<1:32:35, 173.59s/it, train_acc=91.5%, val_acc=92.4%]Fold 4 Seed 789:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [54:54<1:29:45, 173.73s/it, train_acc=91.5%, val_acc=92.4%]Fold 4 Seed 789:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [57:47<1:29:45, 173.73s/it, train_acc=91.2%, val_acc=91.8%]Fold 4 Seed 789:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [57:47<1:26:47, 173.58s/it, train_acc=91.2%, val_acc=91.8%]Fold 4 Seed 789:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [1:00:42<1:26:47, 173.58s/it, train_acc=92.1%, val_acc=93.2%]Fold 4 Seed 789:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:00:42<1:24:07, 174.04s/it, train_acc=92.1%, val_acc=93.2%]Fold 4 Seed 789:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:03:37<1:24:07, 174.04s/it, train_acc=92.3%, val_acc=92.8%]Fold 4 Seed 789:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:03:37<1:21:19, 174.25s/it, train_acc=92.3%, val_acc=92.8%]Fold 4 Seed 789:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:06:31<1:21:19, 174.25s/it, train_acc=92.2%, val_acc=93.4%]Fold 4 Seed 789:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:06:31<1:18:25, 174.26s/it, train_acc=92.2%, val_acc=93.4%]Fold 4 Seed 789:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:09:31<1:18:25, 174.26s/it, train_acc=92.5%, val_acc=91.8%]Fold 4 Seed 789:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:09:31<1:16:10, 175.78s/it, train_acc=92.5%, val_acc=91.8%]Fold 4 Seed 789:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:12:24<1:16:10, 175.78s/it, train_acc=92.5%, val_acc=93.4%]Fold 4 Seed 789:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:12:24<1:12:59, 175.19s/it, train_acc=92.5%, val_acc=93.4%]Fold 4 Seed 789:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:15:17<1:12:59, 175.19s/it, train_acc=92.9%, val_acc=92.2%]Fold 4 Seed 789:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:15:17<1:09:42, 174.29s/it, train_acc=92.9%, val_acc=92.2%]Fold 4 Seed 789:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:18:11<1:09:42, 174.29s/it, train_acc=93.1%, val_acc=92.4%]Fold 4 Seed 789:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:18:11<1:06:47, 174.24s/it, train_acc=93.1%, val_acc=92.4%]Fold 4 Seed 789:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:21:03<1:06:47, 174.24s/it, train_acc=93.4%, val_acc=92.2%]Fold 4 Seed 789:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:21:03<1:03:37, 173.54s/it, train_acc=93.4%, val_acc=92.2%]Fold 4 Seed 789:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:23:56<1:03:37, 173.54s/it, train_acc=93.0%, val_acc=93.0%]Fold 4 Seed 789:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:23:56<1:00:40, 173.35s/it, train_acc=93.0%, val_acc=93.0%]Fold 4 Seed 789:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:26:49<1:00:40, 173.35s/it, train_acc=93.7%, val_acc=93.2%]Fold 4 Seed 789:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:26:49<57:47, 173.38s/it, train_acc=93.7%, val_acc=93.2%]  Fold 4 Seed 789:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:29:43<57:47, 173.38s/it, train_acc=93.2%, val_acc=92.2%]Fold 4 Seed 789:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:29:43<54:57, 173.54s/it, train_acc=93.2%, val_acc=92.2%]Fold 4 Seed 789:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:32:37<54:57, 173.54s/it, train_acc=93.5%, val_acc=89.5%]Fold 4 Seed 789:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:32:37<52:06, 173.67s/it, train_acc=93.5%, val_acc=89.5%]Fold 4 Seed 789:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:35:32<52:06, 173.67s/it, train_acc=93.8%, val_acc=93.0%]Fold 4 Seed 789:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:35:32<49:18, 174.00s/it, train_acc=93.8%, val_acc=93.0%]Fold 4 Seed 789:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:38:25<49:18, 174.00s/it, train_acc=93.9%, val_acc=91.8%]Fold 4 Seed 789:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 34/50 [1:38:25<46:22, 173.93s/it, train_acc=93.9%, val_acc=91.8%]Fold 4 Seed 789:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 34/50 [1:41:19<46:22, 173.93s/it, train_acc=94.2%, val_acc=92.8%]Fold 4 Seed 789:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 35/50 [1:41:19<43:28, 173.93s/it, train_acc=94.2%, val_acc=92.8%]Fold 4 Seed 789:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 35/50 [1:44:14<43:28, 173.93s/it, train_acc=94.4%, val_acc=93.4%]Fold 4 Seed 789:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [1:44:14<40:37, 174.13s/it, train_acc=94.4%, val_acc=93.4%]Fold 4 Seed 789:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [1:47:07<40:37, 174.13s/it, train_acc=94.6%, val_acc=92.6%]Fold 4 Seed 789:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 37/50 [1:47:07<37:39, 173.84s/it, train_acc=94.6%, val_acc=92.6%]Fold 4 Seed 789:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 37/50 [1:50:01<37:39, 173.84s/it, train_acc=94.8%, val_acc=92.6%]Fold 4 Seed 789:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 37/50 [1:50:01<38:39, 178.42s/it, train_acc=94.8%, val_acc=92.6%]
INFO:__main__:  Subgroup Analysis:
INFO:__main__:    AD: 92.7% (41 samples)
INFO:__main__:    AD_trajectory: 66.9% (160 samples)
INFO:__main__:    CN: 97.8% (949 samples)
INFO:__main__:    MCI_to_AD: 77.8% (63 samples)
INFO:__main__:Fold 4 - Val: 93.40%, Test: 92.50%, Balanced: 85.64%
INFO:__main__:
--- Fold 5/5 ---
INFO:__main__:Train: 4367, Val: 485, Test: 1213
INFO:dataset:Filled 3 missing values in 'AGE' with 69.00
INFO:dataset:Filled 11 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 494 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 501 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 546 missing values in 'TRABSCOR' with 77.00
INFO:dataset:Filled 3359 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 3361 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 3351 missing values in 'BNTTOTAL' with 24.00
INFO:dataset:Filled 2415 missing values in 'VSWEIGHT' with 166.00
INFO:dataset:Filled 2411 missing values in 'BMI' with 29.70
INFO:dataset:Filled 2659 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 2658 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 2658 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 2658 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 4367 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 3436 (78.7%)
INFO:dataset:  Class 1: 931 (21.3%)
INFO:dataset:Filled 1 missing values in 'AGE' with 69.28
INFO:dataset:Filled 2 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 58 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 59 missing values in 'TRAASCOR' with 30.00
INFO:dataset:Filled 62 missing values in 'TRABSCOR' with 74.00
INFO:dataset:Filled 368 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 369 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 366 missing values in 'BNTTOTAL' with 21.00
INFO:dataset:Filled 261 missing values in 'VSWEIGHT' with 155.90
INFO:dataset:Filled 259 missing values in 'BMI' with 29.04
INFO:dataset:Filled 288 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 288 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 288 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 288 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 485 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 362 (74.6%)
INFO:dataset:  Class 1: 123 (25.4%)
INFO:dataset:Filled 3 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 132 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 133 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 145 missing values in 'TRABSCOR' with 78.00
INFO:dataset:Filled 911 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 912 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 908 missing values in 'BNTTOTAL' with 23.00
INFO:dataset:Filled 657 missing values in 'VSWEIGHT' with 165.00
INFO:dataset:Filled 656 missing values in 'BMI' with 28.98
INFO:dataset:Filled 717 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 716 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 716 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 716 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 1213 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 949 (78.2%)
INFO:dataset:  Class 1: 264 (21.8%)
INFO:mri_vit_model:Created ViT3DClassifier with vit_base
INFO:mri_vit_model:  Image size: 128x128x128
INFO:mri_vit_model:  Patch size: 16
INFO:mri_vit_model:  Num patches: 512
INFO:mri_vit_model:  Embed dim: 768, Depth: 12, Heads: 12
INFO:mri_vit_model:Loading MAE pre-trained weights from ../mri_vit_ad/pretrained/vit_mae75_pretrained.pth
INFO:mri_vit_model:  Loaded pos_embed directly (shapes match: torch.Size([1, 513, 768]))
INFO:mri_vit_model:Loaded 150 pretrained weights (including pos_embed, cls_token, patch_embed if matched)
INFO:mri_vit_model:Missing keys: 2
INFO:mri_vit_model:  Missing: ['head.1.weight', 'head.1.bias']
/home/tanguy/medical/alzheimer/env/lib/python3.12/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
ViT backbone: 768-dim features
FT-Transformer tabular encoder: 16 -> 64
  Auxiliary losses: Enabled (MRI + Tabular classifiers)
MultiModalFusion initialized:
  MRI backbone: vit (768-dim)
  Tabular features: 16 -> 64
  Fusion method: cross_modal
  Fusion hidden: 512
Fold 5 Seed 789:   0%|          | 0/50 [00:00<?, ?it/s]Fold 5 Seed 789:   0%|          | 0/50 [02:52<?, ?it/s, train_acc=58.2%, val_acc=74.6%]Fold 5 Seed 789:   2%|â–         | 1/50 [02:52<2:20:51, 172.48s/it, train_acc=58.2%, val_acc=74.6%]Fold 5 Seed 789:   2%|â–         | 1/50 [05:46<2:20:51, 172.48s/it, train_acc=78.4%, val_acc=74.6%]Fold 5 Seed 789:   4%|â–         | 2/50 [05:46<2:18:36, 173.27s/it, train_acc=78.4%, val_acc=74.6%]Fold 5 Seed 789:   4%|â–         | 2/50 [08:40<2:18:36, 173.27s/it, train_acc=84.9%, val_acc=84.1%]Fold 5 Seed 789:   6%|â–Œ         | 3/50 [08:40<2:16:00, 173.62s/it, train_acc=84.9%, val_acc=84.1%]Fold 5 Seed 789:   6%|â–Œ         | 3/50 [11:34<2:16:00, 173.62s/it, train_acc=87.4%, val_acc=83.9%]Fold 5 Seed 789:   8%|â–Š         | 4/50 [11:34<2:13:10, 173.71s/it, train_acc=87.4%, val_acc=83.9%]Fold 5 Seed 789:   8%|â–Š         | 4/50 [14:28<2:13:10, 173.71s/it, train_acc=87.6%, val_acc=84.5%]Fold 5 Seed 789:  10%|â–ˆ         | 5/50 [14:28<2:10:22, 173.84s/it, train_acc=87.6%, val_acc=84.5%]Fold 5 Seed 789:  10%|â–ˆ         | 5/50 [17:21<2:10:22, 173.84s/it, train_acc=87.6%, val_acc=84.3%]Fold 5 Seed 789:  12%|â–ˆâ–        | 6/50 [17:21<2:07:24, 173.74s/it, train_acc=87.6%, val_acc=84.3%]Fold 5 Seed 789:  12%|â–ˆâ–        | 6/50 [20:15<2:07:24, 173.74s/it, train_acc=88.5%, val_acc=84.3%]Fold 5 Seed 789:  14%|â–ˆâ–        | 7/50 [20:15<2:04:26, 173.65s/it, train_acc=88.5%, val_acc=84.3%]Fold 5 Seed 789:  14%|â–ˆâ–        | 7/50 [23:08<2:04:26, 173.65s/it, train_acc=88.2%, val_acc=85.2%]Fold 5 Seed 789:  16%|â–ˆâ–Œ        | 8/50 [23:08<2:01:28, 173.54s/it, train_acc=88.2%, val_acc=85.2%]Fold 5 Seed 789:  16%|â–ˆâ–Œ        | 8/50 [26:00<2:01:28, 173.54s/it, train_acc=88.7%, val_acc=83.1%]Fold 5 Seed 789:  18%|â–ˆâ–Š        | 9/50 [26:00<1:58:19, 173.16s/it, train_acc=88.7%, val_acc=83.1%]Fold 5 Seed 789:  18%|â–ˆâ–Š        | 9/50 [28:55<1:58:19, 173.16s/it, train_acc=89.0%, val_acc=81.2%]Fold 5 Seed 789:  20%|â–ˆâ–ˆ        | 10/50 [28:55<1:55:44, 173.61s/it, train_acc=89.0%, val_acc=81.2%]Fold 5 Seed 789:  20%|â–ˆâ–ˆ        | 10/50 [31:47<1:55:44, 173.61s/it, train_acc=90.2%, val_acc=87.4%]Fold 5 Seed 789:  22%|â–ˆâ–ˆâ–       | 11/50 [31:48<1:52:37, 173.28s/it, train_acc=90.2%, val_acc=87.4%]Fold 5 Seed 789:  22%|â–ˆâ–ˆâ–       | 11/50 [34:43<1:52:37, 173.28s/it, train_acc=90.2%, val_acc=87.4%]Fold 5 Seed 789:  24%|â–ˆâ–ˆâ–       | 12/50 [34:43<1:50:05, 173.83s/it, train_acc=90.2%, val_acc=87.4%]Fold 5 Seed 789:  24%|â–ˆâ–ˆâ–       | 12/50 [37:36<1:50:05, 173.83s/it, train_acc=90.6%, val_acc=88.9%]Fold 5 Seed 789:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [37:36<1:47:07, 173.70s/it, train_acc=90.6%, val_acc=88.9%]Fold 5 Seed 789:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [40:32<1:47:07, 173.70s/it, train_acc=90.9%, val_acc=87.8%]Fold 5 Seed 789:  28%|â–ˆâ–ˆâ–Š       | 14/50 [40:32<1:44:33, 174.25s/it, train_acc=90.9%, val_acc=87.8%]Fold 5 Seed 789:  28%|â–ˆâ–ˆâ–Š       | 14/50 [43:26<1:44:33, 174.25s/it, train_acc=91.3%, val_acc=88.0%]Fold 5 Seed 789:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [43:26<1:41:38, 174.23s/it, train_acc=91.3%, val_acc=88.0%]Fold 5 Seed 789:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [46:18<1:41:38, 174.23s/it, train_acc=90.9%, val_acc=88.2%]Fold 5 Seed 789:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [46:18<1:38:28, 173.78s/it, train_acc=90.9%, val_acc=88.2%]Fold 5 Seed 789:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [49:11<1:38:28, 173.78s/it, train_acc=91.6%, val_acc=88.7%]Fold 5 Seed 789:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [49:11<1:35:22, 173.41s/it, train_acc=91.6%, val_acc=88.7%]Fold 5 Seed 789:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [52:06<1:35:22, 173.41s/it, train_acc=92.1%, val_acc=89.5%]Fold 5 Seed 789:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [52:06<1:32:40, 173.77s/it, train_acc=92.1%, val_acc=89.5%]Fold 5 Seed 789:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [54:58<1:32:40, 173.77s/it, train_acc=92.2%, val_acc=89.3%]Fold 5 Seed 789:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [54:58<1:29:31, 173.29s/it, train_acc=92.2%, val_acc=89.3%]Fold 5 Seed 789:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [57:52<1:29:31, 173.29s/it, train_acc=92.3%, val_acc=87.8%]Fold 5 Seed 789:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [57:52<1:26:45, 173.50s/it, train_acc=92.3%, val_acc=87.8%]Fold 5 Seed 789:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [1:00:45<1:26:45, 173.50s/it, train_acc=92.3%, val_acc=89.1%]Fold 5 Seed 789:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:00:45<1:23:47, 173.36s/it, train_acc=92.3%, val_acc=89.1%]Fold 5 Seed 789:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:03:40<1:23:47, 173.36s/it, train_acc=92.5%, val_acc=90.3%]Fold 5 Seed 789:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:03:40<1:21:11, 174.00s/it, train_acc=92.5%, val_acc=90.3%]Fold 5 Seed 789:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:06:41<1:21:11, 174.00s/it, train_acc=92.5%, val_acc=90.5%]Fold 5 Seed 789:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:06:41<1:19:10, 175.94s/it, train_acc=92.5%, val_acc=90.5%]Fold 5 Seed 789:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:09:40<1:19:10, 175.94s/it, train_acc=93.0%, val_acc=90.3%]Fold 5 Seed 789:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:09:40<1:16:41, 176.98s/it, train_acc=93.0%, val_acc=90.3%]Fold 5 Seed 789:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:12:35<1:16:41, 176.98s/it, train_acc=93.0%, val_acc=89.1%]Fold 5 Seed 789:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:12:35<1:13:31, 176.44s/it, train_acc=93.0%, val_acc=89.1%]Fold 5 Seed 789:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:15:29<1:13:31, 176.44s/it, train_acc=92.9%, val_acc=90.5%]Fold 5 Seed 789:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:15:29<1:10:15, 175.63s/it, train_acc=92.9%, val_acc=90.5%]Fold 5 Seed 789:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:18:22<1:10:15, 175.63s/it, train_acc=93.8%, val_acc=90.1%]Fold 5 Seed 789:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:18:22<1:07:04, 174.96s/it, train_acc=93.8%, val_acc=90.1%]Fold 5 Seed 789:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:21:18<1:07:04, 174.96s/it, train_acc=93.9%, val_acc=90.1%]Fold 5 Seed 789:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:21:18<1:04:10, 175.03s/it, train_acc=93.9%, val_acc=90.1%]Fold 5 Seed 789:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:24:10<1:04:10, 175.03s/it, train_acc=94.1%, val_acc=90.9%]Fold 5 Seed 789:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:24:10<1:01:00, 174.33s/it, train_acc=94.1%, val_acc=90.9%]Fold 5 Seed 789:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:27:09<1:01:00, 174.33s/it, train_acc=94.2%, val_acc=89.7%]Fold 5 Seed 789:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:27:09<58:30, 175.54s/it, train_acc=94.2%, val_acc=89.7%]  Fold 5 Seed 789:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:30:08<58:30, 175.54s/it, train_acc=94.2%, val_acc=90.3%]Fold 5 Seed 789:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:30:08<55:55, 176.59s/it, train_acc=94.2%, val_acc=90.3%]Fold 5 Seed 789:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:33:08<55:55, 176.59s/it, train_acc=94.8%, val_acc=90.3%]Fold 5 Seed 789:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:33:08<53:16, 177.57s/it, train_acc=94.8%, val_acc=90.3%]Fold 5 Seed 789:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:36:08<53:16, 177.57s/it, train_acc=94.7%, val_acc=90.1%]Fold 5 Seed 789:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:36:08<50:30, 178.29s/it, train_acc=94.7%, val_acc=90.1%]Fold 5 Seed 789:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:39:06<50:30, 178.29s/it, train_acc=95.1%, val_acc=90.1%]Fold 5 Seed 789:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 34/50 [1:39:06<47:34, 178.41s/it, train_acc=95.1%, val_acc=90.1%]Fold 5 Seed 789:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 34/50 [1:42:06<47:34, 178.41s/it, train_acc=95.1%, val_acc=89.9%]Fold 5 Seed 789:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 35/50 [1:42:06<44:43, 178.89s/it, train_acc=95.1%, val_acc=89.9%]Fold 5 Seed 789:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 35/50 [1:45:07<44:43, 178.89s/it, train_acc=95.1%, val_acc=89.7%]Fold 5 Seed 789:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [1:45:07<41:50, 179.31s/it, train_acc=95.1%, val_acc=89.7%]Fold 5 Seed 789:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [1:48:07<41:50, 179.31s/it, train_acc=95.4%, val_acc=90.1%]Fold 5 Seed 789:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 37/50 [1:48:07<38:57, 179.77s/it, train_acc=95.4%, val_acc=90.1%]Fold 5 Seed 789:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 37/50 [1:51:08<38:57, 179.77s/it, train_acc=95.6%, val_acc=90.1%]Fold 5 Seed 789:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 38/50 [1:51:08<35:58, 179.92s/it, train_acc=95.6%, val_acc=90.1%]Fold 5 Seed 789:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 38/50 [1:54:07<35:58, 179.92s/it, train_acc=95.6%, val_acc=89.9%]Fold 5 Seed 789:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 39/50 [1:54:07<32:57, 179.81s/it, train_acc=95.6%, val_acc=89.9%]Fold 5 Seed 789:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 39/50 [1:57:07<32:57, 179.81s/it, train_acc=95.4%, val_acc=90.3%]Fold 5 Seed 789:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 40/50 [1:57:07<29:57, 179.72s/it, train_acc=95.4%, val_acc=90.3%]Fold 5 Seed 789:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 40/50 [2:00:07<29:57, 179.72s/it, train_acc=96.0%, val_acc=90.3%]Fold 5 Seed 789:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 41/50 [2:00:07<26:59, 179.91s/it, train_acc=96.0%, val_acc=90.3%]Fold 5 Seed 789:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 41/50 [2:03:07<26:59, 179.91s/it, train_acc=96.1%, val_acc=89.9%]Fold 5 Seed 789:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 42/50 [2:03:07<24:00, 180.03s/it, train_acc=96.1%, val_acc=89.9%]Fold 5 Seed 789:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 42/50 [2:06:06<24:00, 180.03s/it, train_acc=96.4%, val_acc=89.5%]Fold 5 Seed 789:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 43/50 [2:06:06<20:56, 179.57s/it, train_acc=96.4%, val_acc=89.5%]Fold 5 Seed 789:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 43/50 [2:09:05<20:56, 179.57s/it, train_acc=96.4%, val_acc=89.1%]Fold 5 Seed 789:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 43/50 [2:09:05<21:00, 180.13s/it, train_acc=96.4%, val_acc=89.1%]
INFO:__main__:  Subgroup Analysis:
INFO:__main__:    AD: 90.6% (53 samples)
INFO:__main__:    AD_trajectory: 70.7% (164 samples)
INFO:__main__:    CN: 97.2% (949 samples)
INFO:__main__:    MCI_to_AD: 70.2% (47 samples)
INFO:__main__:Fold 5 - Val: 90.93%, Test: 92.25%, Balanced: 85.89%
INFO:__main__:
Seed 789 Summary: 91.87% +/- 0.47%
INFO:__main__:
============================================================
INFO:__main__:SEED: 2024
INFO:__main__:============================================================
INFO:__main__:
--- Fold 1/5 ---
INFO:__main__:Train: 4367, Val: 485, Test: 1213
INFO:dataset:Filled 4 missing values in 'AGE' with 69.00
INFO:dataset:Filled 8 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 480 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 488 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 534 missing values in 'TRABSCOR' with 77.00
INFO:dataset:Filled 3313 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 3317 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 3305 missing values in 'BNTTOTAL' with 23.00
INFO:dataset:Filled 2386 missing values in 'VSWEIGHT' with 164.00
INFO:dataset:Filled 2380 missing values in 'BMI' with 29.52
INFO:dataset:Filled 2627 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 2626 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 2626 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 2626 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 4367 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 3401 (77.9%)
INFO:dataset:  Class 1: 966 (22.1%)
INFO:dataset:Filled 1 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 68 missing values in 'CATANIMSC' with 21.00
INFO:dataset:Filled 69 missing values in 'TRAASCOR' with 29.00
INFO:dataset:Filled 72 missing values in 'TRABSCOR' with 73.00
INFO:dataset:Filled 398 missing values in 'DSPANFOR' with 5.00
INFO:dataset:Filled 398 missing values in 'DSPANBAC' with 3.00
INFO:dataset:Filled 396 missing values in 'BNTTOTAL' with 23.00
INFO:dataset:Filled 281 missing values in 'VSWEIGHT' with 173.00
INFO:dataset:Filled 279 missing values in 'BMI' with 29.63
INFO:dataset:Filled 305 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 305 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 305 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 305 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 485 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 396 (81.6%)
INFO:dataset:  Class 1: 89 (18.4%)
INFO:dataset:Filled 7 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 136 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 136 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 147 missing values in 'TRABSCOR' with 75.50
INFO:dataset:Filled 927 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 927 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 924 missing values in 'BNTTOTAL' with 24.00
INFO:dataset:Filled 666 missing values in 'VSWEIGHT' with 165.00
INFO:dataset:Filled 667 missing values in 'BMI' with 29.44
INFO:dataset:Filled 732 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 731 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 731 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 731 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 1213 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 950 (78.3%)
INFO:dataset:  Class 1: 263 (21.7%)
INFO:mri_vit_model:Created ViT3DClassifier with vit_base
INFO:mri_vit_model:  Image size: 128x128x128
INFO:mri_vit_model:  Patch size: 16
INFO:mri_vit_model:  Num patches: 512
INFO:mri_vit_model:  Embed dim: 768, Depth: 12, Heads: 12
INFO:mri_vit_model:Loading MAE pre-trained weights from ../mri_vit_ad/pretrained/vit_mae75_pretrained.pth
INFO:mri_vit_model:  Loaded pos_embed directly (shapes match: torch.Size([1, 513, 768]))
INFO:mri_vit_model:Loaded 150 pretrained weights (including pos_embed, cls_token, patch_embed if matched)
INFO:mri_vit_model:Missing keys: 2
INFO:mri_vit_model:  Missing: ['head.1.weight', 'head.1.bias']
/home/tanguy/medical/alzheimer/env/lib/python3.12/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
ViT backbone: 768-dim features
FT-Transformer tabular encoder: 16 -> 64
  Auxiliary losses: Enabled (MRI + Tabular classifiers)
MultiModalFusion initialized:
  MRI backbone: vit (768-dim)
  Tabular features: 16 -> 64
  Fusion method: cross_modal
  Fusion hidden: 512
Fold 1 Seed 2024:   0%|          | 0/50 [00:00<?, ?it/s]Fold 1 Seed 2024:   0%|          | 0/50 [02:53<?, ?it/s, train_acc=65.2%, val_acc=81.6%]Fold 1 Seed 2024:   2%|â–         | 1/50 [02:53<2:21:25, 173.17s/it, train_acc=65.2%, val_acc=81.6%]Fold 1 Seed 2024:   2%|â–         | 1/50 [05:45<2:21:25, 173.17s/it, train_acc=80.3%, val_acc=87.2%]Fold 1 Seed 2024:   4%|â–         | 2/50 [05:45<2:18:16, 172.84s/it, train_acc=80.3%, val_acc=87.2%]Fold 1 Seed 2024:   4%|â–         | 2/50 [08:40<2:18:16, 172.84s/it, train_acc=86.5%, val_acc=87.8%]Fold 1 Seed 2024:   6%|â–Œ         | 3/50 [08:40<2:16:13, 173.91s/it, train_acc=86.5%, val_acc=87.8%]Fold 1 Seed 2024:   6%|â–Œ         | 3/50 [11:33<2:16:13, 173.91s/it, train_acc=87.3%, val_acc=87.0%]Fold 1 Seed 2024:   8%|â–Š         | 4/50 [11:33<2:12:55, 173.37s/it, train_acc=87.3%, val_acc=87.0%]Fold 1 Seed 2024:   8%|â–Š         | 4/50 [14:26<2:12:55, 173.37s/it, train_acc=87.4%, val_acc=89.1%]Fold 1 Seed 2024:  10%|â–ˆ         | 5/50 [14:26<2:09:57, 173.29s/it, train_acc=87.4%, val_acc=89.1%]Fold 1 Seed 2024:  10%|â–ˆ         | 5/50 [17:25<2:09:57, 173.29s/it, train_acc=87.9%, val_acc=87.8%]Fold 1 Seed 2024:  12%|â–ˆâ–        | 6/50 [17:25<2:08:25, 175.13s/it, train_acc=87.9%, val_acc=87.8%]Fold 1 Seed 2024:  12%|â–ˆâ–        | 6/50 [20:18<2:08:25, 175.13s/it, train_acc=88.2%, val_acc=88.2%]Fold 1 Seed 2024:  14%|â–ˆâ–        | 7/50 [20:18<2:05:04, 174.52s/it, train_acc=88.2%, val_acc=88.2%]Fold 1 Seed 2024:  14%|â–ˆâ–        | 7/50 [23:12<2:05:04, 174.52s/it, train_acc=89.0%, val_acc=90.5%]Fold 1 Seed 2024:  16%|â–ˆâ–Œ        | 8/50 [23:12<2:02:00, 174.29s/it, train_acc=89.0%, val_acc=90.5%]Fold 1 Seed 2024:  16%|â–ˆâ–Œ        | 8/50 [26:06<2:02:00, 174.29s/it, train_acc=90.2%, val_acc=89.9%]Fold 1 Seed 2024:  18%|â–ˆâ–Š        | 9/50 [26:06<1:59:03, 174.23s/it, train_acc=90.2%, val_acc=89.9%]Fold 1 Seed 2024:  18%|â–ˆâ–Š        | 9/50 [29:00<1:59:03, 174.23s/it, train_acc=90.7%, val_acc=92.2%]Fold 1 Seed 2024:  20%|â–ˆâ–ˆ        | 10/50 [29:00<1:56:05, 174.14s/it, train_acc=90.7%, val_acc=92.2%]Fold 1 Seed 2024:  20%|â–ˆâ–ˆ        | 10/50 [31:53<1:56:05, 174.14s/it, train_acc=90.7%, val_acc=92.0%]Fold 1 Seed 2024:  22%|â–ˆâ–ˆâ–       | 11/50 [31:53<1:53:02, 173.90s/it, train_acc=90.7%, val_acc=92.0%]Fold 1 Seed 2024:  22%|â–ˆâ–ˆâ–       | 11/50 [34:47<1:53:02, 173.90s/it, train_acc=91.2%, val_acc=92.4%]Fold 1 Seed 2024:  24%|â–ˆâ–ˆâ–       | 12/50 [34:47<1:50:08, 173.92s/it, train_acc=91.2%, val_acc=92.4%]Fold 1 Seed 2024:  24%|â–ˆâ–ˆâ–       | 12/50 [37:40<1:50:08, 173.92s/it, train_acc=91.3%, val_acc=92.4%]Fold 1 Seed 2024:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [37:40<1:47:06, 173.69s/it, train_acc=91.3%, val_acc=92.4%]Fold 1 Seed 2024:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [40:35<1:47:06, 173.69s/it, train_acc=91.9%, val_acc=90.7%]Fold 1 Seed 2024:  28%|â–ˆâ–ˆâ–Š       | 14/50 [40:35<1:44:26, 174.07s/it, train_acc=91.9%, val_acc=90.7%]Fold 1 Seed 2024:  28%|â–ˆâ–ˆâ–Š       | 14/50 [43:31<1:44:26, 174.07s/it, train_acc=91.8%, val_acc=88.7%]Fold 1 Seed 2024:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [43:31<1:41:47, 174.49s/it, train_acc=91.8%, val_acc=88.7%]Fold 1 Seed 2024:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [46:25<1:41:47, 174.49s/it, train_acc=91.7%, val_acc=92.4%]Fold 1 Seed 2024:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [46:25<1:38:50, 174.43s/it, train_acc=91.7%, val_acc=92.4%]Fold 1 Seed 2024:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [49:19<1:38:50, 174.43s/it, train_acc=91.8%, val_acc=92.2%]Fold 1 Seed 2024:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [49:19<1:35:49, 174.22s/it, train_acc=91.8%, val_acc=92.2%]Fold 1 Seed 2024:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [52:13<1:35:49, 174.22s/it, train_acc=93.2%, val_acc=92.8%]Fold 1 Seed 2024:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [52:13<1:32:53, 174.19s/it, train_acc=93.2%, val_acc=92.8%]Fold 1 Seed 2024:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [55:14<1:32:53, 174.19s/it, train_acc=92.8%, val_acc=91.5%]Fold 1 Seed 2024:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [55:14<1:31:00, 176.15s/it, train_acc=92.8%, val_acc=91.5%]Fold 1 Seed 2024:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [58:13<1:31:00, 176.15s/it, train_acc=92.6%, val_acc=93.0%]Fold 1 Seed 2024:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [58:14<1:28:37, 177.26s/it, train_acc=92.6%, val_acc=93.0%]Fold 1 Seed 2024:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [1:01:07<1:28:37, 177.26s/it, train_acc=92.7%, val_acc=92.0%]Fold 1 Seed 2024:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:01:07<1:25:04, 176.03s/it, train_acc=92.7%, val_acc=92.0%]Fold 1 Seed 2024:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:04:00<1:25:04, 176.03s/it, train_acc=93.5%, val_acc=92.0%]Fold 1 Seed 2024:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:04:00<1:21:48, 175.29s/it, train_acc=93.5%, val_acc=92.0%]Fold 1 Seed 2024:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:06:54<1:21:48, 175.29s/it, train_acc=93.8%, val_acc=91.1%]Fold 1 Seed 2024:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:06:54<1:18:43, 174.95s/it, train_acc=93.8%, val_acc=91.1%]Fold 1 Seed 2024:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:09:47<1:18:43, 174.95s/it, train_acc=93.7%, val_acc=92.8%]Fold 1 Seed 2024:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:09:47<1:15:28, 174.18s/it, train_acc=93.7%, val_acc=92.8%]Fold 1 Seed 2024:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:12:41<1:15:28, 174.18s/it, train_acc=94.2%, val_acc=94.2%]Fold 1 Seed 2024:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:12:41<1:12:35, 174.23s/it, train_acc=94.2%, val_acc=94.2%]Fold 1 Seed 2024:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:15:41<1:12:35, 174.23s/it, train_acc=94.4%, val_acc=90.7%]Fold 1 Seed 2024:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:15:41<1:10:20, 175.87s/it, train_acc=94.4%, val_acc=90.7%]Fold 1 Seed 2024:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:18:42<1:10:20, 175.87s/it, train_acc=94.2%, val_acc=92.0%]Fold 1 Seed 2024:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:18:42<1:08:00, 177.40s/it, train_acc=94.2%, val_acc=92.0%]Fold 1 Seed 2024:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:21:41<1:08:00, 177.40s/it, train_acc=95.0%, val_acc=93.8%]Fold 1 Seed 2024:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:21:41<1:05:15, 177.98s/it, train_acc=95.0%, val_acc=93.8%]Fold 1 Seed 2024:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:24:40<1:05:15, 177.98s/it, train_acc=94.9%, val_acc=93.6%]Fold 1 Seed 2024:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:24:40<1:02:20, 178.14s/it, train_acc=94.9%, val_acc=93.6%]Fold 1 Seed 2024:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:27:38<1:02:20, 178.14s/it, train_acc=95.1%, val_acc=93.4%]Fold 1 Seed 2024:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:27:38<59:24, 178.25s/it, train_acc=95.1%, val_acc=93.4%]  Fold 1 Seed 2024:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:30:38<59:24, 178.25s/it, train_acc=95.6%, val_acc=93.2%]Fold 1 Seed 2024:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:30:38<56:32, 178.58s/it, train_acc=95.6%, val_acc=93.2%]Fold 1 Seed 2024:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:33:36<56:32, 178.58s/it, train_acc=95.7%, val_acc=92.6%]Fold 1 Seed 2024:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:33:36<53:35, 178.66s/it, train_acc=95.7%, val_acc=92.6%]Fold 1 Seed 2024:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:36:36<53:35, 178.66s/it, train_acc=96.0%, val_acc=93.6%]Fold 1 Seed 2024:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:36:36<50:40, 178.87s/it, train_acc=96.0%, val_acc=93.6%]Fold 1 Seed 2024:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:39:38<50:40, 178.87s/it, train_acc=96.1%, val_acc=92.2%]Fold 1 Seed 2024:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 34/50 [1:39:38<47:57, 179.83s/it, train_acc=96.1%, val_acc=92.2%]Fold 1 Seed 2024:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 34/50 [1:42:37<47:57, 179.83s/it, train_acc=96.3%, val_acc=92.6%]Fold 1 Seed 2024:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 35/50 [1:42:37<44:54, 179.67s/it, train_acc=96.3%, val_acc=92.6%]Fold 1 Seed 2024:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 35/50 [1:45:38<44:54, 179.67s/it, train_acc=96.6%, val_acc=92.6%]Fold 1 Seed 2024:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [1:45:38<41:59, 179.93s/it, train_acc=96.6%, val_acc=92.6%]Fold 1 Seed 2024:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [1:48:38<41:59, 179.93s/it, train_acc=97.0%, val_acc=92.8%]Fold 1 Seed 2024:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 37/50 [1:48:38<38:59, 179.98s/it, train_acc=97.0%, val_acc=92.8%]Fold 1 Seed 2024:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 37/50 [1:51:37<38:59, 179.98s/it, train_acc=96.9%, val_acc=92.6%]Fold 1 Seed 2024:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 38/50 [1:51:37<35:57, 179.82s/it, train_acc=96.9%, val_acc=92.6%]Fold 1 Seed 2024:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 38/50 [1:54:36<35:57, 179.82s/it, train_acc=97.0%, val_acc=92.6%]Fold 1 Seed 2024:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 39/50 [1:54:37<32:56, 179.67s/it, train_acc=97.0%, val_acc=92.6%]Fold 1 Seed 2024:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 39/50 [1:57:36<32:56, 179.67s/it, train_acc=97.2%, val_acc=93.0%]Fold 1 Seed 2024:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 39/50 [1:57:36<33:10, 180.93s/it, train_acc=97.2%, val_acc=93.0%]
INFO:__main__:  Subgroup Analysis:
INFO:__main__:    AD: 97.6% (42 samples)
INFO:__main__:    AD_trajectory: 68.3% (161 samples)
INFO:__main__:    CN: 95.9% (950 samples)
INFO:__main__:    MCI_to_AD: 78.3% (60 samples)
INFO:__main__:Fold 1 - Val: 94.23%, Test: 91.43%, Balanced: 85.59%
INFO:__main__:
--- Fold 2/5 ---
INFO:__main__:Train: 4367, Val: 485, Test: 1213
INFO:dataset:Filled 3 missing values in 'AGE' with 69.00
INFO:dataset:Filled 14 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 488 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 492 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 535 missing values in 'TRABSCOR' with 77.00
INFO:dataset:Filled 3317 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 3320 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 3309 missing values in 'BNTTOTAL' with 24.00
INFO:dataset:Filled 2382 missing values in 'VSWEIGHT' with 165.80
INFO:dataset:Filled 2379 missing values in 'BMI' with 29.74
INFO:dataset:Filled 2614 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 2612 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 2612 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 2612 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 4367 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 3426 (78.5%)
INFO:dataset:  Class 1: 941 (21.5%)
INFO:dataset:Filled 2 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 47 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 47 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 52 missing values in 'TRABSCOR' with 79.00
INFO:dataset:Filled 365 missing values in 'DSPANFOR' with 5.00
INFO:dataset:Filled 365 missing values in 'DSPANBAC' with 2.50
INFO:dataset:Filled 365 missing values in 'BNTTOTAL' with 16.50
INFO:dataset:Filled 268 missing values in 'VSWEIGHT' with 164.00
INFO:dataset:Filled 267 missing values in 'BMI' with 31.21
INFO:dataset:Filled 303 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 303 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 303 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 303 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 485 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 371 (76.5%)
INFO:dataset:  Class 1: 114 (23.5%)
INFO:dataset:Filled 1 missing values in 'AGE' with 69.00
INFO:dataset:Filled 149 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 154 missing values in 'TRAASCOR' with 30.00
INFO:dataset:Filled 166 missing values in 'TRABSCOR' with 76.00
INFO:dataset:Filled 956 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 957 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 951 missing values in 'BNTTOTAL' with 22.00
INFO:dataset:Filled 683 missing values in 'VSWEIGHT' with 163.40
INFO:dataset:Filled 680 missing values in 'BMI' with 28.22
INFO:dataset:Filled 747 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 747 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 747 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 747 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 1213 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 950 (78.3%)
INFO:dataset:  Class 1: 263 (21.7%)
INFO:mri_vit_model:Created ViT3DClassifier with vit_base
INFO:mri_vit_model:  Image size: 128x128x128
INFO:mri_vit_model:  Patch size: 16
INFO:mri_vit_model:  Num patches: 512
INFO:mri_vit_model:  Embed dim: 768, Depth: 12, Heads: 12
INFO:mri_vit_model:Loading MAE pre-trained weights from ../mri_vit_ad/pretrained/vit_mae75_pretrained.pth
INFO:mri_vit_model:  Loaded pos_embed directly (shapes match: torch.Size([1, 513, 768]))
INFO:mri_vit_model:Loaded 150 pretrained weights (including pos_embed, cls_token, patch_embed if matched)
INFO:mri_vit_model:Missing keys: 2
INFO:mri_vit_model:  Missing: ['head.1.weight', 'head.1.bias']
/home/tanguy/medical/alzheimer/env/lib/python3.12/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
ViT backbone: 768-dim features
FT-Transformer tabular encoder: 16 -> 64
  Auxiliary losses: Enabled (MRI + Tabular classifiers)
MultiModalFusion initialized:
  MRI backbone: vit (768-dim)
  Tabular features: 16 -> 64
  Fusion method: cross_modal
  Fusion hidden: 512
Fold 2 Seed 2024:   0%|          | 0/50 [00:00<?, ?it/s]Fold 2 Seed 2024:   0%|          | 0/50 [02:54<?, ?it/s, train_acc=64.9%, val_acc=76.5%]Fold 2 Seed 2024:   2%|â–         | 1/50 [02:54<2:22:30, 174.50s/it, train_acc=64.9%, val_acc=76.5%]Fold 2 Seed 2024:   2%|â–         | 1/50 [05:48<2:22:30, 174.50s/it, train_acc=79.3%, val_acc=84.9%]Fold 2 Seed 2024:   4%|â–         | 2/50 [05:48<2:19:18, 174.14s/it, train_acc=79.3%, val_acc=84.9%]Fold 2 Seed 2024:   4%|â–         | 2/50 [08:41<2:19:18, 174.14s/it, train_acc=86.6%, val_acc=85.8%]Fold 2 Seed 2024:   6%|â–Œ         | 3/50 [08:41<2:16:07, 173.77s/it, train_acc=86.6%, val_acc=85.8%]Fold 2 Seed 2024:   6%|â–Œ         | 3/50 [11:34<2:16:07, 173.77s/it, train_acc=87.8%, val_acc=87.0%]Fold 2 Seed 2024:   8%|â–Š         | 4/50 [11:34<2:12:52, 173.31s/it, train_acc=87.8%, val_acc=87.0%]Fold 2 Seed 2024:   8%|â–Š         | 4/50 [14:27<2:12:52, 173.31s/it, train_acc=88.7%, val_acc=87.8%]Fold 2 Seed 2024:  10%|â–ˆ         | 5/50 [14:27<2:09:59, 173.31s/it, train_acc=88.7%, val_acc=87.8%]Fold 2 Seed 2024:  10%|â–ˆ         | 5/50 [17:20<2:09:59, 173.31s/it, train_acc=88.2%, val_acc=86.8%]Fold 2 Seed 2024:  12%|â–ˆâ–        | 6/50 [17:20<2:07:04, 173.27s/it, train_acc=88.2%, val_acc=86.8%]Fold 2 Seed 2024:  12%|â–ˆâ–        | 6/50 [20:13<2:07:04, 173.27s/it, train_acc=88.8%, val_acc=86.8%]Fold 2 Seed 2024:  14%|â–ˆâ–        | 7/50 [20:13<2:04:02, 173.09s/it, train_acc=88.8%, val_acc=86.8%]Fold 2 Seed 2024:  14%|â–ˆâ–        | 7/50 [23:07<2:04:02, 173.09s/it, train_acc=89.0%, val_acc=87.8%]Fold 2 Seed 2024:  16%|â–ˆâ–Œ        | 8/50 [23:07<2:01:15, 173.24s/it, train_acc=89.0%, val_acc=87.8%]Fold 2 Seed 2024:  16%|â–ˆâ–Œ        | 8/50 [25:59<2:01:15, 173.24s/it, train_acc=89.5%, val_acc=87.6%]Fold 2 Seed 2024:  18%|â–ˆâ–Š        | 9/50 [25:59<1:58:13, 173.02s/it, train_acc=89.5%, val_acc=87.6%]Fold 2 Seed 2024:  18%|â–ˆâ–Š        | 9/50 [28:51<1:58:13, 173.02s/it, train_acc=90.5%, val_acc=89.3%]Fold 2 Seed 2024:  20%|â–ˆâ–ˆ        | 10/50 [28:51<1:55:08, 172.72s/it, train_acc=90.5%, val_acc=89.3%]Fold 2 Seed 2024:  20%|â–ˆâ–ˆ        | 10/50 [31:51<1:55:08, 172.72s/it, train_acc=91.0%, val_acc=87.8%]Fold 2 Seed 2024:  22%|â–ˆâ–ˆâ–       | 11/50 [31:51<1:53:34, 174.74s/it, train_acc=91.0%, val_acc=87.8%]Fold 2 Seed 2024:  22%|â–ˆâ–ˆâ–       | 11/50 [34:43<1:53:34, 174.74s/it, train_acc=91.7%, val_acc=88.7%]Fold 2 Seed 2024:  24%|â–ˆâ–ˆâ–       | 12/50 [34:43<1:50:12, 174.01s/it, train_acc=91.7%, val_acc=88.7%]Fold 2 Seed 2024:  24%|â–ˆâ–ˆâ–       | 12/50 [37:35<1:50:12, 174.01s/it, train_acc=91.6%, val_acc=89.5%]Fold 2 Seed 2024:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [37:35<1:47:00, 173.53s/it, train_acc=91.6%, val_acc=89.5%]Fold 2 Seed 2024:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [40:28<1:47:00, 173.53s/it, train_acc=91.7%, val_acc=90.7%]Fold 2 Seed 2024:  28%|â–ˆâ–ˆâ–Š       | 14/50 [40:29<1:44:04, 173.46s/it, train_acc=91.7%, val_acc=90.7%]Fold 2 Seed 2024:  28%|â–ˆâ–ˆâ–Š       | 14/50 [43:28<1:44:04, 173.46s/it, train_acc=92.0%, val_acc=91.1%]Fold 2 Seed 2024:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [43:28<1:42:14, 175.28s/it, train_acc=92.0%, val_acc=91.1%]Fold 2 Seed 2024:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [46:22<1:42:14, 175.28s/it, train_acc=92.0%, val_acc=90.3%]Fold 2 Seed 2024:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [46:22<1:39:08, 174.96s/it, train_acc=92.0%, val_acc=90.3%]Fold 2 Seed 2024:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [49:17<1:39:08, 174.96s/it, train_acc=92.2%, val_acc=91.5%]Fold 2 Seed 2024:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [49:17<1:36:14, 174.97s/it, train_acc=92.2%, val_acc=91.5%]Fold 2 Seed 2024:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [52:18<1:36:14, 174.97s/it, train_acc=92.3%, val_acc=90.5%]Fold 2 Seed 2024:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [52:18<1:34:11, 176.60s/it, train_acc=92.3%, val_acc=90.5%]Fold 2 Seed 2024:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [55:19<1:34:11, 176.60s/it, train_acc=92.2%, val_acc=89.5%]Fold 2 Seed 2024:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [55:19<1:31:57, 177.98s/it, train_acc=92.2%, val_acc=89.5%]Fold 2 Seed 2024:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [58:17<1:31:57, 177.98s/it, train_acc=92.6%, val_acc=92.0%]Fold 2 Seed 2024:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [58:17<1:29:03, 178.12s/it, train_acc=92.6%, val_acc=92.0%]Fold 2 Seed 2024:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [1:01:18<1:29:03, 178.12s/it, train_acc=92.9%, val_acc=91.8%]Fold 2 Seed 2024:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:01:18<1:26:24, 178.76s/it, train_acc=92.9%, val_acc=91.8%]Fold 2 Seed 2024:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:04:16<1:26:24, 178.76s/it, train_acc=93.5%, val_acc=90.9%]Fold 2 Seed 2024:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:04:16<1:23:24, 178.72s/it, train_acc=93.5%, val_acc=90.9%]Fold 2 Seed 2024:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:07:15<1:23:24, 178.72s/it, train_acc=93.5%, val_acc=89.3%]Fold 2 Seed 2024:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:07:15<1:20:27, 178.79s/it, train_acc=93.5%, val_acc=89.3%]Fold 2 Seed 2024:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:10:15<1:20:27, 178.79s/it, train_acc=93.7%, val_acc=91.5%]Fold 2 Seed 2024:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:10:15<1:17:40, 179.25s/it, train_acc=93.7%, val_acc=91.5%]Fold 2 Seed 2024:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:13:15<1:17:40, 179.25s/it, train_acc=93.6%, val_acc=90.7%]Fold 2 Seed 2024:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:13:15<1:14:46, 179.47s/it, train_acc=93.6%, val_acc=90.7%]Fold 2 Seed 2024:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:16:15<1:14:46, 179.47s/it, train_acc=94.0%, val_acc=90.7%]Fold 2 Seed 2024:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:16:15<1:11:50, 179.61s/it, train_acc=94.0%, val_acc=90.7%]Fold 2 Seed 2024:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:19:15<1:11:50, 179.61s/it, train_acc=94.2%, val_acc=92.2%]Fold 2 Seed 2024:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:19:16<1:08:54, 179.77s/it, train_acc=94.2%, val_acc=92.2%]Fold 2 Seed 2024:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:22:15<1:08:54, 179.77s/it, train_acc=94.5%, val_acc=90.5%]Fold 2 Seed 2024:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:22:15<1:05:49, 179.54s/it, train_acc=94.5%, val_acc=90.5%]Fold 2 Seed 2024:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:25:14<1:05:49, 179.54s/it, train_acc=94.4%, val_acc=92.4%]Fold 2 Seed 2024:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:25:14<1:02:48, 179.46s/it, train_acc=94.4%, val_acc=92.4%]Fold 2 Seed 2024:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:28:14<1:02:48, 179.46s/it, train_acc=95.1%, val_acc=90.5%]Fold 2 Seed 2024:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:28:14<59:52, 179.62s/it, train_acc=95.1%, val_acc=90.5%]  Fold 2 Seed 2024:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:31:13<59:52, 179.62s/it, train_acc=95.2%, val_acc=90.3%]Fold 2 Seed 2024:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:31:13<56:48, 179.42s/it, train_acc=95.2%, val_acc=90.3%]Fold 2 Seed 2024:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:34:11<56:48, 179.42s/it, train_acc=95.5%, val_acc=91.5%]Fold 2 Seed 2024:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:34:11<53:42, 179.01s/it, train_acc=95.5%, val_acc=91.5%]Fold 2 Seed 2024:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:37:10<53:42, 179.01s/it, train_acc=95.2%, val_acc=91.8%]Fold 2 Seed 2024:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:37:10<50:42, 178.94s/it, train_acc=95.2%, val_acc=91.8%]Fold 2 Seed 2024:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:40:09<50:42, 178.94s/it, train_acc=95.7%, val_acc=90.9%]Fold 2 Seed 2024:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 34/50 [1:40:09<47:46, 179.13s/it, train_acc=95.7%, val_acc=90.9%]Fold 2 Seed 2024:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 34/50 [1:43:09<47:46, 179.13s/it, train_acc=96.3%, val_acc=91.5%]Fold 2 Seed 2024:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 35/50 [1:43:09<44:52, 179.47s/it, train_acc=96.3%, val_acc=91.5%]Fold 2 Seed 2024:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 35/50 [1:46:09<44:52, 179.47s/it, train_acc=95.9%, val_acc=91.3%]Fold 2 Seed 2024:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [1:46:09<41:53, 179.50s/it, train_acc=95.9%, val_acc=91.3%]Fold 2 Seed 2024:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [1:49:08<41:53, 179.50s/it, train_acc=96.6%, val_acc=90.7%]Fold 2 Seed 2024:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 37/50 [1:49:08<38:53, 179.48s/it, train_acc=96.6%, val_acc=90.7%]Fold 2 Seed 2024:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 37/50 [1:52:07<38:53, 179.48s/it, train_acc=96.4%, val_acc=90.5%]Fold 2 Seed 2024:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 38/50 [1:52:07<35:50, 179.17s/it, train_acc=96.4%, val_acc=90.5%]Fold 2 Seed 2024:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 38/50 [1:55:06<35:50, 179.17s/it, train_acc=96.7%, val_acc=91.3%]Fold 2 Seed 2024:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 39/50 [1:55:06<32:51, 179.22s/it, train_acc=96.7%, val_acc=91.3%]Fold 2 Seed 2024:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 39/50 [1:58:06<32:51, 179.22s/it, train_acc=96.6%, val_acc=92.2%]Fold 2 Seed 2024:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 40/50 [1:58:06<29:54, 179.44s/it, train_acc=96.6%, val_acc=92.2%]Fold 2 Seed 2024:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 40/50 [2:01:05<29:54, 179.44s/it, train_acc=97.0%, val_acc=90.9%]Fold 2 Seed 2024:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 41/50 [2:01:05<26:53, 179.32s/it, train_acc=97.0%, val_acc=90.9%]Fold 2 Seed 2024:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 41/50 [2:04:07<26:53, 179.32s/it, train_acc=97.2%, val_acc=92.0%]Fold 2 Seed 2024:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 42/50 [2:04:07<24:00, 180.05s/it, train_acc=97.2%, val_acc=92.0%]Fold 2 Seed 2024:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 42/50 [2:07:06<24:00, 180.05s/it, train_acc=97.2%, val_acc=91.3%]Fold 2 Seed 2024:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 43/50 [2:07:06<20:57, 179.65s/it, train_acc=97.2%, val_acc=91.3%]Fold 2 Seed 2024:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 43/50 [2:10:05<20:57, 179.65s/it, train_acc=97.3%, val_acc=90.9%]Fold 2 Seed 2024:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 43/50 [2:10:05<21:10, 181.53s/it, train_acc=97.3%, val_acc=90.9%]
INFO:__main__:  Subgroup Analysis:
INFO:__main__:    AD: 84.4% (45 samples)
INFO:__main__:    AD_trajectory: 57.9% (178 samples)
INFO:__main__:    CN: 98.8% (950 samples)
INFO:__main__:    MCI_to_AD: 75.0% (40 samples)
INFO:__main__:Fold 2 - Val: 92.37%, Test: 91.51%, Balanced: 81.93%
INFO:__main__:
--- Fold 3/5 ---
INFO:__main__:Train: 4367, Val: 485, Test: 1213
INFO:dataset:Filled 1 missing values in 'AGE' with 69.00
INFO:dataset:Filled 10 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 494 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 502 missing values in 'TRAASCOR' with 30.00
INFO:dataset:Filled 541 missing values in 'TRABSCOR' with 77.00
INFO:dataset:Filled 3338 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 3341 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 3327 missing values in 'BNTTOTAL' with 23.00
INFO:dataset:Filled 2399 missing values in 'VSWEIGHT' with 165.00
INFO:dataset:Filled 2393 missing values in 'BMI' with 29.49
INFO:dataset:Filled 2634 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 2633 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 2633 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 2633 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 4367 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 3434 (78.6%)
INFO:dataset:  Class 1: 933 (21.4%)
INFO:dataset:Filled 1 missing values in 'AGE' with 69.00
INFO:dataset:Filled 3 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 56 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 56 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 62 missing values in 'TRABSCOR' with 77.00
INFO:dataset:Filled 375 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 375 missing values in 'DSPANBAC' with 5.00
INFO:dataset:Filled 373 missing values in 'BNTTOTAL' with 24.00
INFO:dataset:Filled 258 missing values in 'VSWEIGHT' with 163.00
INFO:dataset:Filled 258 missing values in 'BMI' with 29.37
INFO:dataset:Filled 294 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 294 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 294 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 294 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 485 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 364 (75.1%)
INFO:dataset:  Class 1: 121 (24.9%)
INFO:dataset:Filled 2 missing values in 'AGE' with 69.00
INFO:dataset:Filled 3 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 134 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 135 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 150 missing values in 'TRABSCOR' with 77.00
INFO:dataset:Filled 925 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 926 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 925 missing values in 'BNTTOTAL' with 23.00
INFO:dataset:Filled 676 missing values in 'VSWEIGHT' with 166.00
INFO:dataset:Filled 675 missing values in 'BMI' with 29.86
INFO:dataset:Filled 736 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 735 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 735 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 735 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 1213 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 949 (78.2%)
INFO:dataset:  Class 1: 264 (21.8%)
INFO:mri_vit_model:Created ViT3DClassifier with vit_base
INFO:mri_vit_model:  Image size: 128x128x128
INFO:mri_vit_model:  Patch size: 16
INFO:mri_vit_model:  Num patches: 512
INFO:mri_vit_model:  Embed dim: 768, Depth: 12, Heads: 12
INFO:mri_vit_model:Loading MAE pre-trained weights from ../mri_vit_ad/pretrained/vit_mae75_pretrained.pth
INFO:mri_vit_model:  Loaded pos_embed directly (shapes match: torch.Size([1, 513, 768]))
INFO:mri_vit_model:Loaded 150 pretrained weights (including pos_embed, cls_token, patch_embed if matched)
INFO:mri_vit_model:Missing keys: 2
INFO:mri_vit_model:  Missing: ['head.1.weight', 'head.1.bias']
/home/tanguy/medical/alzheimer/env/lib/python3.12/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
ViT backbone: 768-dim features
FT-Transformer tabular encoder: 16 -> 64
  Auxiliary losses: Enabled (MRI + Tabular classifiers)
MultiModalFusion initialized:
  MRI backbone: vit (768-dim)
  Tabular features: 16 -> 64
  Fusion method: cross_modal
  Fusion hidden: 512
Fold 3 Seed 2024:   0%|          | 0/50 [00:00<?, ?it/s]Fold 3 Seed 2024:   0%|          | 0/50 [02:52<?, ?it/s, train_acc=64.5%, val_acc=75.1%]Fold 3 Seed 2024:   2%|â–         | 1/50 [02:52<2:20:36, 172.17s/it, train_acc=64.5%, val_acc=75.1%]Fold 3 Seed 2024:   2%|â–         | 1/50 [05:45<2:20:36, 172.17s/it, train_acc=78.8%, val_acc=86.6%]Fold 3 Seed 2024:   4%|â–         | 2/50 [05:45<2:18:14, 172.81s/it, train_acc=78.8%, val_acc=86.6%]Fold 3 Seed 2024:   4%|â–         | 2/50 [08:40<2:18:14, 172.81s/it, train_acc=86.2%, val_acc=85.2%]Fold 3 Seed 2024:   6%|â–Œ         | 3/50 [08:40<2:16:01, 173.65s/it, train_acc=86.2%, val_acc=85.2%]Fold 3 Seed 2024:   6%|â–Œ         | 3/50 [11:34<2:16:01, 173.65s/it, train_acc=87.6%, val_acc=86.4%]Fold 3 Seed 2024:   8%|â–Š         | 4/50 [11:34<2:13:14, 173.80s/it, train_acc=87.6%, val_acc=86.4%]Fold 3 Seed 2024:   8%|â–Š         | 4/50 [14:27<2:13:14, 173.80s/it, train_acc=88.0%, val_acc=87.6%]Fold 3 Seed 2024:  10%|â–ˆ         | 5/50 [14:27<2:10:11, 173.60s/it, train_acc=88.0%, val_acc=87.6%]Fold 3 Seed 2024:  10%|â–ˆ         | 5/50 [17:20<2:10:11, 173.60s/it, train_acc=88.9%, val_acc=87.4%]Fold 3 Seed 2024:  12%|â–ˆâ–        | 6/50 [17:20<2:07:10, 173.43s/it, train_acc=88.9%, val_acc=87.4%]Fold 3 Seed 2024:  12%|â–ˆâ–        | 6/50 [20:14<2:07:10, 173.43s/it, train_acc=88.4%, val_acc=86.2%]Fold 3 Seed 2024:  14%|â–ˆâ–        | 7/50 [20:14<2:04:22, 173.54s/it, train_acc=88.4%, val_acc=86.2%]Fold 3 Seed 2024:  14%|â–ˆâ–        | 7/50 [23:07<2:04:22, 173.54s/it, train_acc=88.7%, val_acc=87.2%]Fold 3 Seed 2024:  16%|â–ˆâ–Œ        | 8/50 [23:07<2:01:21, 173.36s/it, train_acc=88.7%, val_acc=87.2%]Fold 3 Seed 2024:  16%|â–ˆâ–Œ        | 8/50 [26:00<2:01:21, 173.36s/it, train_acc=89.8%, val_acc=91.3%]Fold 3 Seed 2024:  18%|â–ˆâ–Š        | 9/50 [26:00<1:58:27, 173.35s/it, train_acc=89.8%, val_acc=91.3%]Fold 3 Seed 2024:  18%|â–ˆâ–Š        | 9/50 [28:53<1:58:27, 173.35s/it, train_acc=90.1%, val_acc=89.3%]Fold 3 Seed 2024:  20%|â–ˆâ–ˆ        | 10/50 [28:53<1:55:24, 173.12s/it, train_acc=90.1%, val_acc=89.3%]Fold 3 Seed 2024:  20%|â–ˆâ–ˆ        | 10/50 [31:47<1:55:24, 173.12s/it, train_acc=90.2%, val_acc=91.3%]Fold 3 Seed 2024:  22%|â–ˆâ–ˆâ–       | 11/50 [31:47<1:52:48, 173.56s/it, train_acc=90.2%, val_acc=91.3%]Fold 3 Seed 2024:  22%|â–ˆâ–ˆâ–       | 11/50 [34:41<1:52:48, 173.56s/it, train_acc=91.0%, val_acc=92.2%]Fold 3 Seed 2024:  24%|â–ˆâ–ˆâ–       | 12/50 [34:41<1:50:01, 173.72s/it, train_acc=91.0%, val_acc=92.2%]Fold 3 Seed 2024:  24%|â–ˆâ–ˆâ–       | 12/50 [37:36<1:50:01, 173.72s/it, train_acc=91.1%, val_acc=92.4%]Fold 3 Seed 2024:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [37:36<1:47:23, 174.14s/it, train_acc=91.1%, val_acc=92.4%]Fold 3 Seed 2024:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [40:30<1:47:23, 174.14s/it, train_acc=91.2%, val_acc=92.0%]Fold 3 Seed 2024:  28%|â–ˆâ–ˆâ–Š       | 14/50 [40:30<1:44:28, 174.12s/it, train_acc=91.2%, val_acc=92.0%]Fold 3 Seed 2024:  28%|â–ˆâ–ˆâ–Š       | 14/50 [43:24<1:44:28, 174.12s/it, train_acc=92.0%, val_acc=90.9%]Fold 3 Seed 2024:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [43:24<1:41:32, 174.07s/it, train_acc=92.0%, val_acc=90.9%]Fold 3 Seed 2024:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [46:18<1:41:32, 174.07s/it, train_acc=91.5%, val_acc=93.0%]Fold 3 Seed 2024:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [46:18<1:38:33, 173.91s/it, train_acc=91.5%, val_acc=93.0%]Fold 3 Seed 2024:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [49:12<1:38:33, 173.91s/it, train_acc=92.0%, val_acc=92.4%]Fold 3 Seed 2024:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [49:12<1:35:42, 174.02s/it, train_acc=92.0%, val_acc=92.4%]Fold 3 Seed 2024:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [52:07<1:35:42, 174.02s/it, train_acc=91.6%, val_acc=88.5%]Fold 3 Seed 2024:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [52:07<1:32:52, 174.15s/it, train_acc=91.6%, val_acc=88.5%]Fold 3 Seed 2024:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [55:01<1:32:52, 174.15s/it, train_acc=92.1%, val_acc=92.2%]Fold 3 Seed 2024:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [55:01<1:29:59, 174.17s/it, train_acc=92.1%, val_acc=92.2%]Fold 3 Seed 2024:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [57:54<1:29:59, 174.17s/it, train_acc=92.3%, val_acc=92.0%]Fold 3 Seed 2024:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [57:54<1:26:56, 173.90s/it, train_acc=92.3%, val_acc=92.0%]Fold 3 Seed 2024:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [1:00:47<1:26:56, 173.90s/it, train_acc=92.0%, val_acc=92.6%]Fold 3 Seed 2024:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:00:47<1:23:58, 173.73s/it, train_acc=92.0%, val_acc=92.6%]Fold 3 Seed 2024:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:03:42<1:23:58, 173.73s/it, train_acc=92.7%, val_acc=92.4%]Fold 3 Seed 2024:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:03:42<1:21:11, 173.97s/it, train_acc=92.7%, val_acc=92.4%]Fold 3 Seed 2024:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:06:35<1:21:11, 173.97s/it, train_acc=93.0%, val_acc=91.8%]Fold 3 Seed 2024:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:06:36<1:18:13, 173.83s/it, train_acc=93.0%, val_acc=91.8%]Fold 3 Seed 2024:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:09:30<1:18:13, 173.83s/it, train_acc=93.1%, val_acc=92.6%]Fold 3 Seed 2024:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:09:30<1:15:25, 174.05s/it, train_acc=93.1%, val_acc=92.6%]Fold 3 Seed 2024:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:12:23<1:15:25, 174.05s/it, train_acc=93.3%, val_acc=92.4%]Fold 3 Seed 2024:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:12:23<1:12:24, 173.80s/it, train_acc=93.3%, val_acc=92.4%]Fold 3 Seed 2024:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:15:18<1:12:24, 173.80s/it, train_acc=93.4%, val_acc=92.4%]Fold 3 Seed 2024:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:15:18<1:09:39, 174.14s/it, train_acc=93.4%, val_acc=92.4%]Fold 3 Seed 2024:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:18:13<1:09:39, 174.14s/it, train_acc=93.5%, val_acc=92.8%]Fold 3 Seed 2024:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:18:13<1:06:46, 174.21s/it, train_acc=93.5%, val_acc=92.8%]Fold 3 Seed 2024:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:21:04<1:06:46, 174.21s/it, train_acc=93.7%, val_acc=92.0%]Fold 3 Seed 2024:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:21:05<1:03:37, 173.52s/it, train_acc=93.7%, val_acc=92.0%]Fold 3 Seed 2024:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:24:00<1:03:37, 173.52s/it, train_acc=94.4%, val_acc=92.6%]Fold 3 Seed 2024:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:24:00<1:00:57, 174.17s/it, train_acc=94.4%, val_acc=92.6%]Fold 3 Seed 2024:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:26:54<1:00:57, 174.17s/it, train_acc=94.2%, val_acc=91.5%]Fold 3 Seed 2024:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:26:54<58:01, 174.07s/it, train_acc=94.2%, val_acc=91.5%]  Fold 3 Seed 2024:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:29:48<58:01, 174.07s/it, train_acc=94.2%, val_acc=92.4%]Fold 3 Seed 2024:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:29:48<59:52, 179.60s/it, train_acc=94.2%, val_acc=92.4%]
INFO:__main__:  Subgroup Analysis:
INFO:__main__:    AD: 92.5% (40 samples)
INFO:__main__:    AD_trajectory: 64.4% (174 samples)
INFO:__main__:    CN: 96.1% (949 samples)
INFO:__main__:    MCI_to_AD: 84.0% (50 samples)
INFO:__main__:Fold 3 - Val: 92.99%, Test: 90.93%, Balanced: 84.22%
INFO:__main__:
--- Fold 4/5 ---
INFO:__main__:Train: 4367, Val: 485, Test: 1213
INFO:dataset:Filled 3 missing values in 'AGE' with 69.00
INFO:dataset:Filled 13 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 489 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 495 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 530 missing values in 'TRABSCOR' with 76.00
INFO:dataset:Filled 3360 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 3363 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 3351 missing values in 'BNTTOTAL' with 23.00
INFO:dataset:Filled 2415 missing values in 'VSWEIGHT' with 165.60
INFO:dataset:Filled 2412 missing values in 'BMI' with 29.35
INFO:dataset:Filled 2657 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 2655 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 2655 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 2655 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 4367 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 3425 (78.4%)
INFO:dataset:  Class 1: 942 (21.6%)
INFO:dataset:Filled 1 missing values in 'AGE' with 70.00
INFO:dataset:Filled 1 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 52 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 52 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 63 missing values in 'TRABSCOR' with 80.00
INFO:dataset:Filled 367 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 367 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 365 missing values in 'BNTTOTAL' with 23.00
INFO:dataset:Filled 275 missing values in 'VSWEIGHT' with 163.00
INFO:dataset:Filled 274 missing values in 'BMI' with 29.40
INFO:dataset:Filled 294 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 294 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 294 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 294 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 485 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 373 (76.9%)
INFO:dataset:  Class 1: 112 (23.1%)
INFO:dataset:Filled 2 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 143 missing values in 'CATANIMSC' with 21.00
INFO:dataset:Filled 146 missing values in 'TRAASCOR' with 30.00
INFO:dataset:Filled 160 missing values in 'TRABSCOR' with 76.00
INFO:dataset:Filled 911 missing values in 'DSPANFOR' with 7.00
INFO:dataset:Filled 912 missing values in 'DSPANBAC' with 5.00
INFO:dataset:Filled 909 missing values in 'BNTTOTAL' with 24.00
INFO:dataset:Filled 643 missing values in 'VSWEIGHT' with 164.60
INFO:dataset:Filled 640 missing values in 'BMI' with 29.90
INFO:dataset:Filled 713 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 713 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 713 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 713 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 1213 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 949 (78.2%)
INFO:dataset:  Class 1: 264 (21.8%)
INFO:mri_vit_model:Created ViT3DClassifier with vit_base
INFO:mri_vit_model:  Image size: 128x128x128
INFO:mri_vit_model:  Patch size: 16
INFO:mri_vit_model:  Num patches: 512
INFO:mri_vit_model:  Embed dim: 768, Depth: 12, Heads: 12
INFO:mri_vit_model:Loading MAE pre-trained weights from ../mri_vit_ad/pretrained/vit_mae75_pretrained.pth
INFO:mri_vit_model:  Loaded pos_embed directly (shapes match: torch.Size([1, 513, 768]))
INFO:mri_vit_model:Loaded 150 pretrained weights (including pos_embed, cls_token, patch_embed if matched)
INFO:mri_vit_model:Missing keys: 2
INFO:mri_vit_model:  Missing: ['head.1.weight', 'head.1.bias']
/home/tanguy/medical/alzheimer/env/lib/python3.12/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
ViT backbone: 768-dim features
FT-Transformer tabular encoder: 16 -> 64
  Auxiliary losses: Enabled (MRI + Tabular classifiers)
MultiModalFusion initialized:
  MRI backbone: vit (768-dim)
  Tabular features: 16 -> 64
  Fusion method: cross_modal
  Fusion hidden: 512
Fold 4 Seed 2024:   0%|          | 0/50 [00:00<?, ?it/s]Fold 4 Seed 2024:   0%|          | 0/50 [02:53<?, ?it/s, train_acc=65.7%, val_acc=76.9%]Fold 4 Seed 2024:   2%|â–         | 1/50 [02:53<2:21:40, 173.47s/it, train_acc=65.7%, val_acc=76.9%]Fold 4 Seed 2024:   2%|â–         | 1/50 [05:45<2:21:40, 173.47s/it, train_acc=78.0%, val_acc=87.2%]Fold 4 Seed 2024:   4%|â–         | 2/50 [05:45<2:18:06, 172.63s/it, train_acc=78.0%, val_acc=87.2%]Fold 4 Seed 2024:   4%|â–         | 2/50 [08:38<2:18:06, 172.63s/it, train_acc=85.6%, val_acc=88.9%]Fold 4 Seed 2024:   6%|â–Œ         | 3/50 [08:38<2:15:29, 172.97s/it, train_acc=85.6%, val_acc=88.9%]Fold 4 Seed 2024:   6%|â–Œ         | 3/50 [11:32<2:15:29, 172.97s/it, train_acc=87.0%, val_acc=88.5%]Fold 4 Seed 2024:   8%|â–Š         | 4/50 [11:32<2:12:46, 173.18s/it, train_acc=87.0%, val_acc=88.5%]Fold 4 Seed 2024:   8%|â–Š         | 4/50 [14:26<2:12:46, 173.18s/it, train_acc=87.8%, val_acc=88.7%]Fold 4 Seed 2024:  10%|â–ˆ         | 5/50 [14:26<2:10:13, 173.63s/it, train_acc=87.8%, val_acc=88.7%]Fold 4 Seed 2024:  10%|â–ˆ         | 5/50 [17:21<2:10:13, 173.63s/it, train_acc=87.7%, val_acc=89.1%]Fold 4 Seed 2024:  12%|â–ˆâ–        | 6/50 [17:21<2:07:41, 174.13s/it, train_acc=87.7%, val_acc=89.1%]Fold 4 Seed 2024:  12%|â–ˆâ–        | 6/50 [20:15<2:07:41, 174.13s/it, train_acc=88.7%, val_acc=88.7%]Fold 4 Seed 2024:  14%|â–ˆâ–        | 7/50 [20:15<2:04:42, 174.00s/it, train_acc=88.7%, val_acc=88.7%]Fold 4 Seed 2024:  14%|â–ˆâ–        | 7/50 [23:09<2:04:42, 174.00s/it, train_acc=88.7%, val_acc=88.5%]Fold 4 Seed 2024:  16%|â–ˆâ–Œ        | 8/50 [23:09<2:01:43, 173.89s/it, train_acc=88.7%, val_acc=88.5%]Fold 4 Seed 2024:  16%|â–ˆâ–Œ        | 8/50 [26:02<2:01:43, 173.89s/it, train_acc=89.8%, val_acc=89.9%]Fold 4 Seed 2024:  18%|â–ˆâ–Š        | 9/50 [26:02<1:58:44, 173.78s/it, train_acc=89.8%, val_acc=89.9%]Fold 4 Seed 2024:  18%|â–ˆâ–Š        | 9/50 [28:57<1:58:44, 173.78s/it, train_acc=89.8%, val_acc=89.5%]Fold 4 Seed 2024:  20%|â–ˆâ–ˆ        | 10/50 [28:57<1:55:59, 174.00s/it, train_acc=89.8%, val_acc=89.5%]Fold 4 Seed 2024:  20%|â–ˆâ–ˆ        | 10/50 [31:51<1:55:59, 174.00s/it, train_acc=90.7%, val_acc=92.0%]Fold 4 Seed 2024:  22%|â–ˆâ–ˆâ–       | 11/50 [31:51<1:53:07, 174.03s/it, train_acc=90.7%, val_acc=92.0%]Fold 4 Seed 2024:  22%|â–ˆâ–ˆâ–       | 11/50 [34:50<1:53:07, 174.03s/it, train_acc=90.7%, val_acc=88.2%]Fold 4 Seed 2024:  24%|â–ˆâ–ˆâ–       | 12/50 [34:50<1:51:11, 175.57s/it, train_acc=90.7%, val_acc=88.2%]Fold 4 Seed 2024:  24%|â–ˆâ–ˆâ–       | 12/50 [37:44<1:51:11, 175.57s/it, train_acc=91.0%, val_acc=91.5%]Fold 4 Seed 2024:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [37:44<1:48:00, 175.15s/it, train_acc=91.0%, val_acc=91.5%]Fold 4 Seed 2024:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [40:39<1:48:00, 175.15s/it, train_acc=91.5%, val_acc=91.8%]Fold 4 Seed 2024:  28%|â–ˆâ–ˆâ–Š       | 14/50 [40:39<1:44:56, 174.91s/it, train_acc=91.5%, val_acc=91.8%]Fold 4 Seed 2024:  28%|â–ˆâ–ˆâ–Š       | 14/50 [43:33<1:44:56, 174.91s/it, train_acc=91.4%, val_acc=91.8%]Fold 4 Seed 2024:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [43:33<1:41:51, 174.62s/it, train_acc=91.4%, val_acc=91.8%]Fold 4 Seed 2024:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [46:28<1:41:51, 174.62s/it, train_acc=91.5%, val_acc=89.5%]Fold 4 Seed 2024:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [46:28<1:39:01, 174.76s/it, train_acc=91.5%, val_acc=89.5%]Fold 4 Seed 2024:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [49:22<1:39:01, 174.76s/it, train_acc=91.9%, val_acc=89.9%]Fold 4 Seed 2024:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [49:22<1:35:58, 174.51s/it, train_acc=91.9%, val_acc=89.9%]Fold 4 Seed 2024:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [52:15<1:35:58, 174.51s/it, train_acc=92.3%, val_acc=90.7%]Fold 4 Seed 2024:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [52:15<1:32:52, 174.14s/it, train_acc=92.3%, val_acc=90.7%]Fold 4 Seed 2024:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [55:08<1:32:52, 174.14s/it, train_acc=92.2%, val_acc=90.7%]Fold 4 Seed 2024:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [55:08<1:29:49, 173.84s/it, train_acc=92.2%, val_acc=90.7%]Fold 4 Seed 2024:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [58:02<1:29:49, 173.84s/it, train_acc=92.8%, val_acc=92.6%]Fold 4 Seed 2024:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [58:02<1:26:57, 173.93s/it, train_acc=92.8%, val_acc=92.6%]Fold 4 Seed 2024:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [1:01:01<1:26:57, 173.93s/it, train_acc=92.8%, val_acc=92.2%]Fold 4 Seed 2024:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:01:01<1:24:47, 175.45s/it, train_acc=92.8%, val_acc=92.2%]Fold 4 Seed 2024:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:03:55<1:24:47, 175.45s/it, train_acc=92.7%, val_acc=90.7%]Fold 4 Seed 2024:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:03:55<1:21:38, 174.95s/it, train_acc=92.7%, val_acc=90.7%]Fold 4 Seed 2024:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:06:49<1:21:38, 174.95s/it, train_acc=93.1%, val_acc=92.6%]Fold 4 Seed 2024:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:06:49<1:18:34, 174.60s/it, train_acc=93.1%, val_acc=92.6%]Fold 4 Seed 2024:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:09:42<1:18:34, 174.60s/it, train_acc=93.4%, val_acc=90.7%]Fold 4 Seed 2024:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:09:42<1:15:30, 174.26s/it, train_acc=93.4%, val_acc=90.7%]Fold 4 Seed 2024:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:12:36<1:15:30, 174.26s/it, train_acc=93.7%, val_acc=89.3%]Fold 4 Seed 2024:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:12:36<1:12:32, 174.11s/it, train_acc=93.7%, val_acc=89.3%]Fold 4 Seed 2024:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:15:30<1:12:32, 174.11s/it, train_acc=93.7%, val_acc=90.7%]Fold 4 Seed 2024:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:15:30<1:09:39, 174.16s/it, train_acc=93.7%, val_acc=90.7%]Fold 4 Seed 2024:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:18:25<1:09:39, 174.16s/it, train_acc=94.0%, val_acc=93.6%]Fold 4 Seed 2024:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:18:26<1:06:53, 174.52s/it, train_acc=94.0%, val_acc=93.6%]Fold 4 Seed 2024:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:21:20<1:06:53, 174.52s/it, train_acc=94.5%, val_acc=93.4%]Fold 4 Seed 2024:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:21:20<1:03:59, 174.52s/it, train_acc=94.5%, val_acc=93.4%]Fold 4 Seed 2024:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:24:14<1:03:59, 174.52s/it, train_acc=94.1%, val_acc=90.3%]Fold 4 Seed 2024:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:24:14<1:01:00, 174.33s/it, train_acc=94.1%, val_acc=90.3%]Fold 4 Seed 2024:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:27:08<1:01:00, 174.33s/it, train_acc=94.9%, val_acc=93.4%]Fold 4 Seed 2024:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:27:08<58:07, 174.37s/it, train_acc=94.9%, val_acc=93.4%]  Fold 4 Seed 2024:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:30:01<58:07, 174.37s/it, train_acc=94.8%, val_acc=89.7%]Fold 4 Seed 2024:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:30:01<55:04, 173.94s/it, train_acc=94.8%, val_acc=89.7%]Fold 4 Seed 2024:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:32:54<55:04, 173.94s/it, train_acc=95.1%, val_acc=91.5%]Fold 4 Seed 2024:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:32:54<52:04, 173.59s/it, train_acc=95.1%, val_acc=91.5%]Fold 4 Seed 2024:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:35:51<52:04, 173.59s/it, train_acc=95.5%, val_acc=90.3%]Fold 4 Seed 2024:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:35:51<49:27, 174.53s/it, train_acc=95.5%, val_acc=90.3%]Fold 4 Seed 2024:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:38:44<49:27, 174.53s/it, train_acc=95.8%, val_acc=92.4%]Fold 4 Seed 2024:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 34/50 [1:38:44<46:25, 174.08s/it, train_acc=95.8%, val_acc=92.4%]Fold 4 Seed 2024:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 34/50 [1:41:37<46:25, 174.08s/it, train_acc=96.0%, val_acc=90.5%]Fold 4 Seed 2024:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 35/50 [1:41:37<43:28, 173.87s/it, train_acc=96.0%, val_acc=90.5%]Fold 4 Seed 2024:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 35/50 [1:44:31<43:28, 173.87s/it, train_acc=96.4%, val_acc=93.2%]Fold 4 Seed 2024:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [1:44:31<40:35, 173.97s/it, train_acc=96.4%, val_acc=93.2%]Fold 4 Seed 2024:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [1:47:24<40:35, 173.97s/it, train_acc=96.1%, val_acc=89.1%]Fold 4 Seed 2024:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 37/50 [1:47:24<37:37, 173.66s/it, train_acc=96.1%, val_acc=89.1%]Fold 4 Seed 2024:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 37/50 [1:50:19<37:37, 173.66s/it, train_acc=96.3%, val_acc=92.2%]Fold 4 Seed 2024:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 38/50 [1:50:19<34:47, 173.97s/it, train_acc=96.3%, val_acc=92.2%]Fold 4 Seed 2024:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 38/50 [1:53:12<34:47, 173.97s/it, train_acc=96.4%, val_acc=91.8%]Fold 4 Seed 2024:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 39/50 [1:53:12<31:51, 173.76s/it, train_acc=96.4%, val_acc=91.8%]Fold 4 Seed 2024:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 39/50 [1:56:07<31:51, 173.76s/it, train_acc=96.8%, val_acc=90.7%]Fold 4 Seed 2024:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 40/50 [1:56:07<29:01, 174.14s/it, train_acc=96.8%, val_acc=90.7%]Fold 4 Seed 2024:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 40/50 [1:59:02<29:01, 174.14s/it, train_acc=97.5%, val_acc=90.5%]Fold 4 Seed 2024:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 41/50 [1:59:02<26:09, 174.38s/it, train_acc=97.5%, val_acc=90.5%]Fold 4 Seed 2024:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 41/50 [2:01:57<26:09, 174.38s/it, train_acc=97.1%, val_acc=92.2%]Fold 4 Seed 2024:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 41/50 [2:01:57<26:46, 178.47s/it, train_acc=97.1%, val_acc=92.2%]
INFO:__main__:  Subgroup Analysis:
INFO:__main__:    AD: 97.5% (40 samples)
INFO:__main__:    AD_trajectory: 80.6% (170 samples)
INFO:__main__:    CN: 91.7% (949 samples)
INFO:__main__:    MCI_to_AD: 96.3% (54 samples)
INFO:__main__:Fold 4 - Val: 93.61%, Test: 90.52%, Balanced: 89.02%
INFO:__main__:
--- Fold 5/5 ---
INFO:__main__:Train: 4367, Val: 485, Test: 1213
INFO:dataset:Filled 3 missing values in 'AGE' with 69.00
INFO:dataset:Filled 12 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 510 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 517 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 565 missing values in 'TRABSCOR' with 77.00
INFO:dataset:Filled 3342 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 3343 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 3333 missing values in 'BNTTOTAL' with 23.00
INFO:dataset:Filled 2395 missing values in 'VSWEIGHT' with 165.00
INFO:dataset:Filled 2389 missing values in 'BMI' with 29.43
INFO:dataset:Filled 2629 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 2627 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 2627 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 2627 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 4367 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 3417 (78.2%)
INFO:dataset:  Class 1: 950 (21.8%)
INFO:dataset:Filled 52 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 54 missing values in 'TRAASCOR' with 30.00
INFO:dataset:Filled 58 missing values in 'TRABSCOR' with 76.00
INFO:dataset:Filled 377 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 379 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 376 missing values in 'BNTTOTAL' with 22.00
INFO:dataset:Filled 273 missing values in 'VSWEIGHT' with 160.50
INFO:dataset:Filled 273 missing values in 'BMI' with 28.65
INFO:dataset:Filled 299 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 299 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 299 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 299 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 485 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 381 (78.6%)
INFO:dataset:  Class 1: 104 (21.4%)
INFO:dataset:Filled 1 missing values in 'AGE' with 69.41
INFO:dataset:Filled 4 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 122 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 122 missing values in 'TRAASCOR' with 30.00
INFO:dataset:Filled 130 missing values in 'TRABSCOR' with 78.00
INFO:dataset:Filled 919 missing values in 'DSPANFOR' with 6.00
INFO:dataset:Filled 920 missing values in 'DSPANBAC' with 4.00
INFO:dataset:Filled 916 missing values in 'BNTTOTAL' with 23.00
INFO:dataset:Filled 665 missing values in 'VSWEIGHT' with 165.00
INFO:dataset:Filled 664 missing values in 'BMI' with 30.08
INFO:dataset:Filled 736 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 736 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 736 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 736 missing values in 'MH2NEURL' with 0.00
INFO:dataset:Loaded 1213 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 949 (78.2%)
INFO:dataset:  Class 1: 264 (21.8%)
INFO:mri_vit_model:Created ViT3DClassifier with vit_base
INFO:mri_vit_model:  Image size: 128x128x128
INFO:mri_vit_model:  Patch size: 16
INFO:mri_vit_model:  Num patches: 512
INFO:mri_vit_model:  Embed dim: 768, Depth: 12, Heads: 12
INFO:mri_vit_model:Loading MAE pre-trained weights from ../mri_vit_ad/pretrained/vit_mae75_pretrained.pth
INFO:mri_vit_model:  Loaded pos_embed directly (shapes match: torch.Size([1, 513, 768]))
INFO:mri_vit_model:Loaded 150 pretrained weights (including pos_embed, cls_token, patch_embed if matched)
INFO:mri_vit_model:Missing keys: 2
INFO:mri_vit_model:  Missing: ['head.1.weight', 'head.1.bias']
/home/tanguy/medical/alzheimer/env/lib/python3.12/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
ViT backbone: 768-dim features
FT-Transformer tabular encoder: 16 -> 64
  Auxiliary losses: Enabled (MRI + Tabular classifiers)
MultiModalFusion initialized:
  MRI backbone: vit (768-dim)
  Tabular features: 16 -> 64
  Fusion method: cross_modal
  Fusion hidden: 512
Fold 5 Seed 2024:   0%|          | 0/50 [00:00<?, ?it/s]Fold 5 Seed 2024:   0%|          | 0/50 [02:52<?, ?it/s, train_acc=64.8%, val_acc=78.6%]Fold 5 Seed 2024:   2%|â–         | 1/50 [02:52<2:21:04, 172.74s/it, train_acc=64.8%, val_acc=78.6%]Fold 5 Seed 2024:   2%|â–         | 1/50 [05:45<2:21:04, 172.74s/it, train_acc=78.9%, val_acc=82.5%]Fold 5 Seed 2024:   4%|â–         | 2/50 [05:45<2:18:02, 172.56s/it, train_acc=78.9%, val_acc=82.5%]Fold 5 Seed 2024:   4%|â–         | 2/50 [08:39<2:18:02, 172.56s/it, train_acc=86.4%, val_acc=87.6%]Fold 5 Seed 2024:   6%|â–Œ         | 3/50 [08:39<2:15:47, 173.35s/it, train_acc=86.4%, val_acc=87.6%]Fold 5 Seed 2024:   6%|â–Œ         | 3/50 [11:32<2:15:47, 173.35s/it, train_acc=87.7%, val_acc=86.8%]Fold 5 Seed 2024:   8%|â–Š         | 4/50 [11:32<2:12:57, 173.42s/it, train_acc=87.7%, val_acc=86.8%]Fold 5 Seed 2024:   8%|â–Š         | 4/50 [14:26<2:12:57, 173.42s/it, train_acc=87.5%, val_acc=87.2%]Fold 5 Seed 2024:  10%|â–ˆ         | 5/50 [14:26<2:10:02, 173.38s/it, train_acc=87.5%, val_acc=87.2%]Fold 5 Seed 2024:  10%|â–ˆ         | 5/50 [17:21<2:10:02, 173.38s/it, train_acc=88.8%, val_acc=87.6%]Fold 5 Seed 2024:  12%|â–ˆâ–        | 6/50 [17:21<2:07:32, 173.92s/it, train_acc=88.8%, val_acc=87.6%]Fold 5 Seed 2024:  12%|â–ˆâ–        | 6/50 [20:15<2:07:32, 173.92s/it, train_acc=88.9%, val_acc=88.5%]Fold 5 Seed 2024:  14%|â–ˆâ–        | 7/50 [20:15<2:04:43, 174.05s/it, train_acc=88.9%, val_acc=88.5%]Fold 5 Seed 2024:  14%|â–ˆâ–        | 7/50 [23:09<2:04:43, 174.05s/it, train_acc=89.1%, val_acc=90.1%]Fold 5 Seed 2024:  16%|â–ˆâ–Œ        | 8/50 [23:09<2:01:47, 173.99s/it, train_acc=89.1%, val_acc=90.1%]Fold 5 Seed 2024:  16%|â–ˆâ–Œ        | 8/50 [26:02<2:01:47, 173.99s/it, train_acc=89.8%, val_acc=90.5%]Fold 5 Seed 2024:  18%|â–ˆâ–Š        | 9/50 [26:02<1:58:40, 173.68s/it, train_acc=89.8%, val_acc=90.5%]Fold 5 Seed 2024:  18%|â–ˆâ–Š        | 9/50 [28:56<1:58:40, 173.68s/it, train_acc=90.5%, val_acc=92.4%]Fold 5 Seed 2024:  20%|â–ˆâ–ˆ        | 10/50 [28:56<1:55:49, 173.73s/it, train_acc=90.5%, val_acc=92.4%]Fold 5 Seed 2024:  20%|â–ˆâ–ˆ        | 10/50 [31:51<1:55:49, 173.73s/it, train_acc=91.0%, val_acc=90.7%]Fold 5 Seed 2024:  22%|â–ˆâ–ˆâ–       | 11/50 [31:51<1:53:18, 174.32s/it, train_acc=91.0%, val_acc=90.7%]Fold 5 Seed 2024:  22%|â–ˆâ–ˆâ–       | 11/50 [34:44<1:53:18, 174.32s/it, train_acc=91.7%, val_acc=89.5%]Fold 5 Seed 2024:  24%|â–ˆâ–ˆâ–       | 12/50 [34:44<1:50:02, 173.74s/it, train_acc=91.7%, val_acc=89.5%]Fold 5 Seed 2024:  24%|â–ˆâ–ˆâ–       | 12/50 [37:38<1:50:02, 173.74s/it, train_acc=91.7%, val_acc=93.4%]Fold 5 Seed 2024:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [37:39<1:47:20, 174.05s/it, train_acc=91.7%, val_acc=93.4%]Fold 5 Seed 2024:  26%|â–ˆâ–ˆâ–Œ       | 13/50 [40:33<1:47:20, 174.05s/it, train_acc=92.1%, val_acc=93.2%]Fold 5 Seed 2024:  28%|â–ˆâ–ˆâ–Š       | 14/50 [40:33<1:44:25, 174.05s/it, train_acc=92.1%, val_acc=93.2%]Fold 5 Seed 2024:  28%|â–ˆâ–ˆâ–Š       | 14/50 [43:27<1:44:25, 174.05s/it, train_acc=92.2%, val_acc=90.9%]Fold 5 Seed 2024:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [43:27<1:41:34, 174.13s/it, train_acc=92.2%, val_acc=90.9%]Fold 5 Seed 2024:  30%|â–ˆâ–ˆâ–ˆ       | 15/50 [46:21<1:41:34, 174.13s/it, train_acc=93.3%, val_acc=92.6%]Fold 5 Seed 2024:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [46:21<1:38:38, 174.06s/it, train_acc=93.3%, val_acc=92.6%]Fold 5 Seed 2024:  32%|â–ˆâ–ˆâ–ˆâ–      | 16/50 [49:16<1:38:38, 174.06s/it, train_acc=92.9%, val_acc=93.4%]Fold 5 Seed 2024:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [49:16<1:35:55, 174.42s/it, train_acc=92.9%, val_acc=93.4%]Fold 5 Seed 2024:  34%|â–ˆâ–ˆâ–ˆâ–      | 17/50 [52:11<1:35:55, 174.42s/it, train_acc=93.0%, val_acc=93.0%]Fold 5 Seed 2024:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [52:11<1:33:02, 174.44s/it, train_acc=93.0%, val_acc=93.0%]Fold 5 Seed 2024:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 18/50 [55:05<1:33:02, 174.44s/it, train_acc=93.2%, val_acc=92.8%]Fold 5 Seed 2024:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [55:05<1:30:11, 174.55s/it, train_acc=93.2%, val_acc=92.8%]Fold 5 Seed 2024:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 19/50 [57:59<1:30:11, 174.55s/it, train_acc=93.3%, val_acc=93.8%]Fold 5 Seed 2024:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [57:59<1:27:05, 174.20s/it, train_acc=93.3%, val_acc=93.8%]Fold 5 Seed 2024:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 20/50 [1:00:59<1:27:05, 174.20s/it, train_acc=93.4%, val_acc=94.4%]Fold 5 Seed 2024:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:00:59<1:25:03, 175.99s/it, train_acc=93.4%, val_acc=94.4%]Fold 5 Seed 2024:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 21/50 [1:03:54<1:25:03, 175.99s/it, train_acc=93.9%, val_acc=94.4%]Fold 5 Seed 2024:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:03:54<1:21:56, 175.60s/it, train_acc=93.9%, val_acc=94.4%]Fold 5 Seed 2024:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 22/50 [1:06:47<1:21:56, 175.60s/it, train_acc=94.2%, val_acc=92.6%]Fold 5 Seed 2024:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:06:47<1:18:40, 174.85s/it, train_acc=94.2%, val_acc=92.6%]Fold 5 Seed 2024:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 23/50 [1:09:42<1:18:40, 174.85s/it, train_acc=94.1%, val_acc=90.7%]Fold 5 Seed 2024:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:09:42<1:15:46, 174.88s/it, train_acc=94.1%, val_acc=90.7%]Fold 5 Seed 2024:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 24/50 [1:12:36<1:15:46, 174.88s/it, train_acc=94.3%, val_acc=92.2%]Fold 5 Seed 2024:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:12:36<1:12:45, 174.63s/it, train_acc=94.3%, val_acc=92.2%]Fold 5 Seed 2024:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 25/50 [1:15:29<1:12:45, 174.63s/it, train_acc=94.7%, val_acc=92.6%]Fold 5 Seed 2024:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:15:29<1:09:40, 174.20s/it, train_acc=94.7%, val_acc=92.6%]Fold 5 Seed 2024:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 26/50 [1:18:23<1:09:40, 174.20s/it, train_acc=95.0%, val_acc=93.2%]Fold 5 Seed 2024:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:18:23<1:06:44, 174.11s/it, train_acc=95.0%, val_acc=93.2%]Fold 5 Seed 2024:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 27/50 [1:21:17<1:06:44, 174.11s/it, train_acc=94.8%, val_acc=93.2%]Fold 5 Seed 2024:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:21:17<1:03:51, 174.14s/it, train_acc=94.8%, val_acc=93.2%]Fold 5 Seed 2024:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ    | 28/50 [1:24:12<1:03:51, 174.14s/it, train_acc=95.1%, val_acc=92.6%]Fold 5 Seed 2024:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:24:12<1:01:00, 174.30s/it, train_acc=95.1%, val_acc=92.6%]Fold 5 Seed 2024:  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 29/50 [1:27:06<1:01:00, 174.30s/it, train_acc=95.5%, val_acc=94.2%]Fold 5 Seed 2024:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:27:06<58:02, 174.15s/it, train_acc=95.5%, val_acc=94.2%]  Fold 5 Seed 2024:  60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 30/50 [1:30:00<58:02, 174.15s/it, train_acc=95.5%, val_acc=94.8%]Fold 5 Seed 2024:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:30:01<55:13, 174.39s/it, train_acc=95.5%, val_acc=94.8%]Fold 5 Seed 2024:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 31/50 [1:32:59<55:13, 174.39s/it, train_acc=96.1%, val_acc=93.0%]Fold 5 Seed 2024:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:32:59<52:41, 175.65s/it, train_acc=96.1%, val_acc=93.0%]Fold 5 Seed 2024:  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 32/50 [1:35:57<52:41, 175.65s/it, train_acc=96.2%, val_acc=93.0%]Fold 5 Seed 2024:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:35:57<49:59, 176.46s/it, train_acc=96.2%, val_acc=93.0%]Fold 5 Seed 2024:  66%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ   | 33/50 [1:38:55<49:59, 176.46s/it, train_acc=96.4%, val_acc=92.0%]Fold 5 Seed 2024:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 34/50 [1:38:55<47:10, 176.88s/it, train_acc=96.4%, val_acc=92.0%]Fold 5 Seed 2024:  68%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š   | 34/50 [1:41:56<47:10, 176.88s/it, train_acc=96.7%, val_acc=92.6%]Fold 5 Seed 2024:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 35/50 [1:41:56<44:29, 177.95s/it, train_acc=96.7%, val_acc=92.6%]Fold 5 Seed 2024:  70%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ   | 35/50 [1:44:56<44:29, 177.95s/it, train_acc=96.9%, val_acc=93.6%]Fold 5 Seed 2024:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [1:44:56<41:42, 178.73s/it, train_acc=96.9%, val_acc=93.6%]Fold 5 Seed 2024:  72%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 36/50 [1:47:55<41:42, 178.73s/it, train_acc=97.3%, val_acc=92.6%]Fold 5 Seed 2024:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 37/50 [1:47:56<38:45, 178.87s/it, train_acc=97.3%, val_acc=92.6%]Fold 5 Seed 2024:  74%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–  | 37/50 [1:50:55<38:45, 178.87s/it, train_acc=97.3%, val_acc=93.4%]Fold 5 Seed 2024:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 38/50 [1:50:55<35:47, 178.94s/it, train_acc=97.3%, val_acc=93.4%]Fold 5 Seed 2024:  76%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 38/50 [1:53:55<35:47, 178.94s/it, train_acc=97.5%, val_acc=91.3%]Fold 5 Seed 2024:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 39/50 [1:53:55<32:54, 179.46s/it, train_acc=97.5%, val_acc=91.3%]Fold 5 Seed 2024:  78%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š  | 39/50 [1:56:56<32:54, 179.46s/it, train_acc=97.7%, val_acc=92.8%]Fold 5 Seed 2024:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 40/50 [1:56:56<29:57, 179.74s/it, train_acc=97.7%, val_acc=92.8%]Fold 5 Seed 2024:  80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 40/50 [1:59:55<29:57, 179.74s/it, train_acc=98.1%, val_acc=91.8%]Fold 5 Seed 2024:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 41/50 [1:59:55<26:57, 179.73s/it, train_acc=98.1%, val_acc=91.8%]Fold 5 Seed 2024:  82%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 41/50 [2:02:54<26:57, 179.73s/it, train_acc=98.1%, val_acc=92.0%]Fold 5 Seed 2024:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 42/50 [2:02:54<23:55, 179.44s/it, train_acc=98.1%, val_acc=92.0%]Fold 5 Seed 2024:  84%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 42/50 [2:05:53<23:55, 179.44s/it, train_acc=98.3%, val_acc=92.2%]Fold 5 Seed 2024:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 43/50 [2:05:53<20:55, 179.30s/it, train_acc=98.3%, val_acc=92.2%]Fold 5 Seed 2024:  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 43/50 [2:08:53<20:55, 179.30s/it, train_acc=98.3%, val_acc=91.8%]Fold 5 Seed 2024:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 44/50 [2:08:53<17:56, 179.44s/it, train_acc=98.3%, val_acc=91.8%]Fold 5 Seed 2024:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 44/50 [2:11:54<17:56, 179.44s/it, train_acc=98.2%, val_acc=92.2%]Fold 5 Seed 2024:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 45/50 [2:11:54<14:58, 179.79s/it, train_acc=98.2%, val_acc=92.2%]Fold 5 Seed 2024:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 45/50 [2:14:55<14:58, 179.79s/it, train_acc=98.5%, val_acc=91.8%]Fold 5 Seed 2024:  90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 45/50 [2:14:55<14:59, 179.89s/it, train_acc=98.5%, val_acc=91.8%]
INFO:__main__:  Subgroup Analysis:
INFO:__main__:    AD: 90.6% (53 samples)
INFO:__main__:    AD_trajectory: 80.1% (156 samples)
INFO:__main__:    CN: 94.4% (949 samples)
INFO:__main__:    MCI_to_AD: 83.6% (55 samples)
INFO:__main__:Fold 5 - Val: 94.85%, Test: 91.92%, Balanced: 88.68%
INFO:__main__:
Seed 2024 Summary: 91.26% +/- 0.49%
INFO:__main__:
============================================================
INFO:__main__:CROSS-VALIDATION RESULTS
INFO:__main__:============================================================
INFO:__main__:Seed 42: 91.33% +/- 1.20%
INFO:__main__:Seed 123: 91.85% +/- 0.49%
INFO:__main__:Seed 456: 91.61% +/- 1.58%
INFO:__main__:Seed 789: 91.87% +/- 0.52%
INFO:__main__:Seed 2024: 91.26% +/- 0.54%
INFO:__main__:
========================================
INFO:__main__:OVERALL: 91.58% +/- 0.93%
INFO:__main__:BALANCED: 85.76% +/- 2.57%
INFO:__main__:========================================
INFO:__main__:
SUBGROUP ANALYSIS SUMMARY:
INFO:__main__:========================================
INFO:__main__:  AD: 94.3% +/- 3.5% (avg 44 samples/fold)
INFO:__main__:  AD_trajectory: 68.9% +/- 8.2% (avg 168 samples/fold)
INFO:__main__:  CN: 96.1% +/- 1.5% (avg 949 samples/fold)
INFO:__main__:  MCI_to_AD: 80.8% +/- 6.0% (avg 52 samples/fold)
INFO:__main__:========================================
INFO:__main__:
Results saved to cv_results
