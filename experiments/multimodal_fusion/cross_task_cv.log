nohup: les entrÃ©es sont ignorÃ©es
[0;93m2026-01-13 10:39:09.235403728 [W:onnxruntime:Default, device_discovery.cc:164 DiscoverDevicesForPlatform] GPU device discovery failed: device_discovery.cc:89 ReadFileContents Failed to open file: "/sys/class/drm/card0/device/vendor"[m
INFO:__main__:Device: cuda
INFO:__main__:Combined train+val: 5155 samples
INFO:__main__:
============================================================
INFO:__main__:SEED 42
INFO:__main__:============================================================
INFO:dataset:Filled 4 missing values in 'AGE' with 69.00
INFO:dataset:Filled 10 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 593 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 601 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 653 missing values in 'TRABSCOR' with 77.00
INFO:dataset:Filled 1013 missing values in 'DSPANFOR' with -4.00
INFO:dataset:Filled 1018 missing values in 'DSPANBAC' with -4.00
INFO:dataset:Filled 1005 missing values in 'BNTTOTAL' with -4.00
INFO:dataset:Filled 167 missing values in 'VSWEIGHT' with 167.00
INFO:dataset:Filled 1 missing values in 'BMI' with 28.30
INFO:dataset:Filled 289 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 287 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 287 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 287 missing values in 'MH2NEURL' with -4.00
INFO:dataset:Loaded 5155 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 4035 (78.3%)
INFO:dataset:  Class 1: 1120 (21.7%)
INFO:dataset:Filled 6 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 91 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 92 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 100 missing values in 'TRABSCOR' with 78.00
INFO:dataset:Filled 184 missing values in 'DSPANFOR' with -4.00
INFO:dataset:Filled 184 missing values in 'DSPANBAC' with -4.00
INFO:dataset:Filled 179 missing values in 'BNTTOTAL' with -4.00
INFO:dataset:Filled 33 missing values in 'VSWEIGHT' with 164.00
INFO:dataset:Filled 2 missing values in 'BMI' with 28.20
INFO:dataset:Filled 60 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 60 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 60 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 60 missing values in 'MH2NEURL' with -4.00
INFO:dataset:Loaded 910 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 712 (78.2%)
INFO:dataset:  Class 1: 198 (21.8%)
INFO:dataset:Filled 1 missing values in 'AGE' with 69.00
INFO:dataset:Filled 4 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 88 missing values in 'CATANIMSC' with 21.00
INFO:dataset:Filled 90 missing values in 'TRAASCOR' with 30.00
INFO:dataset:Filled 101 missing values in 'TRABSCOR' with 75.00
INFO:dataset:Filled 162 missing values in 'DSPANFOR' with -4.00
INFO:dataset:Filled 164 missing values in 'DSPANBAC' with -4.00
INFO:dataset:Filled 161 missing values in 'BNTTOTAL' with -4.00
INFO:dataset:Filled 34 missing values in 'VSWEIGHT' with 163.00
INFO:dataset:Filled 2 missing values in 'BMI' with 27.55
INFO:dataset:Filled 51 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 51 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 51 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 51 missing values in 'MH2NEURL' with -4.00
INFO:dataset:Loaded 856 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 718 (83.9%)
INFO:dataset:  Class 1: 138 (16.1%)
INFO:__main__:
--- Fold 1/5 ---
INFO:dataset:Filled 4 missing values in 'AGE' with 69.00
INFO:dataset:Filled 10 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 593 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 601 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 653 missing values in 'TRABSCOR' with 77.00
INFO:dataset:Filled 1013 missing values in 'DSPANFOR' with -4.00
INFO:dataset:Filled 1018 missing values in 'DSPANBAC' with -4.00
INFO:dataset:Filled 1005 missing values in 'BNTTOTAL' with -4.00
INFO:dataset:Filled 167 missing values in 'VSWEIGHT' with 167.00
INFO:dataset:Filled 1 missing values in 'BMI' with 28.30
INFO:dataset:Filled 289 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 287 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 287 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 287 missing values in 'MH2NEURL' with -4.00
INFO:dataset:Loaded 5155 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 4035 (78.3%)
INFO:dataset:  Class 1: 1120 (21.7%)
INFO:mri_vit_model:Created ViT3DClassifier with vit_base
INFO:mri_vit_model:  Image size: 128x128x128
INFO:mri_vit_model:  Patch size: 16
INFO:mri_vit_model:  Num patches: 512
INFO:mri_vit_model:  Embed dim: 768, Depth: 12, Heads: 12
INFO:mri_vit_model:Loading MAE pre-trained weights from ../mri_vit_ad/pretrained/vit_mae75_pretrained.pth
INFO:mri_vit_model:  Loaded pos_embed directly (shapes match: torch.Size([1, 513, 768]))
INFO:mri_vit_model:Loaded 150 pretrained weights (including pos_embed, cls_token, patch_embed if matched)
INFO:mri_vit_model:Missing keys: 2
INFO:mri_vit_model:  Missing: ['head.1.weight', 'head.1.bias']
/home/tanguy/medical/alzheimer/env/lib/python3.12/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
ViT backbone: 768-dim features
FT-Transformer tabular encoder: 16 -> 64
  Auxiliary losses: Enabled (MRI + Tabular classifiers)
MultiModalFusion initialized:
  MRI backbone: vit (768-dim)
  Tabular features: 16 -> 64
  Fusion method: cross_modal
  Fusion hidden: 512
Training:   0%|          | 0/100 [00:00<?, ?it/s]Training:   0%|          | 0/100 [03:02<?, ?it/s, train=60.6%, val=78.4%]Training:   1%|          | 1/100 [03:02<5:00:58, 182.41s/it, train=60.6%, val=78.4%]Training:   1%|          | 1/100 [06:27<5:00:58, 182.41s/it, train=79.9%, val=86.1%]Training:   2%|â–         | 2/100 [06:27<5:19:30, 195.62s/it, train=79.9%, val=86.1%]Training:   2%|â–         | 2/100 [09:32<5:19:30, 195.62s/it, train=87.3%, val=87.6%]Training:   3%|â–Ž         | 3/100 [09:32<5:08:39, 190.93s/it, train=87.3%, val=87.6%]Training:   3%|â–Ž         | 3/100 [12:36<5:08:39, 190.93s/it, train=88.2%, val=87.3%]Training:   4%|â–         | 4/100 [12:36<5:01:18, 188.31s/it, train=88.2%, val=87.3%]Training:   4%|â–         | 4/100 [15:41<5:01:18, 188.31s/it, train=88.5%, val=87.8%]Training:   5%|â–Œ         | 5/100 [15:41<4:56:00, 186.95s/it, train=88.5%, val=87.8%]Training:   5%|â–Œ         | 5/100 [18:50<4:56:00, 186.95s/it, train=88.2%, val=87.7%]Training:   6%|â–Œ         | 6/100 [18:50<4:54:15, 187.83s/it, train=88.2%, val=87.7%]Training:   6%|â–Œ         | 6/100 [21:56<4:54:15, 187.83s/it, train=87.6%, val=87.6%]Training:   7%|â–‹         | 7/100 [21:56<4:50:00, 187.10s/it, train=87.6%, val=87.6%]Training:   7%|â–‹         | 7/100 [25:02<4:50:00, 187.10s/it, train=88.0%, val=87.2%]Training:   8%|â–Š         | 8/100 [25:02<4:46:03, 186.56s/it, train=88.0%, val=87.2%]Training:   8%|â–Š         | 8/100 [28:06<4:46:03, 186.56s/it, train=88.3%, val=87.8%]Training:   9%|â–‰         | 9/100 [28:06<4:42:06, 186.00s/it, train=88.3%, val=87.8%]Training:   9%|â–‰         | 9/100 [31:10<4:42:06, 186.00s/it, train=88.1%, val=87.2%]Training:  10%|â–ˆ         | 10/100 [31:10<4:37:44, 185.16s/it, train=88.1%, val=87.2%]Training:  10%|â–ˆ         | 10/100 [34:14<4:37:44, 185.16s/it, train=88.2%, val=87.8%]Training:  11%|â–ˆ         | 11/100 [34:14<4:34:23, 184.98s/it, train=88.2%, val=87.8%]Training:  11%|â–ˆ         | 11/100 [37:17<4:34:23, 184.98s/it, train=88.4%, val=88.5%]Training:  12%|â–ˆâ–        | 12/100 [37:17<4:30:30, 184.43s/it, train=88.4%, val=88.5%]Training:  12%|â–ˆâ–        | 12/100 [40:22<4:30:30, 184.43s/it, train=88.6%, val=87.6%]Training:  13%|â–ˆâ–Ž        | 13/100 [40:22<4:27:37, 184.56s/it, train=88.6%, val=87.6%]Training:  13%|â–ˆâ–Ž        | 13/100 [43:28<4:27:37, 184.56s/it, train=88.9%, val=88.8%]Training:  14%|â–ˆâ–        | 14/100 [43:28<4:24:59, 184.88s/it, train=88.9%, val=88.8%]Training:  14%|â–ˆâ–        | 14/100 [46:34<4:24:59, 184.88s/it, train=88.6%, val=89.0%]Training:  15%|â–ˆâ–Œ        | 15/100 [46:34<4:22:20, 185.18s/it, train=88.6%, val=89.0%]Training:  15%|â–ˆâ–Œ        | 15/100 [49:40<4:22:20, 185.18s/it, train=88.3%, val=88.3%]Training:  16%|â–ˆâ–Œ        | 16/100 [49:40<4:19:38, 185.45s/it, train=88.3%, val=88.3%]Training:  16%|â–ˆâ–Œ        | 16/100 [52:45<4:19:38, 185.45s/it, train=88.7%, val=88.9%]Training:  17%|â–ˆâ–‹        | 17/100 [52:45<4:16:33, 185.47s/it, train=88.7%, val=88.9%]Training:  17%|â–ˆâ–‹        | 17/100 [55:48<4:16:33, 185.47s/it, train=88.6%, val=89.2%]Training:  18%|â–ˆâ–Š        | 18/100 [55:49<4:12:36, 184.84s/it, train=88.6%, val=89.2%]Training:  18%|â–ˆâ–Š        | 18/100 [58:59<4:12:36, 184.84s/it, train=89.2%, val=88.8%]Training:  19%|â–ˆâ–‰        | 19/100 [58:59<4:11:35, 186.36s/it, train=89.2%, val=88.8%]Training:  19%|â–ˆâ–‰        | 19/100 [1:02:09<4:11:35, 186.36s/it, train=89.3%, val=88.2%]Training:  20%|â–ˆâ–ˆ        | 20/100 [1:02:09<4:09:56, 187.45s/it, train=89.3%, val=88.2%]Training:  20%|â–ˆâ–ˆ        | 20/100 [1:05:18<4:09:56, 187.45s/it, train=89.2%, val=89.5%]Training:  21%|â–ˆâ–ˆ        | 21/100 [1:05:18<4:07:44, 188.16s/it, train=89.2%, val=89.5%]Training:  21%|â–ˆâ–ˆ        | 21/100 [1:08:23<4:07:44, 188.16s/it, train=89.5%, val=88.9%]Training:  22%|â–ˆâ–ˆâ–       | 22/100 [1:08:23<4:03:23, 187.22s/it, train=89.5%, val=88.9%]Training:  22%|â–ˆâ–ˆâ–       | 22/100 [1:11:30<4:03:23, 187.22s/it, train=89.1%, val=89.0%]Training:  23%|â–ˆâ–ˆâ–Ž       | 23/100 [1:11:30<3:59:52, 186.91s/it, train=89.1%, val=89.0%]Training:  23%|â–ˆâ–ˆâ–Ž       | 23/100 [1:14:35<3:59:52, 186.91s/it, train=89.6%, val=89.4%]Training:  24%|â–ˆâ–ˆâ–       | 24/100 [1:14:35<3:56:02, 186.35s/it, train=89.6%, val=89.4%]Training:  24%|â–ˆâ–ˆâ–       | 24/100 [1:17:40<3:56:02, 186.35s/it, train=89.3%, val=89.4%]Training:  25%|â–ˆâ–ˆâ–Œ       | 25/100 [1:17:40<3:52:32, 186.04s/it, train=89.3%, val=89.4%]Training:  25%|â–ˆâ–ˆâ–Œ       | 25/100 [1:20:45<3:52:32, 186.04s/it, train=89.7%, val=89.2%]Training:  26%|â–ˆâ–ˆâ–Œ       | 26/100 [1:20:45<3:49:04, 185.74s/it, train=89.7%, val=89.2%]Training:  26%|â–ˆâ–ˆâ–Œ       | 26/100 [1:23:50<3:49:04, 185.74s/it, train=89.6%, val=89.2%]Training:  27%|â–ˆâ–ˆâ–‹       | 27/100 [1:23:50<3:45:43, 185.52s/it, train=89.6%, val=89.2%]Training:  27%|â–ˆâ–ˆâ–‹       | 27/100 [1:26:55<3:45:43, 185.52s/it, train=89.7%, val=89.0%]Training:  28%|â–ˆâ–ˆâ–Š       | 28/100 [1:26:55<3:42:28, 185.39s/it, train=89.7%, val=89.0%]Training:  28%|â–ˆâ–ˆâ–Š       | 28/100 [1:29:59<3:42:28, 185.39s/it, train=89.6%, val=89.4%]Training:  29%|â–ˆâ–ˆâ–‰       | 29/100 [1:29:59<3:38:57, 185.03s/it, train=89.6%, val=89.4%]Training:  29%|â–ˆâ–ˆâ–‰       | 29/100 [1:33:03<3:38:57, 185.03s/it, train=90.0%, val=89.0%]Training:  30%|â–ˆâ–ˆâ–ˆ       | 30/100 [1:33:03<3:35:27, 184.67s/it, train=90.0%, val=89.0%]Training:  30%|â–ˆâ–ˆâ–ˆ       | 30/100 [1:36:08<3:35:27, 184.67s/it, train=90.4%, val=89.4%]Training:  31%|â–ˆâ–ˆâ–ˆ       | 31/100 [1:36:08<3:32:35, 184.86s/it, train=90.4%, val=89.4%]Training:  31%|â–ˆâ–ˆâ–ˆ       | 31/100 [1:39:13<3:32:35, 184.86s/it, train=90.3%, val=89.3%]Training:  32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [1:39:13<3:29:25, 184.78s/it, train=90.3%, val=89.3%]Training:  32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [1:42:17<3:29:25, 184.78s/it, train=90.0%, val=88.6%]Training:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [1:42:17<3:26:05, 184.56s/it, train=90.0%, val=88.6%]Training:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [1:45:23<3:26:05, 184.56s/it, train=89.9%, val=89.1%]Training:  34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [1:45:23<3:23:23, 184.91s/it, train=89.9%, val=89.1%]Training:  34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [1:48:28<3:23:23, 184.91s/it, train=90.3%, val=89.0%]Training:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [1:48:28<3:20:23, 184.98s/it, train=90.3%, val=89.0%]Training:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [1:51:34<3:20:23, 184.98s/it, train=90.0%, val=88.9%]                                                                                       INFO:__main__:  Val: 89.5% | Traj: 90.0% | CN_AD: 90.4%
INFO:__main__:
--- Fold 2/5 ---
INFO:dataset:Filled 4 missing values in 'AGE' with 69.00
INFO:dataset:Filled 10 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 593 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 601 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 653 missing values in 'TRABSCOR' with 77.00
INFO:dataset:Filled 1013 missing values in 'DSPANFOR' with -4.00
INFO:dataset:Filled 1018 missing values in 'DSPANBAC' with -4.00
INFO:dataset:Filled 1005 missing values in 'BNTTOTAL' with -4.00
INFO:dataset:Filled 167 missing values in 'VSWEIGHT' with 167.00
INFO:dataset:Filled 1 missing values in 'BMI' with 28.30
INFO:dataset:Filled 289 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 287 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 287 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 287 missing values in 'MH2NEURL' with -4.00
INFO:dataset:Loaded 5155 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 4035 (78.3%)
INFO:dataset:  Class 1: 1120 (21.7%)
INFO:mri_vit_model:Created ViT3DClassifier with vit_base
INFO:mri_vit_model:  Image size: 128x128x128
INFO:mri_vit_model:  Patch size: 16
INFO:mri_vit_model:  Num patches: 512
INFO:mri_vit_model:  Embed dim: 768, Depth: 12, Heads: 12
INFO:mri_vit_model:Loading MAE pre-trained weights from ../mri_vit_ad/pretrained/vit_mae75_pretrained.pth
INFO:mri_vit_model:  Loaded pos_embed directly (shapes match: torch.Size([1, 513, 768]))
INFO:mri_vit_model:Loaded 150 pretrained weights (including pos_embed, cls_token, patch_embed if matched)
INFO:mri_vit_model:Missing keys: 2
INFO:mri_vit_model:  Missing: ['head.1.weight', 'head.1.bias']
/home/tanguy/medical/alzheimer/env/lib/python3.12/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
ViT backbone: 768-dim features
FT-Transformer tabular encoder: 16 -> 64
  Auxiliary losses: Enabled (MRI + Tabular classifiers)
MultiModalFusion initialized:
  MRI backbone: vit (768-dim)
  Tabular features: 16 -> 64
  Fusion method: cross_modal
  Fusion hidden: 512
Training:   0%|          | 0/100 [00:00<?, ?it/s]Training:   0%|          | 0/100 [03:03<?, ?it/s, train=45.6%, val=78.6%]Training:   1%|          | 1/100 [03:03<5:02:37, 183.40s/it, train=45.6%, val=78.6%]Training:   1%|          | 1/100 [06:30<5:02:37, 183.40s/it, train=78.4%, val=79.0%]Training:   2%|â–         | 2/100 [06:30<5:22:32, 197.47s/it, train=78.4%, val=79.0%]Training:   2%|â–         | 2/100 [09:34<5:22:32, 197.47s/it, train=86.3%, val=87.6%]Training:   3%|â–Ž         | 3/100 [09:34<5:09:14, 191.28s/it, train=86.3%, val=87.6%]Training:   3%|â–Ž         | 3/100 [12:39<5:09:14, 191.28s/it, train=87.2%, val=88.6%]Training:   4%|â–         | 4/100 [12:39<5:02:06, 188.82s/it, train=87.2%, val=88.6%]Training:   4%|â–         | 4/100 [15:44<5:02:06, 188.82s/it, train=88.0%, val=89.3%]Training:   5%|â–Œ         | 5/100 [15:44<4:56:30, 187.27s/it, train=88.0%, val=89.3%]Training:   5%|â–Œ         | 5/100 [18:49<4:56:30, 187.27s/it, train=88.1%, val=89.7%]Training:   6%|â–Œ         | 6/100 [18:49<4:52:09, 186.49s/it, train=88.1%, val=89.7%]Training:   6%|â–Œ         | 6/100 [21:54<4:52:09, 186.49s/it, train=88.1%, val=90.7%]Training:   7%|â–‹         | 7/100 [21:54<4:48:31, 186.14s/it, train=88.1%, val=90.7%]Training:   7%|â–‹         | 7/100 [25:05<4:48:31, 186.14s/it, train=89.0%, val=88.9%]Training:   8%|â–Š         | 8/100 [25:05<4:47:57, 187.80s/it, train=89.0%, val=88.9%]Training:   8%|â–Š         | 8/100 [28:17<4:47:57, 187.80s/it, train=90.5%, val=92.0%]Training:   9%|â–‰         | 9/100 [28:17<4:46:36, 188.98s/it, train=90.5%, val=92.0%]Training:   9%|â–‰         | 9/100 [31:28<4:46:36, 188.98s/it, train=90.1%, val=91.5%]Training:  10%|â–ˆ         | 10/100 [31:28<4:44:16, 189.52s/it, train=90.1%, val=91.5%]Training:  10%|â–ˆ         | 10/100 [34:38<4:44:16, 189.52s/it, train=90.8%, val=92.0%]Training:  11%|â–ˆ         | 11/100 [34:38<4:41:38, 189.87s/it, train=90.8%, val=92.0%]Training:  11%|â–ˆ         | 11/100 [37:49<4:41:38, 189.87s/it, train=91.2%, val=92.0%]Training:  12%|â–ˆâ–        | 12/100 [37:49<4:38:58, 190.21s/it, train=91.2%, val=92.0%]Training:  12%|â–ˆâ–        | 12/100 [41:01<4:38:58, 190.21s/it, train=91.3%, val=88.6%]Training:  13%|â–ˆâ–Ž        | 13/100 [41:01<4:36:14, 190.52s/it, train=91.3%, val=88.6%]Training:  13%|â–ˆâ–Ž        | 13/100 [44:10<4:36:14, 190.52s/it, train=91.7%, val=92.8%]Training:  14%|â–ˆâ–        | 14/100 [44:10<4:32:46, 190.31s/it, train=91.7%, val=92.8%]Training:  14%|â–ˆâ–        | 14/100 [47:22<4:32:46, 190.31s/it, train=92.2%, val=90.5%]Training:  15%|â–ˆâ–Œ        | 15/100 [47:22<4:30:10, 190.71s/it, train=92.2%, val=90.5%]Training:  15%|â–ˆâ–Œ        | 15/100 [50:32<4:30:10, 190.71s/it, train=92.2%, val=87.0%]Training:  16%|â–ˆâ–Œ        | 16/100 [50:32<4:26:33, 190.39s/it, train=92.2%, val=87.0%]Training:  16%|â–ˆâ–Œ        | 16/100 [53:42<4:26:33, 190.39s/it, train=92.7%, val=93.1%]Training:  17%|â–ˆâ–‹        | 17/100 [53:42<4:23:30, 190.49s/it, train=92.7%, val=93.1%]Training:  17%|â–ˆâ–‹        | 17/100 [56:46<4:23:30, 190.49s/it, train=92.6%, val=92.1%]Training:  18%|â–ˆâ–Š        | 18/100 [56:46<4:17:38, 188.52s/it, train=92.6%, val=92.1%]Training:  18%|â–ˆâ–Š        | 18/100 [59:51<4:17:38, 188.52s/it, train=92.6%, val=93.9%]Training:  19%|â–ˆâ–‰        | 19/100 [59:51<4:13:05, 187.47s/it, train=92.6%, val=93.9%]Training:  19%|â–ˆâ–‰        | 19/100 [1:03:01<4:13:05, 187.47s/it, train=93.2%, val=92.7%]Training:  20%|â–ˆâ–ˆ        | 20/100 [1:03:01<4:10:51, 188.14s/it, train=93.2%, val=92.7%]Training:  20%|â–ˆâ–ˆ        | 20/100 [1:06:11<4:10:51, 188.14s/it, train=93.5%, val=93.2%]Training:  21%|â–ˆâ–ˆ        | 21/100 [1:06:11<4:08:26, 188.69s/it, train=93.5%, val=93.2%]Training:  21%|â–ˆâ–ˆ        | 21/100 [1:09:22<4:08:26, 188.69s/it, train=93.3%, val=92.5%]Training:  22%|â–ˆâ–ˆâ–       | 22/100 [1:09:22<4:06:12, 189.39s/it, train=93.3%, val=92.5%]Training:  22%|â–ˆâ–ˆâ–       | 22/100 [1:12:33<4:06:12, 189.39s/it, train=93.7%, val=89.4%]Training:  23%|â–ˆâ–ˆâ–Ž       | 23/100 [1:12:33<4:03:32, 189.77s/it, train=93.7%, val=89.4%]Training:  23%|â–ˆâ–ˆâ–Ž       | 23/100 [1:15:43<4:03:32, 189.77s/it, train=93.5%, val=93.6%]Training:  24%|â–ˆâ–ˆâ–       | 24/100 [1:15:43<4:00:35, 189.94s/it, train=93.5%, val=93.6%]Training:  24%|â–ˆâ–ˆâ–       | 24/100 [1:18:55<4:00:35, 189.94s/it, train=93.9%, val=92.6%]Training:  25%|â–ˆâ–ˆâ–Œ       | 25/100 [1:18:55<3:57:58, 190.38s/it, train=93.9%, val=92.6%]Training:  25%|â–ˆâ–ˆâ–Œ       | 25/100 [1:22:05<3:57:58, 190.38s/it, train=94.1%, val=92.0%]Training:  26%|â–ˆâ–ˆâ–Œ       | 26/100 [1:22:05<3:54:54, 190.47s/it, train=94.1%, val=92.0%]Training:  26%|â–ˆâ–ˆâ–Œ       | 26/100 [1:25:16<3:54:54, 190.47s/it, train=94.4%, val=92.7%]Training:  27%|â–ˆâ–ˆâ–‹       | 27/100 [1:25:16<3:51:45, 190.49s/it, train=94.4%, val=92.7%]Training:  27%|â–ˆâ–ˆâ–‹       | 27/100 [1:28:27<3:51:45, 190.49s/it, train=94.8%, val=92.5%]Training:  28%|â–ˆâ–ˆâ–Š       | 28/100 [1:28:27<3:48:50, 190.70s/it, train=94.8%, val=92.5%]Training:  28%|â–ˆâ–ˆâ–Š       | 28/100 [1:31:38<3:48:50, 190.70s/it, train=94.5%, val=93.2%]Training:  29%|â–ˆâ–ˆâ–‰       | 29/100 [1:31:38<3:45:46, 190.80s/it, train=94.5%, val=93.2%]Training:  29%|â–ˆâ–ˆâ–‰       | 29/100 [1:34:49<3:45:46, 190.80s/it, train=94.7%, val=93.7%]Training:  30%|â–ˆâ–ˆâ–ˆ       | 30/100 [1:34:49<3:42:45, 190.94s/it, train=94.7%, val=93.7%]Training:  30%|â–ˆâ–ˆâ–ˆ       | 30/100 [1:37:59<3:42:45, 190.94s/it, train=94.1%, val=92.9%]Training:  31%|â–ˆâ–ˆâ–ˆ       | 31/100 [1:37:59<3:39:18, 190.70s/it, train=94.1%, val=92.9%]Training:  31%|â–ˆâ–ˆâ–ˆ       | 31/100 [1:41:10<3:39:18, 190.70s/it, train=95.6%, val=93.9%]Training:  32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [1:41:10<3:36:05, 190.67s/it, train=95.6%, val=93.9%]Training:  32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [1:44:21<3:36:05, 190.67s/it, train=95.1%, val=93.6%]Training:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [1:44:21<3:33:08, 190.87s/it, train=95.1%, val=93.6%]Training:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [1:47:33<3:33:08, 190.87s/it, train=95.8%, val=88.7%]                                                                                       INFO:__main__:  Val: 93.9% | Traj: 92.0% | CN_AD: 94.5%
INFO:__main__:
--- Fold 3/5 ---
INFO:dataset:Filled 4 missing values in 'AGE' with 69.00
INFO:dataset:Filled 10 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 593 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 601 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 653 missing values in 'TRABSCOR' with 77.00
INFO:dataset:Filled 1013 missing values in 'DSPANFOR' with -4.00
INFO:dataset:Filled 1018 missing values in 'DSPANBAC' with -4.00
INFO:dataset:Filled 1005 missing values in 'BNTTOTAL' with -4.00
INFO:dataset:Filled 167 missing values in 'VSWEIGHT' with 167.00
INFO:dataset:Filled 1 missing values in 'BMI' with 28.30
INFO:dataset:Filled 289 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 287 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 287 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 287 missing values in 'MH2NEURL' with -4.00
INFO:dataset:Loaded 5155 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 4035 (78.3%)
INFO:dataset:  Class 1: 1120 (21.7%)
INFO:mri_vit_model:Created ViT3DClassifier with vit_base
INFO:mri_vit_model:  Image size: 128x128x128
INFO:mri_vit_model:  Patch size: 16
INFO:mri_vit_model:  Num patches: 512
INFO:mri_vit_model:  Embed dim: 768, Depth: 12, Heads: 12
INFO:mri_vit_model:Loading MAE pre-trained weights from ../mri_vit_ad/pretrained/vit_mae75_pretrained.pth
INFO:mri_vit_model:  Loaded pos_embed directly (shapes match: torch.Size([1, 513, 768]))
INFO:mri_vit_model:Loaded 150 pretrained weights (including pos_embed, cls_token, patch_embed if matched)
INFO:mri_vit_model:Missing keys: 2
INFO:mri_vit_model:  Missing: ['head.1.weight', 'head.1.bias']
/home/tanguy/medical/alzheimer/env/lib/python3.12/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
ViT backbone: 768-dim features
FT-Transformer tabular encoder: 16 -> 64
  Auxiliary losses: Enabled (MRI + Tabular classifiers)
MultiModalFusion initialized:
  MRI backbone: vit (768-dim)
  Tabular features: 16 -> 64
  Fusion method: cross_modal
  Fusion hidden: 512
Training:   0%|          | 0/100 [00:00<?, ?it/s]Training:   0%|          | 0/100 [03:04<?, ?it/s, train=72.2%, val=78.3%]Training:   1%|          | 1/100 [03:04<5:04:10, 184.34s/it, train=72.2%, val=78.3%]Training:   1%|          | 1/100 [06:28<5:04:10, 184.34s/it, train=78.1%, val=82.8%]Training:   2%|â–         | 2/100 [06:29<5:20:36, 196.29s/it, train=78.1%, val=82.8%]Training:   2%|â–         | 2/100 [09:31<5:20:36, 196.29s/it, train=84.7%, val=87.6%]Training:   3%|â–Ž         | 3/100 [09:31<5:07:04, 189.95s/it, train=84.7%, val=87.6%]Training:   3%|â–Ž         | 3/100 [12:34<5:07:04, 189.95s/it, train=86.9%, val=87.9%]Training:   4%|â–         | 4/100 [12:35<4:59:56, 187.46s/it, train=86.9%, val=87.9%]Training:   4%|â–         | 4/100 [15:43<4:59:56, 187.46s/it, train=87.7%, val=88.3%]Training:   5%|â–Œ         | 5/100 [15:43<4:57:34, 187.94s/it, train=87.7%, val=88.3%]Training:   5%|â–Œ         | 5/100 [18:47<4:57:34, 187.94s/it, train=88.0%, val=88.2%]Training:   6%|â–Œ         | 6/100 [18:47<4:51:55, 186.34s/it, train=88.0%, val=88.2%]Training:   6%|â–Œ         | 6/100 [21:51<4:51:55, 186.34s/it, train=88.7%, val=88.7%]Training:   7%|â–‹         | 7/100 [21:51<4:48:04, 185.85s/it, train=88.7%, val=88.7%]Training:   7%|â–‹         | 7/100 [24:57<4:48:04, 185.85s/it, train=87.8%, val=87.3%]Training:   8%|â–Š         | 8/100 [24:57<4:44:39, 185.65s/it, train=87.8%, val=87.3%]Training:   8%|â–Š         | 8/100 [27:59<4:44:39, 185.65s/it, train=87.7%, val=87.4%]Training:   9%|â–‰         | 9/100 [27:59<4:40:12, 184.75s/it, train=87.7%, val=87.4%]Training:   9%|â–‰         | 9/100 [31:04<4:40:12, 184.75s/it, train=88.3%, val=88.3%]Training:  10%|â–ˆ         | 10/100 [31:04<4:37:06, 184.74s/it, train=88.3%, val=88.3%]Training:  10%|â–ˆ         | 10/100 [34:09<4:37:06, 184.74s/it, train=88.5%, val=89.4%]Training:  11%|â–ˆ         | 11/100 [34:09<4:34:16, 184.90s/it, train=88.5%, val=89.4%]Training:  11%|â–ˆ         | 11/100 [37:13<4:34:16, 184.90s/it, train=88.8%, val=88.5%]Training:  12%|â–ˆâ–        | 12/100 [37:13<4:30:39, 184.54s/it, train=88.8%, val=88.5%]Training:  12%|â–ˆâ–        | 12/100 [40:16<4:30:39, 184.54s/it, train=89.5%, val=89.2%]Training:  13%|â–ˆâ–Ž        | 13/100 [40:16<4:26:44, 183.96s/it, train=89.5%, val=89.2%]Training:  13%|â–ˆâ–Ž        | 13/100 [43:19<4:26:44, 183.96s/it, train=89.7%, val=86.8%]Training:  14%|â–ˆâ–        | 14/100 [43:19<4:23:10, 183.61s/it, train=89.7%, val=86.8%]Training:  14%|â–ˆâ–        | 14/100 [46:22<4:23:10, 183.61s/it, train=90.3%, val=87.0%]Training:  15%|â–ˆâ–Œ        | 15/100 [46:22<4:20:08, 183.63s/it, train=90.3%, val=87.0%]Training:  15%|â–ˆâ–Œ        | 15/100 [49:27<4:20:08, 183.63s/it, train=90.8%, val=89.5%]Training:  16%|â–ˆâ–Œ        | 16/100 [49:27<4:17:25, 183.88s/it, train=90.8%, val=89.5%]Training:  16%|â–ˆâ–Œ        | 16/100 [52:33<4:17:25, 183.88s/it, train=90.7%, val=90.9%]Training:  17%|â–ˆâ–‹        | 17/100 [52:33<4:15:18, 184.56s/it, train=90.7%, val=90.9%]Training:  17%|â–ˆâ–‹        | 17/100 [55:42<4:15:18, 184.56s/it, train=91.2%, val=88.1%]Training:  18%|â–ˆâ–Š        | 18/100 [55:42<4:14:07, 185.95s/it, train=91.2%, val=88.1%]Training:  18%|â–ˆâ–Š        | 18/100 [58:54<4:14:07, 185.95s/it, train=90.8%, val=90.3%]Training:  19%|â–ˆâ–‰        | 19/100 [58:54<4:13:22, 187.68s/it, train=90.8%, val=90.3%]Training:  19%|â–ˆâ–‰        | 19/100 [1:02:04<4:13:22, 187.68s/it, train=91.2%, val=89.9%]Training:  20%|â–ˆâ–ˆ        | 20/100 [1:02:04<4:11:14, 188.43s/it, train=91.2%, val=89.9%]Training:  20%|â–ˆâ–ˆ        | 20/100 [1:05:14<4:11:14, 188.43s/it, train=91.8%, val=89.7%]Training:  21%|â–ˆâ–ˆ        | 21/100 [1:05:14<4:08:37, 188.83s/it, train=91.8%, val=89.7%]Training:  21%|â–ˆâ–ˆ        | 21/100 [1:08:23<4:08:37, 188.83s/it, train=91.3%, val=91.9%]Training:  22%|â–ˆâ–ˆâ–       | 22/100 [1:08:23<4:05:35, 188.91s/it, train=91.3%, val=91.9%]Training:  22%|â–ˆâ–ˆâ–       | 22/100 [1:11:33<4:05:35, 188.91s/it, train=91.2%, val=90.5%]Training:  23%|â–ˆâ–ˆâ–Ž       | 23/100 [1:11:33<4:02:48, 189.20s/it, train=91.2%, val=90.5%]Training:  23%|â–ˆâ–ˆâ–Ž       | 23/100 [1:14:42<4:02:48, 189.20s/it, train=91.9%, val=91.3%]Training:  24%|â–ˆâ–ˆâ–       | 24/100 [1:14:42<3:59:40, 189.22s/it, train=91.9%, val=91.3%]Training:  24%|â–ˆâ–ˆâ–       | 24/100 [1:17:52<3:59:40, 189.22s/it, train=92.2%, val=90.0%]Training:  25%|â–ˆâ–ˆâ–Œ       | 25/100 [1:17:52<3:56:45, 189.41s/it, train=92.2%, val=90.0%]Training:  25%|â–ˆâ–ˆâ–Œ       | 25/100 [1:21:03<3:56:45, 189.41s/it, train=92.3%, val=91.0%]Training:  26%|â–ˆâ–ˆâ–Œ       | 26/100 [1:21:03<3:54:11, 189.89s/it, train=92.3%, val=91.0%]Training:  26%|â–ˆâ–ˆâ–Œ       | 26/100 [1:24:13<3:54:11, 189.89s/it, train=92.0%, val=91.6%]Training:  27%|â–ˆâ–ˆâ–‹       | 27/100 [1:24:13<3:51:01, 189.88s/it, train=92.0%, val=91.6%]Training:  27%|â–ˆâ–ˆâ–‹       | 27/100 [1:27:23<3:51:01, 189.88s/it, train=92.6%, val=90.7%]Training:  28%|â–ˆâ–ˆâ–Š       | 28/100 [1:27:23<3:47:53, 189.92s/it, train=92.6%, val=90.7%]Training:  28%|â–ˆâ–ˆâ–Š       | 28/100 [1:30:33<3:47:53, 189.92s/it, train=92.4%, val=91.3%]Training:  29%|â–ˆâ–ˆâ–‰       | 29/100 [1:30:33<3:44:55, 190.08s/it, train=92.4%, val=91.3%]Training:  29%|â–ˆâ–ˆâ–‰       | 29/100 [1:33:43<3:44:55, 190.08s/it, train=92.7%, val=91.8%]Training:  30%|â–ˆâ–ˆâ–ˆ       | 30/100 [1:33:43<3:41:36, 189.95s/it, train=92.7%, val=91.8%]Training:  30%|â–ˆâ–ˆâ–ˆ       | 30/100 [1:36:54<3:41:36, 189.95s/it, train=92.8%, val=91.6%]Training:  31%|â–ˆâ–ˆâ–ˆ       | 31/100 [1:36:54<3:38:47, 190.25s/it, train=92.8%, val=91.6%]Training:  31%|â–ˆâ–ˆâ–ˆ       | 31/100 [1:40:03<3:38:47, 190.25s/it, train=92.4%, val=91.0%]Training:  32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [1:40:03<3:35:20, 190.01s/it, train=92.4%, val=91.0%]Training:  32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [1:43:14<3:35:20, 190.01s/it, train=92.7%, val=90.5%]Training:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [1:43:14<3:32:37, 190.41s/it, train=92.7%, val=90.5%]Training:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [1:46:25<3:32:37, 190.41s/it, train=92.7%, val=91.7%]Training:  34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [1:46:25<3:29:25, 190.39s/it, train=92.7%, val=91.7%]Training:  34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [1:49:35<3:29:25, 190.39s/it, train=93.5%, val=91.3%]Training:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [1:49:35<3:26:14, 190.38s/it, train=93.5%, val=91.3%]Training:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [1:52:46<3:26:14, 190.38s/it, train=93.5%, val=91.4%]Training:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [1:52:46<3:23:18, 190.61s/it, train=93.5%, val=91.4%]Training:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [1:55:57<3:23:18, 190.61s/it, train=93.8%, val=91.6%]                                                                                       INFO:__main__:  Val: 91.9% | Traj: 92.5% | CN_AD: 92.6%
INFO:__main__:
--- Fold 4/5 ---
INFO:dataset:Filled 4 missing values in 'AGE' with 69.00
INFO:dataset:Filled 10 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 593 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 601 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 653 missing values in 'TRABSCOR' with 77.00
INFO:dataset:Filled 1013 missing values in 'DSPANFOR' with -4.00
INFO:dataset:Filled 1018 missing values in 'DSPANBAC' with -4.00
INFO:dataset:Filled 1005 missing values in 'BNTTOTAL' with -4.00
INFO:dataset:Filled 167 missing values in 'VSWEIGHT' with 167.00
INFO:dataset:Filled 1 missing values in 'BMI' with 28.30
INFO:dataset:Filled 289 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 287 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 287 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 287 missing values in 'MH2NEURL' with -4.00
INFO:dataset:Loaded 5155 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 4035 (78.3%)
INFO:dataset:  Class 1: 1120 (21.7%)
INFO:mri_vit_model:Created ViT3DClassifier with vit_base
INFO:mri_vit_model:  Image size: 128x128x128
INFO:mri_vit_model:  Patch size: 16
INFO:mri_vit_model:  Num patches: 512
INFO:mri_vit_model:  Embed dim: 768, Depth: 12, Heads: 12
INFO:mri_vit_model:Loading MAE pre-trained weights from ../mri_vit_ad/pretrained/vit_mae75_pretrained.pth
INFO:mri_vit_model:  Loaded pos_embed directly (shapes match: torch.Size([1, 513, 768]))
INFO:mri_vit_model:Loaded 150 pretrained weights (including pos_embed, cls_token, patch_embed if matched)
INFO:mri_vit_model:Missing keys: 2
INFO:mri_vit_model:  Missing: ['head.1.weight', 'head.1.bias']
/home/tanguy/medical/alzheimer/env/lib/python3.12/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
ViT backbone: 768-dim features
FT-Transformer tabular encoder: 16 -> 64
  Auxiliary losses: Enabled (MRI + Tabular classifiers)
MultiModalFusion initialized:
  MRI backbone: vit (768-dim)
  Tabular features: 16 -> 64
  Fusion method: cross_modal
  Fusion hidden: 512
Training:   0%|          | 0/100 [00:00<?, ?it/s]Training:   0%|          | 0/100 [03:06<?, ?it/s, train=75.3%, val=78.3%]Training:   1%|          | 1/100 [03:06<5:07:17, 186.24s/it, train=75.3%, val=78.3%]Training:   1%|          | 1/100 [06:17<5:07:17, 186.24s/it, train=80.3%, val=86.2%]Training:   2%|â–         | 2/100 [06:17<5:08:48, 189.07s/it, train=80.3%, val=86.2%]Training:   2%|â–         | 2/100 [09:20<5:08:48, 189.07s/it, train=86.4%, val=88.0%]Training:   3%|â–Ž         | 3/100 [09:20<5:01:27, 186.47s/it, train=86.4%, val=88.0%]Training:   3%|â–Ž         | 3/100 [12:25<5:01:27, 186.47s/it, train=87.0%, val=87.6%]Training:   4%|â–         | 4/100 [12:25<4:57:03, 185.67s/it, train=87.0%, val=87.6%]Training:   4%|â–         | 4/100 [15:29<4:57:03, 185.67s/it, train=87.2%, val=86.6%]Training:   5%|â–Œ         | 5/100 [15:29<4:53:04, 185.10s/it, train=87.2%, val=86.6%]Training:   5%|â–Œ         | 5/100 [18:35<4:53:04, 185.10s/it, train=87.0%, val=88.2%]Training:   6%|â–Œ         | 6/100 [18:35<4:50:32, 185.45s/it, train=87.0%, val=88.2%]Training:   6%|â–Œ         | 6/100 [21:45<4:50:32, 185.45s/it, train=87.2%, val=88.2%]Training:   7%|â–‹         | 7/100 [21:45<4:49:54, 187.04s/it, train=87.2%, val=88.2%]Training:   7%|â–‹         | 7/100 [24:55<4:49:54, 187.04s/it, train=87.5%, val=88.0%]Training:   8%|â–Š         | 8/100 [24:55<4:48:13, 187.97s/it, train=87.5%, val=88.0%]Training:   8%|â–Š         | 8/100 [28:06<4:48:13, 187.97s/it, train=88.3%, val=88.7%]Training:   9%|â–‰         | 9/100 [28:06<4:46:39, 189.00s/it, train=88.3%, val=88.7%]Training:   9%|â–‰         | 9/100 [31:11<4:46:39, 189.00s/it, train=87.5%, val=88.9%]Training:  10%|â–ˆ         | 10/100 [31:11<4:41:40, 187.79s/it, train=87.5%, val=88.9%]Training:  10%|â–ˆ         | 10/100 [34:22<4:41:40, 187.79s/it, train=87.8%, val=89.3%]Training:  11%|â–ˆ         | 11/100 [34:22<4:39:46, 188.62s/it, train=87.8%, val=89.3%]Training:  11%|â–ˆ         | 11/100 [37:28<4:39:46, 188.62s/it, train=88.4%, val=86.2%]Training:  12%|â–ˆâ–        | 12/100 [37:28<4:35:18, 187.72s/it, train=88.4%, val=86.2%]Training:  12%|â–ˆâ–        | 12/100 [40:32<4:35:18, 187.72s/it, train=88.3%, val=88.7%]Training:  13%|â–ˆâ–Ž        | 13/100 [40:32<4:30:48, 186.77s/it, train=88.3%, val=88.7%]Training:  13%|â–ˆâ–Ž        | 13/100 [43:36<4:30:48, 186.77s/it, train=87.9%, val=89.3%]Training:  14%|â–ˆâ–        | 14/100 [43:36<4:26:18, 185.80s/it, train=87.9%, val=89.3%]Training:  14%|â–ˆâ–        | 14/100 [46:41<4:26:18, 185.80s/it, train=88.1%, val=87.2%]Training:  15%|â–ˆâ–Œ        | 15/100 [46:41<4:23:02, 185.67s/it, train=88.1%, val=87.2%]Training:  15%|â–ˆâ–Œ        | 15/100 [49:45<4:23:02, 185.67s/it, train=88.4%, val=89.7%]Training:  16%|â–ˆâ–Œ        | 16/100 [49:45<4:19:20, 185.24s/it, train=88.4%, val=89.7%]Training:  16%|â–ˆâ–Œ        | 16/100 [52:57<4:19:20, 185.24s/it, train=88.4%, val=88.2%]Training:  17%|â–ˆâ–‹        | 17/100 [52:57<4:18:45, 187.06s/it, train=88.4%, val=88.2%]Training:  17%|â–ˆâ–‹        | 17/100 [56:07<4:18:45, 187.06s/it, train=89.0%, val=88.3%]Training:  18%|â–ˆâ–Š        | 18/100 [56:07<4:17:06, 188.13s/it, train=89.0%, val=88.3%]Training:  18%|â–ˆâ–Š        | 18/100 [59:18<4:17:06, 188.13s/it, train=88.7%, val=87.1%]Training:  19%|â–ˆâ–‰        | 19/100 [59:18<4:15:03, 188.93s/it, train=88.7%, val=87.1%]Training:  19%|â–ˆâ–‰        | 19/100 [1:02:28<4:15:03, 188.93s/it, train=89.1%, val=89.0%]Training:  20%|â–ˆâ–ˆ        | 20/100 [1:02:28<4:12:23, 189.30s/it, train=89.1%, val=89.0%]Training:  20%|â–ˆâ–ˆ        | 20/100 [1:05:38<4:12:23, 189.30s/it, train=89.3%, val=89.9%]Training:  21%|â–ˆâ–ˆ        | 21/100 [1:05:38<4:09:36, 189.57s/it, train=89.3%, val=89.9%]Training:  21%|â–ˆâ–ˆ        | 21/100 [1:08:44<4:09:36, 189.57s/it, train=88.9%, val=88.7%]Training:  22%|â–ˆâ–ˆâ–       | 22/100 [1:08:44<4:05:02, 188.50s/it, train=88.9%, val=88.7%]Training:  22%|â–ˆâ–ˆâ–       | 22/100 [1:11:49<4:05:02, 188.50s/it, train=89.5%, val=88.0%]Training:  23%|â–ˆâ–ˆâ–Ž       | 23/100 [1:11:49<4:00:34, 187.46s/it, train=89.5%, val=88.0%]Training:  23%|â–ˆâ–ˆâ–Ž       | 23/100 [1:14:54<4:00:34, 187.46s/it, train=89.4%, val=88.3%]Training:  24%|â–ˆâ–ˆâ–       | 24/100 [1:14:54<3:56:28, 186.69s/it, train=89.4%, val=88.3%]Training:  24%|â–ˆâ–ˆâ–       | 24/100 [1:17:58<3:56:28, 186.69s/it, train=89.5%, val=88.4%]Training:  25%|â–ˆâ–ˆâ–Œ       | 25/100 [1:17:58<3:52:07, 185.70s/it, train=89.5%, val=88.4%]Training:  25%|â–ˆâ–ˆâ–Œ       | 25/100 [1:21:02<3:52:07, 185.70s/it, train=89.0%, val=89.3%]Training:  26%|â–ˆâ–ˆâ–Œ       | 26/100 [1:21:02<3:48:25, 185.21s/it, train=89.0%, val=89.3%]Training:  26%|â–ˆâ–ˆâ–Œ       | 26/100 [1:24:06<3:48:25, 185.21s/it, train=89.0%, val=88.6%]Training:  27%|â–ˆâ–ˆâ–‹       | 27/100 [1:24:06<3:44:47, 184.76s/it, train=89.0%, val=88.6%]Training:  27%|â–ˆâ–ˆâ–‹       | 27/100 [1:27:10<3:44:47, 184.76s/it, train=89.7%, val=89.3%]Training:  28%|â–ˆâ–ˆâ–Š       | 28/100 [1:27:10<3:41:37, 184.69s/it, train=89.7%, val=89.3%]Training:  28%|â–ˆâ–ˆâ–Š       | 28/100 [1:30:14<3:41:37, 184.69s/it, train=89.7%, val=88.3%]Training:  29%|â–ˆâ–ˆâ–‰       | 29/100 [1:30:14<3:38:23, 184.55s/it, train=89.7%, val=88.3%]Training:  29%|â–ˆâ–ˆâ–‰       | 29/100 [1:33:18<3:38:23, 184.55s/it, train=89.8%, val=89.5%]Training:  30%|â–ˆâ–ˆâ–ˆ       | 30/100 [1:33:18<3:35:05, 184.36s/it, train=89.8%, val=89.5%]Training:  30%|â–ˆâ–ˆâ–ˆ       | 30/100 [1:36:23<3:35:05, 184.36s/it, train=89.6%, val=90.0%]Training:  31%|â–ˆâ–ˆâ–ˆ       | 31/100 [1:36:23<3:32:12, 184.52s/it, train=89.6%, val=90.0%]Training:  31%|â–ˆâ–ˆâ–ˆ       | 31/100 [1:39:33<3:32:12, 184.52s/it, train=90.0%, val=89.7%]Training:  32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [1:39:33<3:31:05, 186.26s/it, train=90.0%, val=89.7%]Training:  32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [1:42:39<3:31:05, 186.26s/it, train=89.9%, val=88.7%]Training:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [1:42:39<3:27:49, 186.12s/it, train=89.9%, val=88.7%]Training:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [1:45:44<3:27:49, 186.12s/it, train=89.8%, val=89.6%]Training:  34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [1:45:44<3:24:26, 185.86s/it, train=89.8%, val=89.6%]Training:  34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [1:48:51<3:24:26, 185.86s/it, train=89.8%, val=89.2%]Training:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [1:48:51<3:21:26, 185.95s/it, train=89.8%, val=89.2%]Training:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [1:51:57<3:21:26, 185.95s/it, train=90.0%, val=88.8%]Training:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [1:51:57<3:18:33, 186.14s/it, train=90.0%, val=88.8%]Training:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [1:55:01<3:18:33, 186.14s/it, train=90.0%, val=90.0%]Training:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [1:55:01<3:14:40, 185.41s/it, train=90.0%, val=90.0%]Training:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [1:58:06<3:14:40, 185.41s/it, train=90.3%, val=89.3%]Training:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [1:58:06<3:11:28, 185.30s/it, train=90.3%, val=89.3%]Training:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [2:01:12<3:11:28, 185.30s/it, train=90.2%, val=89.6%]Training:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [2:01:12<3:08:33, 185.47s/it, train=90.2%, val=89.6%]Training:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [2:04:18<3:08:33, 185.47s/it, train=90.3%, val=89.6%]Training:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [2:04:18<3:05:37, 185.63s/it, train=90.3%, val=89.6%]Training:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [2:07:23<3:05:37, 185.63s/it, train=90.5%, val=90.0%]Training:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [2:07:23<3:02:29, 185.58s/it, train=90.5%, val=90.0%]Training:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [2:10:28<3:02:29, 185.58s/it, train=90.4%, val=89.5%]Training:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [2:10:28<2:59:04, 185.26s/it, train=90.4%, val=89.5%]Training:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [2:13:34<2:59:04, 185.26s/it, train=90.6%, val=89.6%]Training:  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [2:13:34<2:56:14, 185.52s/it, train=90.6%, val=89.6%]Training:  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [2:16:39<2:56:14, 185.52s/it, train=90.5%, val=89.3%]Training:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [2:16:39<2:52:55, 185.27s/it, train=90.5%, val=89.3%]Training:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [2:19:43<2:52:55, 185.27s/it, train=90.6%, val=89.4%]Training:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [2:19:43<2:49:43, 185.15s/it, train=90.6%, val=89.4%]Training:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [2:22:48<2:49:43, 185.15s/it, train=91.2%, val=89.5%]                                                                                       INFO:__main__:  Val: 90.0% | Traj: 90.5% | CN_AD: 91.7%
INFO:__main__:
--- Fold 5/5 ---
INFO:dataset:Filled 4 missing values in 'AGE' with 69.00
INFO:dataset:Filled 10 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 593 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 601 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 653 missing values in 'TRABSCOR' with 77.00
INFO:dataset:Filled 1013 missing values in 'DSPANFOR' with -4.00
INFO:dataset:Filled 1018 missing values in 'DSPANBAC' with -4.00
INFO:dataset:Filled 1005 missing values in 'BNTTOTAL' with -4.00
INFO:dataset:Filled 167 missing values in 'VSWEIGHT' with 167.00
INFO:dataset:Filled 1 missing values in 'BMI' with 28.30
INFO:dataset:Filled 289 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 287 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 287 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 287 missing values in 'MH2NEURL' with -4.00
INFO:dataset:Loaded 5155 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 4035 (78.3%)
INFO:dataset:  Class 1: 1120 (21.7%)
INFO:mri_vit_model:Created ViT3DClassifier with vit_base
INFO:mri_vit_model:  Image size: 128x128x128
INFO:mri_vit_model:  Patch size: 16
INFO:mri_vit_model:  Num patches: 512
INFO:mri_vit_model:  Embed dim: 768, Depth: 12, Heads: 12
INFO:mri_vit_model:Loading MAE pre-trained weights from ../mri_vit_ad/pretrained/vit_mae75_pretrained.pth
INFO:mri_vit_model:  Loaded pos_embed directly (shapes match: torch.Size([1, 513, 768]))
INFO:mri_vit_model:Loaded 150 pretrained weights (including pos_embed, cls_token, patch_embed if matched)
INFO:mri_vit_model:Missing keys: 2
INFO:mri_vit_model:  Missing: ['head.1.weight', 'head.1.bias']
/home/tanguy/medical/alzheimer/env/lib/python3.12/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
ViT backbone: 768-dim features
FT-Transformer tabular encoder: 16 -> 64
  Auxiliary losses: Enabled (MRI + Tabular classifiers)
MultiModalFusion initialized:
  MRI backbone: vit (768-dim)
  Tabular features: 16 -> 64
  Fusion method: cross_modal
  Fusion hidden: 512
Training:   0%|          | 0/100 [00:00<?, ?it/s]Training:   0%|          | 0/100 [03:04<?, ?it/s, train=71.2%, val=78.3%]Training:   1%|          | 1/100 [03:04<5:03:51, 184.16s/it, train=71.2%, val=78.3%]Training:   1%|          | 1/100 [06:08<5:03:51, 184.16s/it, train=79.4%, val=86.3%]Training:   2%|â–         | 2/100 [06:08<5:01:04, 184.33s/it, train=79.4%, val=86.3%]Training:   2%|â–         | 2/100 [09:12<5:01:04, 184.33s/it, train=87.0%, val=87.4%]Training:   3%|â–Ž         | 3/100 [09:12<4:57:42, 184.15s/it, train=87.0%, val=87.4%]Training:   3%|â–Ž         | 3/100 [12:17<4:57:42, 184.15s/it, train=87.2%, val=87.7%]Training:   4%|â–         | 4/100 [12:17<4:55:20, 184.59s/it, train=87.2%, val=87.7%]Training:   4%|â–         | 4/100 [15:22<4:55:20, 184.59s/it, train=88.4%, val=86.7%]Training:   5%|â–Œ         | 5/100 [15:22<4:52:25, 184.69s/it, train=88.4%, val=86.7%]Training:   5%|â–Œ         | 5/100 [18:27<4:52:25, 184.69s/it, train=88.2%, val=89.2%]Training:   6%|â–Œ         | 6/100 [18:27<4:49:17, 184.65s/it, train=88.2%, val=89.2%]Training:   6%|â–Œ         | 6/100 [21:32<4:49:17, 184.65s/it, train=88.9%, val=89.7%]Training:   7%|â–‹         | 7/100 [21:32<4:46:22, 184.75s/it, train=88.9%, val=89.7%]Training:   7%|â–‹         | 7/100 [24:41<4:46:22, 184.75s/it, train=90.1%, val=89.3%]Training:   8%|â–Š         | 8/100 [24:41<4:45:29, 186.19s/it, train=90.1%, val=89.3%]Training:   8%|â–Š         | 8/100 [27:46<4:45:29, 186.19s/it, train=90.5%, val=90.3%]Training:   9%|â–‰         | 9/100 [27:46<4:42:01, 185.95s/it, train=90.5%, val=90.3%]Training:   9%|â–‰         | 9/100 [30:58<4:42:01, 185.95s/it, train=90.9%, val=90.9%]Training:  10%|â–ˆ         | 10/100 [30:58<4:41:27, 187.64s/it, train=90.9%, val=90.9%]Training:  10%|â–ˆ         | 10/100 [34:00<4:41:27, 187.64s/it, train=91.1%, val=90.7%]Training:  11%|â–ˆ         | 11/100 [34:00<4:35:58, 186.05s/it, train=91.1%, val=90.7%]Training:  11%|â–ˆ         | 11/100 [37:05<4:35:58, 186.05s/it, train=91.9%, val=91.1%]Training:  12%|â–ˆâ–        | 12/100 [37:05<4:32:22, 185.70s/it, train=91.9%, val=91.1%]Training:  12%|â–ˆâ–        | 12/100 [40:12<4:32:22, 185.70s/it, train=92.3%, val=90.8%]Training:  13%|â–ˆâ–Ž        | 13/100 [40:12<4:29:45, 186.04s/it, train=92.3%, val=90.8%]Training:  13%|â–ˆâ–Ž        | 13/100 [43:18<4:29:45, 186.04s/it, train=92.5%, val=91.8%]Training:  14%|â–ˆâ–        | 14/100 [43:18<4:26:40, 186.05s/it, train=92.5%, val=91.8%]Training:  14%|â–ˆâ–        | 14/100 [46:23<4:26:40, 186.05s/it, train=92.8%, val=91.1%]Training:  15%|â–ˆâ–Œ        | 15/100 [46:23<4:23:06, 185.73s/it, train=92.8%, val=91.1%]Training:  15%|â–ˆâ–Œ        | 15/100 [49:29<4:23:06, 185.73s/it, train=92.8%, val=90.6%]Training:  16%|â–ˆâ–Œ        | 16/100 [49:29<4:19:59, 185.71s/it, train=92.8%, val=90.6%]Training:  16%|â–ˆâ–Œ        | 16/100 [52:32<4:19:59, 185.71s/it, train=93.2%, val=89.0%]Training:  17%|â–ˆâ–‹        | 17/100 [52:32<4:16:02, 185.09s/it, train=93.2%, val=89.0%]Training:  17%|â–ˆâ–‹        | 17/100 [55:39<4:16:02, 185.09s/it, train=92.9%, val=91.6%]Training:  18%|â–ˆâ–Š        | 18/100 [55:39<4:13:33, 185.53s/it, train=92.9%, val=91.6%]Training:  18%|â–ˆâ–Š        | 18/100 [58:44<4:13:33, 185.53s/it, train=93.4%, val=91.5%]Training:  19%|â–ˆâ–‰        | 19/100 [58:44<4:10:19, 185.42s/it, train=93.4%, val=91.5%]Training:  19%|â–ˆâ–‰        | 19/100 [1:01:48<4:10:19, 185.42s/it, train=93.3%, val=92.0%]Training:  20%|â–ˆâ–ˆ        | 20/100 [1:01:48<4:06:37, 184.96s/it, train=93.3%, val=92.0%]Training:  20%|â–ˆâ–ˆ        | 20/100 [1:05:06<4:06:37, 184.96s/it, train=94.0%, val=91.9%]Training:  21%|â–ˆâ–ˆ        | 21/100 [1:05:06<4:08:46, 188.94s/it, train=94.0%, val=91.9%]Training:  21%|â–ˆâ–ˆ        | 21/100 [1:08:17<4:08:46, 188.94s/it, train=93.6%, val=91.7%]Training:  22%|â–ˆâ–ˆâ–       | 22/100 [1:08:17<4:06:19, 189.48s/it, train=93.6%, val=91.7%]Training:  22%|â–ˆâ–ˆâ–       | 22/100 [1:11:27<4:06:19, 189.48s/it, train=94.5%, val=91.9%]Training:  23%|â–ˆâ–ˆâ–Ž       | 23/100 [1:11:27<4:03:18, 189.59s/it, train=94.5%, val=91.9%]Training:  23%|â–ˆâ–ˆâ–Ž       | 23/100 [1:14:39<4:03:18, 189.59s/it, train=93.9%, val=92.4%]Training:  24%|â–ˆâ–ˆâ–       | 24/100 [1:14:39<4:01:01, 190.28s/it, train=93.9%, val=92.4%]Training:  24%|â–ˆâ–ˆâ–       | 24/100 [1:17:45<4:01:01, 190.28s/it, train=94.6%, val=92.2%]Training:  25%|â–ˆâ–ˆâ–Œ       | 25/100 [1:17:45<3:56:16, 189.02s/it, train=94.6%, val=92.2%]Training:  25%|â–ˆâ–ˆâ–Œ       | 25/100 [1:20:51<3:56:16, 189.02s/it, train=94.3%, val=92.6%]Training:  26%|â–ˆâ–ˆâ–Œ       | 26/100 [1:20:51<3:51:59, 188.10s/it, train=94.3%, val=92.6%]Training:  26%|â–ˆâ–ˆâ–Œ       | 26/100 [1:24:10<3:51:59, 188.10s/it, train=94.9%, val=92.5%]Training:  27%|â–ˆâ–ˆâ–‹       | 27/100 [1:24:10<3:52:46, 191.32s/it, train=94.9%, val=92.5%]Training:  27%|â–ˆâ–ˆâ–‹       | 27/100 [1:27:22<3:52:46, 191.32s/it, train=94.7%, val=92.1%]Training:  28%|â–ˆâ–ˆâ–Š       | 28/100 [1:27:22<3:49:53, 191.57s/it, train=94.7%, val=92.1%]Training:  28%|â–ˆâ–ˆâ–Š       | 28/100 [1:30:33<3:49:53, 191.57s/it, train=94.3%, val=92.6%]Training:  29%|â–ˆâ–ˆâ–‰       | 29/100 [1:30:33<3:46:43, 191.59s/it, train=94.3%, val=92.6%]Training:  29%|â–ˆâ–ˆâ–‰       | 29/100 [1:33:44<3:46:43, 191.59s/it, train=94.9%, val=92.5%]Training:  30%|â–ˆâ–ˆâ–ˆ       | 30/100 [1:33:44<3:43:16, 191.37s/it, train=94.9%, val=92.5%]Training:  30%|â–ˆâ–ˆâ–ˆ       | 30/100 [1:36:56<3:43:16, 191.37s/it, train=95.3%, val=91.9%]Training:  31%|â–ˆâ–ˆâ–ˆ       | 31/100 [1:36:56<3:40:05, 191.39s/it, train=95.3%, val=91.9%]Training:  31%|â–ˆâ–ˆâ–ˆ       | 31/100 [1:40:06<3:40:05, 191.39s/it, train=94.8%, val=89.1%]Training:  32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [1:40:06<3:36:24, 190.94s/it, train=94.8%, val=89.1%]Training:  32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [1:43:16<3:36:24, 190.94s/it, train=94.7%, val=92.5%]Training:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [1:43:16<3:33:13, 190.95s/it, train=94.7%, val=92.5%]Training:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [1:46:28<3:33:13, 190.95s/it, train=95.5%, val=92.7%]Training:  34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [1:46:28<3:30:17, 191.17s/it, train=95.5%, val=92.7%]Training:  34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [1:49:40<3:30:17, 191.17s/it, train=95.5%, val=92.3%]Training:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [1:49:40<3:27:21, 191.40s/it, train=95.5%, val=92.3%]Training:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [1:52:49<3:27:21, 191.40s/it, train=96.1%, val=92.7%]Training:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [1:52:49<3:23:28, 190.75s/it, train=96.1%, val=92.7%]Training:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [1:56:00<3:23:28, 190.75s/it, train=95.5%, val=92.9%]Training:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [1:56:00<3:20:08, 190.62s/it, train=95.5%, val=92.9%]Training:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [1:59:10<3:20:08, 190.62s/it, train=95.8%, val=92.7%]Training:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [1:59:10<3:16:54, 190.56s/it, train=95.8%, val=92.7%]Training:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [2:02:23<3:16:54, 190.56s/it, train=96.3%, val=92.5%]Training:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [2:02:23<3:14:19, 191.14s/it, train=96.3%, val=92.5%]Training:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [2:05:34<3:14:19, 191.14s/it, train=96.2%, val=93.2%]Training:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [2:05:35<3:11:23, 191.39s/it, train=96.2%, val=93.2%]Training:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [2:08:45<3:11:23, 191.39s/it, train=96.7%, val=92.5%]Training:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [2:08:45<3:07:55, 191.12s/it, train=96.7%, val=92.5%]Training:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [2:11:56<3:07:55, 191.12s/it, train=96.9%, val=91.4%]Training:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [2:11:56<3:04:34, 190.94s/it, train=96.9%, val=91.4%]Training:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [2:15:08<3:04:34, 190.94s/it, train=96.5%, val=92.4%]Training:  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [2:15:08<3:01:46, 191.34s/it, train=96.5%, val=92.4%]Training:  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [2:18:17<3:01:46, 191.34s/it, train=97.0%, val=91.6%]Training:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [2:18:17<2:58:03, 190.77s/it, train=97.0%, val=91.6%]Training:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [2:21:28<2:58:03, 190.77s/it, train=97.3%, val=92.4%]Training:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [2:21:28<2:54:51, 190.76s/it, train=97.3%, val=92.4%]Training:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [2:24:38<2:54:51, 190.76s/it, train=96.8%, val=92.1%]Training:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [2:24:38<2:51:21, 190.39s/it, train=96.8%, val=92.1%]Training:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [2:27:49<2:51:21, 190.39s/it, train=97.1%, val=91.9%]Training:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [2:27:49<2:48:31, 190.79s/it, train=97.1%, val=91.9%]Training:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [2:30:58<2:48:31, 190.79s/it, train=97.6%, val=92.1%]Training:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [2:30:58<2:44:52, 190.24s/it, train=97.6%, val=92.1%]Training:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [2:34:07<2:44:52, 190.24s/it, train=97.9%, val=92.1%]Training:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [2:34:07<2:41:21, 189.84s/it, train=97.9%, val=92.1%]Training:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [2:37:18<2:41:21, 189.84s/it, train=97.6%, val=92.0%]Training:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [2:37:18<2:38:26, 190.12s/it, train=97.6%, val=92.0%]Training:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [2:40:27<2:38:26, 190.12s/it, train=98.0%, val=92.3%]Training:  51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [2:40:27<2:35:04, 189.90s/it, train=98.0%, val=92.3%]Training:  51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [2:43:38<2:35:04, 189.90s/it, train=98.1%, val=92.3%]Training:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [2:43:38<2:32:01, 190.04s/it, train=98.1%, val=92.3%]Training:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [2:46:49<2:32:01, 190.04s/it, train=98.0%, val=91.7%]Training:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [2:46:49<2:29:06, 190.35s/it, train=98.0%, val=91.7%]Training:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [2:50:02<2:29:06, 190.35s/it, train=98.2%, val=91.7%]Training:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [2:50:02<2:26:30, 191.10s/it, train=98.2%, val=91.7%]Training:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [2:53:12<2:26:30, 191.10s/it, train=98.1%, val=91.1%]                                                                                       INFO:__main__:  Val: 93.2% | Traj: 93.1% | CN_AD: 97.4%
INFO:__main__:
============================================================
INFO:__main__:SEED 123
INFO:__main__:============================================================
INFO:dataset:Filled 4 missing values in 'AGE' with 69.00
INFO:dataset:Filled 10 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 593 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 601 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 653 missing values in 'TRABSCOR' with 77.00
INFO:dataset:Filled 1013 missing values in 'DSPANFOR' with -4.00
INFO:dataset:Filled 1018 missing values in 'DSPANBAC' with -4.00
INFO:dataset:Filled 1005 missing values in 'BNTTOTAL' with -4.00
INFO:dataset:Filled 167 missing values in 'VSWEIGHT' with 167.00
INFO:dataset:Filled 1 missing values in 'BMI' with 28.30
INFO:dataset:Filled 289 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 287 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 287 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 287 missing values in 'MH2NEURL' with -4.00
INFO:dataset:Loaded 5155 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 4035 (78.3%)
INFO:dataset:  Class 1: 1120 (21.7%)
INFO:dataset:Filled 6 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 91 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 92 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 100 missing values in 'TRABSCOR' with 78.00
INFO:dataset:Filled 184 missing values in 'DSPANFOR' with -4.00
INFO:dataset:Filled 184 missing values in 'DSPANBAC' with -4.00
INFO:dataset:Filled 179 missing values in 'BNTTOTAL' with -4.00
INFO:dataset:Filled 33 missing values in 'VSWEIGHT' with 164.00
INFO:dataset:Filled 2 missing values in 'BMI' with 28.20
INFO:dataset:Filled 60 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 60 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 60 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 60 missing values in 'MH2NEURL' with -4.00
INFO:dataset:Loaded 910 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 712 (78.2%)
INFO:dataset:  Class 1: 198 (21.8%)
INFO:dataset:Filled 1 missing values in 'AGE' with 69.00
INFO:dataset:Filled 4 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 88 missing values in 'CATANIMSC' with 21.00
INFO:dataset:Filled 90 missing values in 'TRAASCOR' with 30.00
INFO:dataset:Filled 101 missing values in 'TRABSCOR' with 75.00
INFO:dataset:Filled 162 missing values in 'DSPANFOR' with -4.00
INFO:dataset:Filled 164 missing values in 'DSPANBAC' with -4.00
INFO:dataset:Filled 161 missing values in 'BNTTOTAL' with -4.00
INFO:dataset:Filled 34 missing values in 'VSWEIGHT' with 163.00
INFO:dataset:Filled 2 missing values in 'BMI' with 27.55
INFO:dataset:Filled 51 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 51 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 51 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 51 missing values in 'MH2NEURL' with -4.00
INFO:dataset:Loaded 856 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 718 (83.9%)
INFO:dataset:  Class 1: 138 (16.1%)
INFO:__main__:
--- Fold 1/5 ---
INFO:dataset:Filled 4 missing values in 'AGE' with 69.00
INFO:dataset:Filled 10 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 593 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 601 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 653 missing values in 'TRABSCOR' with 77.00
INFO:dataset:Filled 1013 missing values in 'DSPANFOR' with -4.00
INFO:dataset:Filled 1018 missing values in 'DSPANBAC' with -4.00
INFO:dataset:Filled 1005 missing values in 'BNTTOTAL' with -4.00
INFO:dataset:Filled 167 missing values in 'VSWEIGHT' with 167.00
INFO:dataset:Filled 1 missing values in 'BMI' with 28.30
INFO:dataset:Filled 289 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 287 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 287 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 287 missing values in 'MH2NEURL' with -4.00
INFO:dataset:Loaded 5155 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 4035 (78.3%)
INFO:dataset:  Class 1: 1120 (21.7%)
INFO:mri_vit_model:Created ViT3DClassifier with vit_base
INFO:mri_vit_model:  Image size: 128x128x128
INFO:mri_vit_model:  Patch size: 16
INFO:mri_vit_model:  Num patches: 512
INFO:mri_vit_model:  Embed dim: 768, Depth: 12, Heads: 12
INFO:mri_vit_model:Loading MAE pre-trained weights from ../mri_vit_ad/pretrained/vit_mae75_pretrained.pth
INFO:mri_vit_model:  Loaded pos_embed directly (shapes match: torch.Size([1, 513, 768]))
INFO:mri_vit_model:Loaded 150 pretrained weights (including pos_embed, cls_token, patch_embed if matched)
INFO:mri_vit_model:Missing keys: 2
INFO:mri_vit_model:  Missing: ['head.1.weight', 'head.1.bias']
/home/tanguy/medical/alzheimer/env/lib/python3.12/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
ViT backbone: 768-dim features
FT-Transformer tabular encoder: 16 -> 64
  Auxiliary losses: Enabled (MRI + Tabular classifiers)
MultiModalFusion initialized:
  MRI backbone: vit (768-dim)
  Tabular features: 16 -> 64
  Fusion method: cross_modal
  Fusion hidden: 512
Training:   0%|          | 0/100 [00:00<?, ?it/s]Training:   0%|          | 0/100 [03:06<?, ?it/s, train=72.9%, val=78.3%]Training:   1%|          | 1/100 [03:06<5:08:17, 186.84s/it, train=72.9%, val=78.3%]Training:   1%|          | 1/100 [06:11<5:08:17, 186.84s/it, train=77.8%, val=85.7%]Training:   2%|â–         | 2/100 [06:11<5:02:51, 185.42s/it, train=77.8%, val=85.7%]Training:   2%|â–         | 2/100 [09:15<5:02:51, 185.42s/it, train=85.8%, val=86.4%]Training:   3%|â–Ž         | 3/100 [09:16<4:59:19, 185.15s/it, train=85.8%, val=86.4%]