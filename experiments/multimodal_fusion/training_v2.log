nohup: les entrÃ©es sont ignorÃ©es
[0;93m2026-01-13 22:40:39.720250620 [W:onnxruntime:Default, device_discovery.cc:164 DiscoverDevicesForPlatform] GPU device discovery failed: device_discovery.cc:89 ReadFileContents Failed to open file: "/sys/class/drm/card0/device/vendor"[m
INFO:__main__:Device: cuda
INFO:__main__:Combined train+val: 5155 samples
INFO:__main__:
============================================================
INFO:__main__:SEED 42
INFO:__main__:============================================================
INFO:dataset:Filled 4 missing values in 'AGE' with 69.00
INFO:dataset:Filled 10 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 593 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 601 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 653 missing values in 'TRABSCOR' with 77.00
INFO:dataset:Filled 1013 missing values in 'DSPANFOR' with -4.00
INFO:dataset:Filled 1018 missing values in 'DSPANBAC' with -4.00
INFO:dataset:Filled 1005 missing values in 'BNTTOTAL' with -4.00
INFO:dataset:Filled 167 missing values in 'VSWEIGHT' with 167.00
INFO:dataset:Filled 1 missing values in 'BMI' with 28.30
INFO:dataset:Filled 289 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 287 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 287 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 287 missing values in 'MH2NEURL' with -4.00
INFO:dataset:Loaded 5155 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 4035 (78.3%)
INFO:dataset:  Class 1: 1120 (21.7%)
INFO:dataset:Filled 6 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 91 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 92 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 100 missing values in 'TRABSCOR' with 78.00
INFO:dataset:Filled 184 missing values in 'DSPANFOR' with -4.00
INFO:dataset:Filled 184 missing values in 'DSPANBAC' with -4.00
INFO:dataset:Filled 179 missing values in 'BNTTOTAL' with -4.00
INFO:dataset:Filled 33 missing values in 'VSWEIGHT' with 164.00
INFO:dataset:Filled 2 missing values in 'BMI' with 28.20
INFO:dataset:Filled 60 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 60 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 60 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 60 missing values in 'MH2NEURL' with -4.00
INFO:dataset:Loaded 910 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 712 (78.2%)
INFO:dataset:  Class 1: 198 (21.8%)
INFO:dataset:Filled 1 missing values in 'AGE' with 69.00
INFO:dataset:Filled 4 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 88 missing values in 'CATANIMSC' with 21.00
INFO:dataset:Filled 90 missing values in 'TRAASCOR' with 30.00
INFO:dataset:Filled 101 missing values in 'TRABSCOR' with 75.00
INFO:dataset:Filled 162 missing values in 'DSPANFOR' with -4.00
INFO:dataset:Filled 164 missing values in 'DSPANBAC' with -4.00
INFO:dataset:Filled 161 missing values in 'BNTTOTAL' with -4.00
INFO:dataset:Filled 34 missing values in 'VSWEIGHT' with 163.00
INFO:dataset:Filled 2 missing values in 'BMI' with 27.55
INFO:dataset:Filled 51 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 51 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 51 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 51 missing values in 'MH2NEURL' with -4.00
INFO:dataset:Loaded 856 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 718 (83.9%)
INFO:dataset:  Class 1: 138 (16.1%)
INFO:__main__:
--- Fold 1/5 ---
INFO:dataset:Filled 4 missing values in 'AGE' with 69.00
INFO:dataset:Filled 10 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 593 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 601 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 653 missing values in 'TRABSCOR' with 77.00
INFO:dataset:Filled 1013 missing values in 'DSPANFOR' with -4.00
INFO:dataset:Filled 1018 missing values in 'DSPANBAC' with -4.00
INFO:dataset:Filled 1005 missing values in 'BNTTOTAL' with -4.00
INFO:dataset:Filled 167 missing values in 'VSWEIGHT' with 167.00
INFO:dataset:Filled 1 missing values in 'BMI' with 28.30
INFO:dataset:Filled 289 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 287 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 287 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 287 missing values in 'MH2NEURL' with -4.00
INFO:dataset:Loaded 5155 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 4035 (78.3%)
INFO:dataset:  Class 1: 1120 (21.7%)
INFO:mri_vit_model:Created ViT3DClassifier with vit_base
INFO:mri_vit_model:  Image size: 128x128x128
INFO:mri_vit_model:  Patch size: 16
INFO:mri_vit_model:  Num patches: 512
INFO:mri_vit_model:  Embed dim: 768, Depth: 12, Heads: 12
INFO:mri_vit_model:Loading MAE pre-trained weights from ../mri_vit_ad/pretrained/vit_mae75_pretrained.pth
INFO:mri_vit_model:  Loaded pos_embed directly (shapes match: torch.Size([1, 513, 768]))
INFO:mri_vit_model:Loaded 150 pretrained weights (including pos_embed, cls_token, patch_embed if matched)
INFO:mri_vit_model:Missing keys: 2
INFO:mri_vit_model:  Missing: ['head.1.weight', 'head.1.bias']
/home/tanguy/medical/alzheimer/env/lib/python3.12/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
ViT backbone: 768-dim features
FT-Transformer tabular encoder: 16 -> 64
  Auxiliary losses: Enabled (MRI + Tabular classifiers)
MultiModalFusion initialized:
  MRI backbone: vit (768-dim)
  Tabular features: 16 -> 64
  Fusion method: cross_modal
  Fusion hidden: 512
Training:   0%|          | 0/100 [00:00<?, ?it/s]Training:   0%|          | 0/100 [03:03<?, ?it/s, train=60.6%, val_bal=50.2%]Training:   1%|          | 1/100 [03:03<5:02:35, 183.39s/it, train=60.6%, val_bal=50.2%]Training:   1%|          | 1/100 [06:28<5:02:35, 183.39s/it, train=79.9%, val_bal=76.5%]Training:   2%|â–         | 2/100 [06:28<5:20:33, 196.26s/it, train=79.9%, val_bal=76.5%]Training:   2%|â–         | 2/100 [09:32<5:20:33, 196.26s/it, train=87.3%, val_bal=78.0%]Training:   3%|â–Ž         | 3/100 [09:32<5:08:25, 190.77s/it, train=87.3%, val_bal=78.0%]Training:   3%|â–Ž         | 3/100 [12:37<5:08:25, 190.77s/it, train=88.2%, val_bal=77.0%]Training:   4%|â–         | 4/100 [12:37<5:01:37, 188.51s/it, train=88.2%, val_bal=77.0%]Training:   4%|â–         | 4/100 [15:42<5:01:37, 188.51s/it, train=88.5%, val_bal=76.6%]Training:   5%|â–Œ         | 5/100 [15:42<4:56:13, 187.09s/it, train=88.5%, val_bal=76.6%]Training:   5%|â–Œ         | 5/100 [18:48<4:56:13, 187.09s/it, train=88.2%, val_bal=81.0%]Training:   6%|â–Œ         | 6/100 [18:48<4:52:35, 186.76s/it, train=88.2%, val_bal=81.0%]Training:   6%|â–Œ         | 6/100 [21:53<4:52:35, 186.76s/it, train=87.6%, val_bal=78.8%]Training:   7%|â–‹         | 7/100 [21:53<4:48:34, 186.18s/it, train=87.6%, val_bal=78.8%]Training:   7%|â–‹         | 7/100 [24:58<4:48:34, 186.18s/it, train=88.0%, val_bal=73.9%]Training:   8%|â–Š         | 8/100 [24:58<4:44:37, 185.62s/it, train=88.0%, val_bal=73.9%]Training:   8%|â–Š         | 8/100 [28:02<4:44:37, 185.62s/it, train=88.3%, val_bal=79.5%]Training:   9%|â–‰         | 9/100 [28:02<4:41:03, 185.31s/it, train=88.3%, val_bal=79.5%]Training:   9%|â–‰         | 9/100 [31:08<4:41:03, 185.31s/it, train=88.1%, val_bal=74.1%]Training:  10%|â–ˆ         | 10/100 [31:08<4:37:59, 185.33s/it, train=88.1%, val_bal=74.1%]Training:  10%|â–ˆ         | 10/100 [34:13<4:37:59, 185.33s/it, train=88.2%, val_bal=81.6%]Training:  11%|â–ˆ         | 11/100 [34:13<4:34:48, 185.26s/it, train=88.2%, val_bal=81.6%]Training:  11%|â–ˆ         | 11/100 [37:18<4:34:48, 185.26s/it, train=88.4%, val_bal=77.8%]Training:  12%|â–ˆâ–        | 12/100 [37:18<4:31:37, 185.20s/it, train=88.4%, val_bal=77.8%]Training:  12%|â–ˆâ–        | 12/100 [40:23<4:31:37, 185.20s/it, train=88.6%, val_bal=74.0%]Training:  13%|â–ˆâ–Ž        | 13/100 [40:23<4:28:35, 185.24s/it, train=88.6%, val_bal=74.0%]Training:  13%|â–ˆâ–Ž        | 13/100 [43:29<4:28:35, 185.24s/it, train=88.9%, val_bal=84.2%]Training:  14%|â–ˆâ–        | 14/100 [43:29<4:26:00, 185.59s/it, train=88.9%, val_bal=84.2%]Training:  14%|â–ˆâ–        | 14/100 [46:39<4:26:00, 185.59s/it, train=88.6%, val_bal=79.8%]Training:  15%|â–ˆâ–Œ        | 15/100 [46:39<4:24:29, 186.70s/it, train=88.6%, val_bal=79.8%]Training:  15%|â–ˆâ–Œ        | 15/100 [49:49<4:24:29, 186.70s/it, train=88.3%, val_bal=76.9%]Training:  16%|â–ˆâ–Œ        | 16/100 [49:49<4:22:57, 187.82s/it, train=88.3%, val_bal=76.9%]Training:  16%|â–ˆâ–Œ        | 16/100 [53:00<4:22:57, 187.82s/it, train=88.7%, val_bal=79.6%]Training:  17%|â–ˆâ–‹        | 17/100 [53:00<4:21:03, 188.72s/it, train=88.7%, val_bal=79.6%]Training:  17%|â–ˆâ–‹        | 17/100 [56:12<4:21:03, 188.72s/it, train=88.6%, val_bal=81.0%]Training:  18%|â–ˆâ–Š        | 18/100 [56:12<4:19:14, 189.68s/it, train=88.6%, val_bal=81.0%]Training:  18%|â–ˆâ–Š        | 18/100 [59:23<4:19:14, 189.68s/it, train=89.2%, val_bal=80.1%]Training:  19%|â–ˆâ–‰        | 19/100 [59:23<4:16:45, 190.19s/it, train=89.2%, val_bal=80.1%]Training:  19%|â–ˆâ–‰        | 19/100 [1:02:35<4:16:45, 190.19s/it, train=89.3%, val_bal=75.5%]Training:  20%|â–ˆâ–ˆ        | 20/100 [1:02:35<4:14:03, 190.55s/it, train=89.3%, val_bal=75.5%]Training:  20%|â–ˆâ–ˆ        | 20/100 [1:05:46<4:14:03, 190.55s/it, train=89.2%, val_bal=82.3%]Training:  21%|â–ˆâ–ˆ        | 21/100 [1:05:46<4:11:05, 190.71s/it, train=89.2%, val_bal=82.3%]Training:  21%|â–ˆâ–ˆ        | 21/100 [1:08:58<4:11:05, 190.71s/it, train=89.5%, val_bal=77.3%]Training:  22%|â–ˆâ–ˆâ–       | 22/100 [1:08:58<4:08:30, 191.16s/it, train=89.5%, val_bal=77.3%]Training:  22%|â–ˆâ–ˆâ–       | 22/100 [1:12:09<4:08:30, 191.16s/it, train=89.1%, val_bal=81.1%]Training:  23%|â–ˆâ–ˆâ–Ž       | 23/100 [1:12:09<4:05:18, 191.15s/it, train=89.1%, val_bal=81.1%]Training:  23%|â–ˆâ–ˆâ–Ž       | 23/100 [1:15:20<4:05:18, 191.15s/it, train=89.6%, val_bal=80.5%]Training:  24%|â–ˆâ–ˆâ–       | 24/100 [1:15:20<4:02:11, 191.21s/it, train=89.6%, val_bal=80.5%]Training:  24%|â–ˆâ–ˆâ–       | 24/100 [1:18:32<4:02:11, 191.21s/it, train=89.3%, val_bal=81.0%]Training:  25%|â–ˆâ–ˆâ–Œ       | 25/100 [1:18:32<3:59:09, 191.33s/it, train=89.3%, val_bal=81.0%]Training:  25%|â–ˆâ–ˆâ–Œ       | 25/100 [1:21:44<3:59:09, 191.33s/it, train=89.7%, val_bal=79.7%]Training:  26%|â–ˆâ–ˆâ–Œ       | 26/100 [1:21:44<3:56:10, 191.50s/it, train=89.7%, val_bal=79.7%]Training:  26%|â–ˆâ–ˆâ–Œ       | 26/100 [1:24:55<3:56:10, 191.50s/it, train=89.6%, val_bal=78.8%]Training:  27%|â–ˆâ–ˆâ–‹       | 27/100 [1:24:55<3:52:49, 191.36s/it, train=89.6%, val_bal=78.8%]Training:  27%|â–ˆâ–ˆâ–‹       | 27/100 [1:28:05<3:52:49, 191.36s/it, train=89.7%, val_bal=79.9%]Training:  28%|â–ˆâ–ˆâ–Š       | 28/100 [1:28:05<3:49:01, 190.85s/it, train=89.7%, val_bal=79.9%]Training:  28%|â–ˆâ–ˆâ–Š       | 28/100 [1:31:16<3:49:01, 190.85s/it, train=89.6%, val_bal=80.8%]Training:  29%|â–ˆâ–ˆâ–‰       | 29/100 [1:31:16<3:46:03, 191.03s/it, train=89.6%, val_bal=80.8%]Training:  29%|â–ˆâ–ˆâ–‰       | 29/100 [1:34:27<3:46:03, 191.03s/it, train=90.0%, val_bal=77.7%]Training:  30%|â–ˆâ–ˆâ–ˆ       | 30/100 [1:34:27<3:42:55, 191.08s/it, train=90.0%, val_bal=77.7%]Training:  30%|â–ˆâ–ˆâ–ˆ       | 30/100 [1:37:38<3:42:55, 191.08s/it, train=90.4%, val_bal=80.0%]Training:  31%|â–ˆâ–ˆâ–ˆ       | 31/100 [1:37:38<3:39:38, 191.00s/it, train=90.4%, val_bal=80.0%]Training:  31%|â–ˆâ–ˆâ–ˆ       | 31/100 [1:40:50<3:39:38, 191.00s/it, train=90.3%, val_bal=80.9%]Training:  32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [1:40:50<3:36:41, 191.20s/it, train=90.3%, val_bal=80.9%]Training:  32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [1:44:01<3:36:41, 191.20s/it, train=90.0%, val_bal=79.5%]Training:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [1:44:01<3:33:32, 191.23s/it, train=90.0%, val_bal=79.5%]Training:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [1:47:13<3:33:32, 191.23s/it, train=89.9%, val_bal=79.5%]                                                                                           INFO:__main__:  Val(bal): 84.2% | Traj: 83.9% | CN_AD: 83.3%
INFO:__main__:
--- Fold 2/5 ---
INFO:dataset:Filled 4 missing values in 'AGE' with 69.00
INFO:dataset:Filled 10 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 593 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 601 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 653 missing values in 'TRABSCOR' with 77.00
INFO:dataset:Filled 1013 missing values in 'DSPANFOR' with -4.00
INFO:dataset:Filled 1018 missing values in 'DSPANBAC' with -4.00
INFO:dataset:Filled 1005 missing values in 'BNTTOTAL' with -4.00
INFO:dataset:Filled 167 missing values in 'VSWEIGHT' with 167.00
INFO:dataset:Filled 1 missing values in 'BMI' with 28.30
INFO:dataset:Filled 289 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 287 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 287 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 287 missing values in 'MH2NEURL' with -4.00
INFO:dataset:Loaded 5155 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 4035 (78.3%)
INFO:dataset:  Class 1: 1120 (21.7%)
INFO:mri_vit_model:Created ViT3DClassifier with vit_base
INFO:mri_vit_model:  Image size: 128x128x128
INFO:mri_vit_model:  Patch size: 16
INFO:mri_vit_model:  Num patches: 512
INFO:mri_vit_model:  Embed dim: 768, Depth: 12, Heads: 12
INFO:mri_vit_model:Loading MAE pre-trained weights from ../mri_vit_ad/pretrained/vit_mae75_pretrained.pth
INFO:mri_vit_model:  Loaded pos_embed directly (shapes match: torch.Size([1, 513, 768]))
INFO:mri_vit_model:Loaded 150 pretrained weights (including pos_embed, cls_token, patch_embed if matched)
INFO:mri_vit_model:Missing keys: 2
INFO:mri_vit_model:  Missing: ['head.1.weight', 'head.1.bias']
/home/tanguy/medical/alzheimer/env/lib/python3.12/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
ViT backbone: 768-dim features
FT-Transformer tabular encoder: 16 -> 64
  Auxiliary losses: Enabled (MRI + Tabular classifiers)
MultiModalFusion initialized:
  MRI backbone: vit (768-dim)
  Tabular features: 16 -> 64
  Fusion method: cross_modal
  Fusion hidden: 512
Training:   0%|          | 0/100 [00:00<?, ?it/s]Training:   0%|          | 0/100 [03:04<?, ?it/s, train=63.5%, val_bal=50.0%]Training:   1%|          | 1/100 [03:04<5:03:52, 184.16s/it, train=63.5%, val_bal=50.0%]Training:   1%|          | 1/100 [06:30<5:03:52, 184.16s/it, train=77.9%, val_bal=50.0%]Training:   2%|â–         | 2/100 [06:30<5:22:20, 197.35s/it, train=77.9%, val_bal=50.0%]Training:   2%|â–         | 2/100 [09:55<5:22:20, 197.35s/it, train=85.2%, val_bal=79.4%]Training:   3%|â–Ž         | 3/100 [09:55<5:24:46, 200.89s/it, train=85.2%, val_bal=79.4%]Training:   3%|â–Ž         | 3/100 [13:01<5:24:46, 200.89s/it, train=86.8%, val_bal=79.1%]Training:   4%|â–         | 4/100 [13:01<5:11:32, 194.71s/it, train=86.8%, val_bal=79.1%]Training:   4%|â–         | 4/100 [16:06<5:11:32, 194.71s/it, train=87.4%, val_bal=75.9%]Training:   5%|â–Œ         | 5/100 [16:06<5:03:07, 191.45s/it, train=87.4%, val_bal=75.9%]Training:   5%|â–Œ         | 5/100 [19:11<5:03:07, 191.45s/it, train=87.4%, val_bal=75.5%]Training:   6%|â–Œ         | 6/100 [19:11<4:56:09, 189.03s/it, train=87.4%, val_bal=75.5%]Training:   6%|â–Œ         | 6/100 [22:15<4:56:09, 189.03s/it, train=88.0%, val_bal=78.7%]Training:   7%|â–‹         | 7/100 [22:15<4:50:47, 187.60s/it, train=88.0%, val_bal=78.7%]Training:   7%|â–‹         | 7/100 [25:20<4:50:47, 187.60s/it, train=87.7%, val_bal=84.0%]Training:   8%|â–Š         | 8/100 [25:20<4:46:06, 186.59s/it, train=87.7%, val_bal=84.0%]Training:   8%|â–Š         | 8/100 [28:25<4:46:06, 186.59s/it, train=87.3%, val_bal=83.3%]Training:   9%|â–‰         | 9/100 [28:25<4:42:19, 186.15s/it, train=87.3%, val_bal=83.3%]Training:   9%|â–‰         | 9/100 [31:30<4:42:19, 186.15s/it, train=87.9%, val_bal=77.3%]Training:  10%|â–ˆ         | 10/100 [31:30<4:38:49, 185.89s/it, train=87.9%, val_bal=77.3%]Training:  10%|â–ˆ         | 10/100 [34:35<4:38:49, 185.89s/it, train=88.1%, val_bal=83.5%]Training:  11%|â–ˆ         | 11/100 [34:35<4:35:07, 185.48s/it, train=88.1%, val_bal=83.5%]Training:  11%|â–ˆ         | 11/100 [37:40<4:35:07, 185.48s/it, train=88.2%, val_bal=79.5%]Training:  12%|â–ˆâ–        | 12/100 [37:40<4:31:53, 185.38s/it, train=88.2%, val_bal=79.5%]Training:  12%|â–ˆâ–        | 12/100 [40:44<4:31:53, 185.38s/it, train=88.3%, val_bal=82.4%]Training:  13%|â–ˆâ–Ž        | 13/100 [40:44<4:28:08, 184.93s/it, train=88.3%, val_bal=82.4%]Training:  13%|â–ˆâ–Ž        | 13/100 [43:49<4:28:08, 184.93s/it, train=88.7%, val_bal=78.0%]Training:  14%|â–ˆâ–        | 14/100 [43:49<4:25:03, 184.93s/it, train=88.7%, val_bal=78.0%]Training:  14%|â–ˆâ–        | 14/100 [46:54<4:25:03, 184.93s/it, train=88.6%, val_bal=76.4%]Training:  15%|â–ˆâ–Œ        | 15/100 [46:54<4:22:13, 185.10s/it, train=88.6%, val_bal=76.4%]Training:  15%|â–ˆâ–Œ        | 15/100 [49:59<4:22:13, 185.10s/it, train=88.7%, val_bal=84.3%]Training:  16%|â–ˆâ–Œ        | 16/100 [49:59<4:19:04, 185.06s/it, train=88.7%, val_bal=84.3%]Training:  16%|â–ˆâ–Œ        | 16/100 [53:05<4:19:04, 185.06s/it, train=88.5%, val_bal=80.6%]Training:  17%|â–ˆâ–‹        | 17/100 [53:05<4:16:12, 185.21s/it, train=88.5%, val_bal=80.6%]Training:  17%|â–ˆâ–‹        | 17/100 [56:09<4:16:12, 185.21s/it, train=88.7%, val_bal=85.0%]Training:  18%|â–ˆâ–Š        | 18/100 [56:09<4:12:56, 185.08s/it, train=88.7%, val_bal=85.0%]Training:  18%|â–ˆâ–Š        | 18/100 [59:13<4:12:56, 185.08s/it, train=89.1%, val_bal=81.9%]Training:  19%|â–ˆâ–‰        | 19/100 [59:13<4:09:17, 184.66s/it, train=89.1%, val_bal=81.9%]Training:  19%|â–ˆâ–‰        | 19/100 [1:02:18<4:09:17, 184.66s/it, train=88.8%, val_bal=80.3%]Training:  20%|â–ˆâ–ˆ        | 20/100 [1:02:18<4:06:08, 184.60s/it, train=88.8%, val_bal=80.3%]Training:  20%|â–ˆâ–ˆ        | 20/100 [1:05:22<4:06:08, 184.60s/it, train=89.2%, val_bal=84.1%]Training:  21%|â–ˆâ–ˆ        | 21/100 [1:05:22<4:02:50, 184.43s/it, train=89.2%, val_bal=84.1%]Training:  21%|â–ˆâ–ˆ        | 21/100 [1:08:25<4:02:50, 184.43s/it, train=89.5%, val_bal=81.8%]Training:  22%|â–ˆâ–ˆâ–       | 22/100 [1:08:25<3:59:25, 184.18s/it, train=89.5%, val_bal=81.8%]Training:  22%|â–ˆâ–ˆâ–       | 22/100 [1:11:29<3:59:25, 184.18s/it, train=89.4%, val_bal=84.9%]Training:  23%|â–ˆâ–ˆâ–Ž       | 23/100 [1:11:29<3:56:13, 184.07s/it, train=89.4%, val_bal=84.9%]Training:  23%|â–ˆâ–ˆâ–Ž       | 23/100 [1:14:33<3:56:13, 184.07s/it, train=89.0%, val_bal=82.5%]Training:  24%|â–ˆâ–ˆâ–       | 24/100 [1:14:33<3:53:02, 183.98s/it, train=89.0%, val_bal=82.5%]Training:  24%|â–ˆâ–ˆâ–       | 24/100 [1:17:36<3:53:02, 183.98s/it, train=89.5%, val_bal=83.4%]Training:  25%|â–ˆâ–ˆâ–Œ       | 25/100 [1:17:36<3:49:35, 183.67s/it, train=89.5%, val_bal=83.4%]Training:  25%|â–ˆâ–ˆâ–Œ       | 25/100 [1:20:40<3:49:35, 183.67s/it, train=90.0%, val_bal=81.4%]Training:  26%|â–ˆâ–ˆâ–Œ       | 26/100 [1:20:40<3:46:36, 183.73s/it, train=90.0%, val_bal=81.4%]Training:  26%|â–ˆâ–ˆâ–Œ       | 26/100 [1:23:44<3:46:36, 183.73s/it, train=89.9%, val_bal=81.2%]Training:  27%|â–ˆâ–ˆâ–‹       | 27/100 [1:23:44<3:43:44, 183.90s/it, train=89.9%, val_bal=81.2%]Training:  27%|â–ˆâ–ˆâ–‹       | 27/100 [1:26:49<3:43:44, 183.90s/it, train=89.7%, val_bal=82.1%]Training:  28%|â–ˆâ–ˆâ–Š       | 28/100 [1:26:49<3:41:12, 184.34s/it, train=89.7%, val_bal=82.1%]Training:  28%|â–ˆâ–ˆâ–Š       | 28/100 [1:29:55<3:41:12, 184.34s/it, train=90.0%, val_bal=81.5%]Training:  29%|â–ˆâ–ˆâ–‰       | 29/100 [1:29:55<3:38:44, 184.86s/it, train=90.0%, val_bal=81.5%]Training:  29%|â–ˆâ–ˆâ–‰       | 29/100 [1:33:00<3:38:44, 184.86s/it, train=89.5%, val_bal=82.4%]Training:  30%|â–ˆâ–ˆâ–ˆ       | 30/100 [1:33:00<3:35:41, 184.88s/it, train=89.5%, val_bal=82.4%]Training:  30%|â–ˆâ–ˆâ–ˆ       | 30/100 [1:36:06<3:35:41, 184.88s/it, train=89.9%, val_bal=82.8%]Training:  31%|â–ˆâ–ˆâ–ˆ       | 31/100 [1:36:06<3:32:46, 185.02s/it, train=89.9%, val_bal=82.8%]Training:  31%|â–ˆâ–ˆâ–ˆ       | 31/100 [1:39:09<3:32:46, 185.02s/it, train=89.5%, val_bal=81.7%]Training:  32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [1:39:09<3:29:10, 184.57s/it, train=89.5%, val_bal=81.7%]Training:  32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [1:42:15<3:29:10, 184.57s/it, train=89.9%, val_bal=82.6%]Training:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [1:42:15<3:26:25, 184.85s/it, train=89.9%, val_bal=82.6%]Training:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [1:45:20<3:26:25, 184.85s/it, train=90.2%, val_bal=82.9%]Training:  34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [1:45:20<3:23:26, 184.95s/it, train=90.2%, val_bal=82.9%]Training:  34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [1:48:25<3:23:26, 184.95s/it, train=90.0%, val_bal=82.5%]Training:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [1:48:25<3:20:33, 185.13s/it, train=90.0%, val_bal=82.5%]Training:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [1:51:31<3:20:33, 185.13s/it, train=90.0%, val_bal=77.0%]Training:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [1:51:31<3:17:36, 185.25s/it, train=90.0%, val_bal=77.0%]Training:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [1:54:36<3:17:36, 185.25s/it, train=90.2%, val_bal=83.8%]Training:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [1:54:36<3:14:31, 185.26s/it, train=90.2%, val_bal=83.8%]Training:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [1:57:40<3:14:31, 185.26s/it, train=90.4%, val_bal=82.8%]                                                                                           INFO:__main__:  Val(bal): 85.0% | Traj: 84.1% | CN_AD: 82.6%
INFO:__main__:
--- Fold 3/5 ---
INFO:dataset:Filled 4 missing values in 'AGE' with 69.00
INFO:dataset:Filled 10 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 593 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 601 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 653 missing values in 'TRABSCOR' with 77.00
INFO:dataset:Filled 1013 missing values in 'DSPANFOR' with -4.00
INFO:dataset:Filled 1018 missing values in 'DSPANBAC' with -4.00
INFO:dataset:Filled 1005 missing values in 'BNTTOTAL' with -4.00
INFO:dataset:Filled 167 missing values in 'VSWEIGHT' with 167.00
INFO:dataset:Filled 1 missing values in 'BMI' with 28.30
INFO:dataset:Filled 289 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 287 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 287 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 287 missing values in 'MH2NEURL' with -4.00
INFO:dataset:Loaded 5155 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 4035 (78.3%)
INFO:dataset:  Class 1: 1120 (21.7%)
INFO:mri_vit_model:Created ViT3DClassifier with vit_base
INFO:mri_vit_model:  Image size: 128x128x128
INFO:mri_vit_model:  Patch size: 16
INFO:mri_vit_model:  Num patches: 512
INFO:mri_vit_model:  Embed dim: 768, Depth: 12, Heads: 12
INFO:mri_vit_model:Loading MAE pre-trained weights from ../mri_vit_ad/pretrained/vit_mae75_pretrained.pth
INFO:mri_vit_model:  Loaded pos_embed directly (shapes match: torch.Size([1, 513, 768]))
INFO:mri_vit_model:Loaded 150 pretrained weights (including pos_embed, cls_token, patch_embed if matched)
INFO:mri_vit_model:Missing keys: 2
INFO:mri_vit_model:  Missing: ['head.1.weight', 'head.1.bias']
/home/tanguy/medical/alzheimer/env/lib/python3.12/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
ViT backbone: 768-dim features
FT-Transformer tabular encoder: 16 -> 64
  Auxiliary losses: Enabled (MRI + Tabular classifiers)
MultiModalFusion initialized:
  MRI backbone: vit (768-dim)
  Tabular features: 16 -> 64
  Fusion method: cross_modal
  Fusion hidden: 512
Training:   0%|          | 0/100 [00:00<?, ?it/s]Training:   0%|          | 0/100 [03:05<?, ?it/s, train=76.0%, val_bal=50.0%]Training:   1%|          | 1/100 [03:05<5:06:34, 185.81s/it, train=76.0%, val_bal=50.0%]Training:   1%|          | 1/100 [06:29<5:06:34, 185.81s/it, train=79.0%, val_bal=75.8%]Training:   2%|â–         | 2/100 [06:29<5:20:33, 196.26s/it, train=79.0%, val_bal=75.8%]Training:   2%|â–         | 2/100 [09:34<5:20:33, 196.26s/it, train=86.7%, val_bal=77.7%]Training:   3%|â–Ž         | 3/100 [09:34<5:09:09, 191.23s/it, train=86.7%, val_bal=77.7%]Training:   3%|â–Ž         | 3/100 [12:39<5:09:09, 191.23s/it, train=87.9%, val_bal=79.0%]Training:   4%|â–         | 4/100 [12:39<5:02:07, 188.82s/it, train=87.9%, val_bal=79.0%]Training:   4%|â–         | 4/100 [15:44<5:02:07, 188.82s/it, train=87.9%, val_bal=80.6%]Training:   5%|â–Œ         | 5/100 [15:44<4:56:37, 187.34s/it, train=87.9%, val_bal=80.6%]Training:   5%|â–Œ         | 5/100 [18:50<4:56:37, 187.34s/it, train=88.4%, val_bal=82.3%]Training:   6%|â–Œ         | 6/100 [18:50<4:52:39, 186.80s/it, train=88.4%, val_bal=82.3%]Training:   6%|â–Œ         | 6/100 [21:54<4:52:39, 186.80s/it, train=88.4%, val_bal=83.3%]Training:   7%|â–‹         | 7/100 [21:54<4:48:20, 186.03s/it, train=88.4%, val_bal=83.3%]Training:   7%|â–‹         | 7/100 [25:00<4:48:20, 186.03s/it, train=88.4%, val_bal=80.7%]Training:   8%|â–Š         | 8/100 [25:00<4:45:02, 185.89s/it, train=88.4%, val_bal=80.7%]Training:   8%|â–Š         | 8/100 [28:03<4:45:02, 185.89s/it, train=90.2%, val_bal=83.4%]Training:   9%|â–‰         | 9/100 [28:03<4:40:54, 185.22s/it, train=90.2%, val_bal=83.4%]Training:   9%|â–‰         | 9/100 [31:12<4:40:54, 185.22s/it, train=90.6%, val_bal=74.7%]Training:  10%|â–ˆ         | 10/100 [31:12<4:39:32, 186.37s/it, train=90.6%, val_bal=74.7%]Training:  10%|â–ˆ         | 10/100 [34:17<4:39:32, 186.37s/it, train=90.5%, val_bal=82.8%]Training:  11%|â–ˆ         | 11/100 [34:17<4:35:38, 185.82s/it, train=90.5%, val_bal=82.8%]Training:  11%|â–ˆ         | 11/100 [37:22<4:35:38, 185.82s/it, train=91.1%, val_bal=86.7%]Training:  12%|â–ˆâ–        | 12/100 [37:22<4:32:10, 185.57s/it, train=91.1%, val_bal=86.7%]Training:  12%|â–ˆâ–        | 12/100 [40:31<4:32:10, 185.57s/it, train=91.9%, val_bal=88.5%]Training:  13%|â–ˆâ–Ž        | 13/100 [40:31<4:30:24, 186.49s/it, train=91.9%, val_bal=88.5%]Training:  13%|â–ˆâ–Ž        | 13/100 [43:42<4:30:24, 186.49s/it, train=91.5%, val_bal=82.3%]Training:  14%|â–ˆâ–        | 14/100 [43:42<4:29:26, 187.98s/it, train=91.5%, val_bal=82.3%]Training:  14%|â–ˆâ–        | 14/100 [46:52<4:29:26, 187.98s/it, train=91.9%, val_bal=88.5%]Training:  15%|â–ˆâ–Œ        | 15/100 [46:53<4:27:23, 188.75s/it, train=91.9%, val_bal=88.5%]Training:  15%|â–ˆâ–Œ        | 15/100 [50:03<4:27:23, 188.75s/it, train=91.6%, val_bal=87.0%]Training:  16%|â–ˆâ–Œ        | 16/100 [50:03<4:24:52, 189.19s/it, train=91.6%, val_bal=87.0%]Training:  16%|â–ˆâ–Œ        | 16/100 [53:14<4:24:52, 189.19s/it, train=92.4%, val_bal=83.7%]Training:  17%|â–ˆâ–‹        | 17/100 [53:14<4:22:30, 189.77s/it, train=92.4%, val_bal=83.7%]Training:  17%|â–ˆâ–‹        | 17/100 [56:24<4:22:30, 189.77s/it, train=92.5%, val_bal=88.8%]Training:  18%|â–ˆâ–Š        | 18/100 [56:24<4:19:31, 189.89s/it, train=92.5%, val_bal=88.8%]Training:  18%|â–ˆâ–Š        | 18/100 [59:35<4:19:31, 189.89s/it, train=92.9%, val_bal=85.6%]Training:  19%|â–ˆâ–‰        | 19/100 [59:35<4:16:57, 190.34s/it, train=92.9%, val_bal=85.6%]Training:  19%|â–ˆâ–‰        | 19/100 [1:02:47<4:16:57, 190.34s/it, train=92.5%, val_bal=87.9%]Training:  20%|â–ˆâ–ˆ        | 20/100 [1:02:47<4:14:17, 190.72s/it, train=92.5%, val_bal=87.9%]Training:  20%|â–ˆâ–ˆ        | 20/100 [1:05:56<4:14:17, 190.72s/it, train=93.2%, val_bal=87.0%]Training:  21%|â–ˆâ–ˆ        | 21/100 [1:05:56<4:10:27, 190.22s/it, train=93.2%, val_bal=87.0%]Training:  21%|â–ˆâ–ˆ        | 21/100 [1:09:05<4:10:27, 190.22s/it, train=93.2%, val_bal=89.7%]Training:  22%|â–ˆâ–ˆâ–       | 22/100 [1:09:05<4:06:39, 189.73s/it, train=93.2%, val_bal=89.7%]Training:  22%|â–ˆâ–ˆâ–       | 22/100 [1:12:15<4:06:39, 189.73s/it, train=93.6%, val_bal=86.8%]Training:  23%|â–ˆâ–ˆâ–Ž       | 23/100 [1:12:15<4:03:32, 189.77s/it, train=93.6%, val_bal=86.8%]Training:  23%|â–ˆâ–ˆâ–Ž       | 23/100 [1:15:25<4:03:32, 189.77s/it, train=93.4%, val_bal=85.7%]Training:  24%|â–ˆâ–ˆâ–       | 24/100 [1:15:25<4:00:41, 190.02s/it, train=93.4%, val_bal=85.7%]Training:  24%|â–ˆâ–ˆâ–       | 24/100 [1:18:37<4:00:41, 190.02s/it, train=93.4%, val_bal=88.3%]Training:  25%|â–ˆâ–ˆâ–Œ       | 25/100 [1:18:37<3:58:18, 190.65s/it, train=93.4%, val_bal=88.3%]Training:  25%|â–ˆâ–ˆâ–Œ       | 25/100 [1:21:49<3:58:18, 190.65s/it, train=93.8%, val_bal=86.4%]Training:  26%|â–ˆâ–ˆâ–Œ       | 26/100 [1:21:49<3:55:30, 190.95s/it, train=93.8%, val_bal=86.4%]Training:  26%|â–ˆâ–ˆâ–Œ       | 26/100 [1:25:00<3:55:30, 190.95s/it, train=93.9%, val_bal=85.5%]Training:  27%|â–ˆâ–ˆâ–‹       | 27/100 [1:25:00<3:52:30, 191.11s/it, train=93.9%, val_bal=85.5%]Training:  27%|â–ˆâ–ˆâ–‹       | 27/100 [1:28:11<3:52:30, 191.11s/it, train=93.7%, val_bal=88.1%]Training:  28%|â–ˆâ–ˆâ–Š       | 28/100 [1:28:11<3:49:12, 191.01s/it, train=93.7%, val_bal=88.1%]Training:  28%|â–ˆâ–ˆâ–Š       | 28/100 [1:31:23<3:49:12, 191.01s/it, train=94.2%, val_bal=85.9%]Training:  29%|â–ˆâ–ˆâ–‰       | 29/100 [1:31:23<3:46:11, 191.15s/it, train=94.2%, val_bal=85.9%]Training:  29%|â–ˆâ–ˆâ–‰       | 29/100 [1:34:34<3:46:11, 191.15s/it, train=94.3%, val_bal=90.3%]Training:  30%|â–ˆâ–ˆâ–ˆ       | 30/100 [1:34:34<3:43:02, 191.18s/it, train=94.3%, val_bal=90.3%]Training:  30%|â–ˆâ–ˆâ–ˆ       | 30/100 [1:37:44<3:43:02, 191.18s/it, train=94.4%, val_bal=90.0%]Training:  31%|â–ˆâ–ˆâ–ˆ       | 31/100 [1:37:44<3:39:28, 190.85s/it, train=94.4%, val_bal=90.0%]Training:  31%|â–ˆâ–ˆâ–ˆ       | 31/100 [1:40:56<3:39:28, 190.85s/it, train=94.4%, val_bal=90.6%]Training:  32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [1:40:56<3:36:40, 191.19s/it, train=94.4%, val_bal=90.6%]Training:  32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [1:44:08<3:36:40, 191.19s/it, train=94.8%, val_bal=87.0%]Training:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [1:44:08<3:33:45, 191.43s/it, train=94.8%, val_bal=87.0%]Training:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [1:47:19<3:33:45, 191.43s/it, train=94.3%, val_bal=84.3%]Training:  34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [1:47:19<3:30:30, 191.37s/it, train=94.3%, val_bal=84.3%]Training:  34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [1:50:31<3:30:30, 191.37s/it, train=94.8%, val_bal=91.2%]Training:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [1:50:31<3:27:26, 191.48s/it, train=94.8%, val_bal=91.2%]Training:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [1:53:44<3:27:26, 191.48s/it, train=95.3%, val_bal=89.1%]Training:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [1:53:44<3:24:46, 191.98s/it, train=95.3%, val_bal=89.1%]Training:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [1:56:55<3:24:46, 191.98s/it, train=95.0%, val_bal=85.9%]Training:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [1:56:55<3:21:06, 191.54s/it, train=95.0%, val_bal=85.9%]Training:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [2:00:05<3:21:06, 191.54s/it, train=95.3%, val_bal=86.7%]Training:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [2:00:05<3:17:40, 191.30s/it, train=95.3%, val_bal=86.7%]Training:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [2:03:16<3:17:40, 191.30s/it, train=95.2%, val_bal=88.5%]Training:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [2:03:16<3:14:21, 191.18s/it, train=95.2%, val_bal=88.5%]Training:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [2:06:28<3:14:21, 191.18s/it, train=95.2%, val_bal=88.9%]Training:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [2:06:28<3:11:19, 191.33s/it, train=95.2%, val_bal=88.9%]Training:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [2:09:40<3:11:19, 191.33s/it, train=95.5%, val_bal=87.6%]Training:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [2:09:40<3:08:14, 191.43s/it, train=95.5%, val_bal=87.6%]Training:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [2:12:51<3:08:14, 191.43s/it, train=95.6%, val_bal=87.7%]Training:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [2:12:51<3:05:02, 191.42s/it, train=95.6%, val_bal=87.7%]Training:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [2:16:02<3:05:02, 191.42s/it, train=95.6%, val_bal=88.6%]Training:  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [2:16:02<3:01:46, 191.34s/it, train=95.6%, val_bal=88.6%]Training:  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [2:19:12<3:01:46, 191.34s/it, train=96.1%, val_bal=87.9%]Training:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [2:19:12<2:58:12, 190.93s/it, train=96.1%, val_bal=87.9%]Training:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [2:22:24<2:58:12, 190.93s/it, train=96.3%, val_bal=87.9%]Training:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [2:22:24<2:55:08, 191.06s/it, train=96.3%, val_bal=87.9%]Training:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [2:25:36<2:55:08, 191.06s/it, train=96.2%, val_bal=89.4%]Training:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [2:25:36<2:52:14, 191.38s/it, train=96.2%, val_bal=89.4%]Training:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [2:28:47<2:52:14, 191.38s/it, train=96.4%, val_bal=87.9%]Training:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [2:28:47<2:49:02, 191.36s/it, train=96.4%, val_bal=87.9%]Training:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [2:31:58<2:49:02, 191.36s/it, train=96.7%, val_bal=85.1%]Training:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [2:31:58<2:45:53, 191.41s/it, train=96.7%, val_bal=85.1%]Training:  48%|â–ˆâ–ˆâ–ˆâ–ˆâ–Š     | 48/100 [2:35:10<2:45:53, 191.41s/it, train=96.8%, val_bal=88.5%]Training:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [2:35:10<2:42:37, 191.33s/it, train=96.8%, val_bal=88.5%]Training:  49%|â–ˆâ–ˆâ–ˆâ–ˆâ–‰     | 49/100 [2:38:20<2:42:37, 191.33s/it, train=97.2%, val_bal=87.6%]Training:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [2:38:20<2:39:19, 191.19s/it, train=97.2%, val_bal=87.6%]Training:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 50/100 [2:41:32<2:39:19, 191.19s/it, train=96.7%, val_bal=85.3%]Training:  51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [2:41:32<2:36:08, 191.19s/it, train=96.7%, val_bal=85.3%]Training:  51%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 51/100 [2:44:44<2:36:08, 191.19s/it, train=97.6%, val_bal=87.1%]Training:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [2:44:44<2:33:09, 191.46s/it, train=97.6%, val_bal=87.1%]Training:  52%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 52/100 [2:47:56<2:33:09, 191.46s/it, train=97.2%, val_bal=88.9%]Training:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [2:47:56<2:30:14, 191.80s/it, train=97.2%, val_bal=88.9%]Training:  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž    | 53/100 [2:51:09<2:30:14, 191.80s/it, train=97.6%, val_bal=88.3%]Training:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [2:51:09<2:27:12, 192.01s/it, train=97.6%, val_bal=88.3%]Training:  54%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 54/100 [2:54:19<2:27:12, 192.01s/it, train=97.6%, val_bal=88.6%]                                                                                           INFO:__main__:  Val(bal): 91.2% | Traj: 89.5% | CN_AD: 93.5%
INFO:__main__:
--- Fold 4/5 ---
INFO:dataset:Filled 4 missing values in 'AGE' with 69.00
INFO:dataset:Filled 10 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 593 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 601 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 653 missing values in 'TRABSCOR' with 77.00
INFO:dataset:Filled 1013 missing values in 'DSPANFOR' with -4.00
INFO:dataset:Filled 1018 missing values in 'DSPANBAC' with -4.00
INFO:dataset:Filled 1005 missing values in 'BNTTOTAL' with -4.00
INFO:dataset:Filled 167 missing values in 'VSWEIGHT' with 167.00
INFO:dataset:Filled 1 missing values in 'BMI' with 28.30
INFO:dataset:Filled 289 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 287 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 287 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 287 missing values in 'MH2NEURL' with -4.00
INFO:dataset:Loaded 5155 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 4035 (78.3%)
INFO:dataset:  Class 1: 1120 (21.7%)
INFO:mri_vit_model:Created ViT3DClassifier with vit_base
INFO:mri_vit_model:  Image size: 128x128x128
INFO:mri_vit_model:  Patch size: 16
INFO:mri_vit_model:  Num patches: 512
INFO:mri_vit_model:  Embed dim: 768, Depth: 12, Heads: 12
INFO:mri_vit_model:Loading MAE pre-trained weights from ../mri_vit_ad/pretrained/vit_mae75_pretrained.pth
INFO:mri_vit_model:  Loaded pos_embed directly (shapes match: torch.Size([1, 513, 768]))
INFO:mri_vit_model:Loaded 150 pretrained weights (including pos_embed, cls_token, patch_embed if matched)
INFO:mri_vit_model:Missing keys: 2
INFO:mri_vit_model:  Missing: ['head.1.weight', 'head.1.bias']
/home/tanguy/medical/alzheimer/env/lib/python3.12/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
ViT backbone: 768-dim features
FT-Transformer tabular encoder: 16 -> 64
  Auxiliary losses: Enabled (MRI + Tabular classifiers)
MultiModalFusion initialized:
  MRI backbone: vit (768-dim)
  Tabular features: 16 -> 64
  Fusion method: cross_modal
  Fusion hidden: 512
Training:   0%|          | 0/100 [00:00<?, ?it/s]Training:   0%|          | 0/100 [03:05<?, ?it/s, train=54.8%, val_bal=50.0%]Training:   1%|          | 1/100 [03:05<5:06:14, 185.60s/it, train=54.8%, val_bal=50.0%]Training:   1%|          | 1/100 [06:34<5:06:14, 185.60s/it, train=78.6%, val_bal=61.8%]Training:   2%|â–         | 2/100 [06:34<5:25:42, 199.41s/it, train=78.6%, val_bal=61.8%]Training:   2%|â–         | 2/100 [09:40<5:25:42, 199.41s/it, train=85.7%, val_bal=77.5%]Training:   3%|â–Ž         | 3/100 [09:40<5:12:06, 193.06s/it, train=85.7%, val_bal=77.5%]Training:   3%|â–Ž         | 3/100 [12:45<5:12:06, 193.06s/it, train=87.1%, val_bal=77.2%]Training:   4%|â–         | 4/100 [12:45<5:04:17, 190.18s/it, train=87.1%, val_bal=77.2%]Training:   4%|â–         | 4/100 [15:50<5:04:17, 190.18s/it, train=87.8%, val_bal=83.2%]Training:   5%|â–Œ         | 5/100 [15:50<4:58:03, 188.24s/it, train=87.8%, val_bal=83.2%]Training:   5%|â–Œ         | 5/100 [18:56<4:58:03, 188.24s/it, train=87.9%, val_bal=82.6%]Training:   6%|â–Œ         | 6/100 [18:56<4:53:33, 187.38s/it, train=87.9%, val_bal=82.6%]Training:   6%|â–Œ         | 6/100 [22:01<4:53:33, 187.38s/it, train=88.2%, val_bal=81.7%]Training:   7%|â–‹         | 7/100 [22:01<4:49:06, 186.52s/it, train=88.2%, val_bal=81.7%]Training:   7%|â–‹         | 7/100 [25:05<4:49:06, 186.52s/it, train=88.5%, val_bal=77.8%]Training:   8%|â–Š         | 8/100 [25:05<4:45:00, 185.87s/it, train=88.5%, val_bal=77.8%]Training:   8%|â–Š         | 8/100 [28:10<4:45:00, 185.87s/it, train=89.4%, val_bal=84.9%]Training:   9%|â–‰         | 9/100 [28:10<4:41:33, 185.65s/it, train=89.4%, val_bal=84.9%]Training:   9%|â–‰         | 9/100 [31:15<4:41:33, 185.65s/it, train=89.5%, val_bal=85.5%]Training:  10%|â–ˆ         | 10/100 [31:15<4:38:13, 185.48s/it, train=89.5%, val_bal=85.5%]Training:  10%|â–ˆ         | 10/100 [34:26<4:38:13, 185.48s/it, train=90.3%, val_bal=84.1%]Training:  11%|â–ˆ         | 11/100 [34:26<4:37:36, 187.16s/it, train=90.3%, val_bal=84.1%]Training:  11%|â–ˆ         | 11/100 [37:34<4:37:36, 187.16s/it, train=91.3%, val_bal=83.7%]Training:  12%|â–ˆâ–        | 12/100 [37:34<4:34:44, 187.32s/it, train=91.3%, val_bal=83.7%]Training:  12%|â–ˆâ–        | 12/100 [40:39<4:34:44, 187.32s/it, train=91.6%, val_bal=87.3%]Training:  13%|â–ˆâ–Ž        | 13/100 [40:39<4:30:37, 186.64s/it, train=91.6%, val_bal=87.3%]Training:  13%|â–ˆâ–Ž        | 13/100 [43:43<4:30:37, 186.64s/it, train=91.4%, val_bal=88.9%]Training:  14%|â–ˆâ–        | 14/100 [43:43<4:26:16, 185.77s/it, train=91.4%, val_bal=88.9%]Training:  14%|â–ˆâ–        | 14/100 [46:54<4:26:16, 185.77s/it, train=91.7%, val_bal=89.9%]Training:  15%|â–ˆâ–Œ        | 15/100 [46:54<4:25:23, 187.33s/it, train=91.7%, val_bal=89.9%]Training:  15%|â–ˆâ–Œ        | 15/100 [50:07<4:25:23, 187.33s/it, train=92.5%, val_bal=87.7%]Training:  16%|â–ˆâ–Œ        | 16/100 [50:07<4:24:31, 188.95s/it, train=92.5%, val_bal=87.7%]Training:  16%|â–ˆâ–Œ        | 16/100 [53:18<4:24:31, 188.95s/it, train=92.3%, val_bal=88.5%]Training:  17%|â–ˆâ–‹        | 17/100 [53:18<4:22:34, 189.81s/it, train=92.3%, val_bal=88.5%]Training:  17%|â–ˆâ–‹        | 17/100 [56:31<4:22:34, 189.81s/it, train=92.9%, val_bal=86.1%]Training:  18%|â–ˆâ–Š        | 18/100 [56:31<4:20:35, 190.68s/it, train=92.9%, val_bal=86.1%]Training:  18%|â–ˆâ–Š        | 18/100 [59:43<4:20:35, 190.68s/it, train=93.0%, val_bal=87.3%]Training:  19%|â–ˆâ–‰        | 19/100 [59:43<4:18:02, 191.14s/it, train=93.0%, val_bal=87.3%]Training:  19%|â–ˆâ–‰        | 19/100 [1:02:54<4:18:02, 191.14s/it, train=93.1%, val_bal=89.8%]Training:  20%|â–ˆâ–ˆ        | 20/100 [1:02:54<4:14:36, 190.95s/it, train=93.1%, val_bal=89.8%]Training:  20%|â–ˆâ–ˆ        | 20/100 [1:06:06<4:14:36, 190.95s/it, train=93.3%, val_bal=86.6%]Training:  21%|â–ˆâ–ˆ        | 21/100 [1:06:06<4:11:43, 191.18s/it, train=93.3%, val_bal=86.6%]Training:  21%|â–ˆâ–ˆ        | 21/100 [1:09:17<4:11:43, 191.18s/it, train=93.9%, val_bal=87.5%]Training:  22%|â–ˆâ–ˆâ–       | 22/100 [1:09:17<4:08:38, 191.26s/it, train=93.9%, val_bal=87.5%]Training:  22%|â–ˆâ–ˆâ–       | 22/100 [1:12:29<4:08:38, 191.26s/it, train=93.3%, val_bal=75.4%]Training:  23%|â–ˆâ–ˆâ–Ž       | 23/100 [1:12:29<4:05:43, 191.48s/it, train=93.3%, val_bal=75.4%]Training:  23%|â–ˆâ–ˆâ–Ž       | 23/100 [1:15:40<4:05:43, 191.48s/it, train=93.6%, val_bal=86.6%]Training:  24%|â–ˆâ–ˆâ–       | 24/100 [1:15:40<4:02:21, 191.34s/it, train=93.6%, val_bal=86.6%]Training:  24%|â–ˆâ–ˆâ–       | 24/100 [1:18:51<4:02:21, 191.34s/it, train=94.2%, val_bal=86.3%]Training:  25%|â–ˆâ–ˆâ–Œ       | 25/100 [1:18:51<3:59:02, 191.23s/it, train=94.2%, val_bal=86.3%]Training:  25%|â–ˆâ–ˆâ–Œ       | 25/100 [1:22:01<3:59:02, 191.23s/it, train=93.9%, val_bal=87.4%]Training:  26%|â–ˆâ–ˆâ–Œ       | 26/100 [1:22:01<3:55:30, 190.96s/it, train=93.9%, val_bal=87.4%]Training:  26%|â–ˆâ–ˆâ–Œ       | 26/100 [1:25:13<3:55:30, 190.96s/it, train=93.8%, val_bal=82.7%]Training:  27%|â–ˆâ–ˆâ–‹       | 27/100 [1:25:13<3:52:35, 191.17s/it, train=93.8%, val_bal=82.7%]Training:  27%|â–ˆâ–ˆâ–‹       | 27/100 [1:28:25<3:52:35, 191.17s/it, train=94.6%, val_bal=85.2%]Training:  28%|â–ˆâ–ˆâ–Š       | 28/100 [1:28:25<3:49:44, 191.44s/it, train=94.6%, val_bal=85.2%]Training:  28%|â–ˆâ–ˆâ–Š       | 28/100 [1:31:36<3:49:44, 191.44s/it, train=94.4%, val_bal=88.4%]Training:  29%|â–ˆâ–ˆâ–‰       | 29/100 [1:31:36<3:46:20, 191.27s/it, train=94.4%, val_bal=88.4%]Training:  29%|â–ˆâ–ˆâ–‰       | 29/100 [1:34:48<3:46:20, 191.27s/it, train=94.9%, val_bal=86.6%]Training:  30%|â–ˆâ–ˆâ–ˆ       | 30/100 [1:34:48<3:43:20, 191.43s/it, train=94.9%, val_bal=86.6%]Training:  30%|â–ˆâ–ˆâ–ˆ       | 30/100 [1:37:57<3:43:20, 191.43s/it, train=94.7%, val_bal=85.7%]Training:  31%|â–ˆâ–ˆâ–ˆ       | 31/100 [1:37:57<3:39:21, 190.74s/it, train=94.7%, val_bal=85.7%]Training:  31%|â–ˆâ–ˆâ–ˆ       | 31/100 [1:41:09<3:39:21, 190.74s/it, train=95.3%, val_bal=87.9%]Training:  32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [1:41:09<3:36:33, 191.07s/it, train=95.3%, val_bal=87.9%]Training:  32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [1:44:20<3:36:33, 191.07s/it, train=95.3%, val_bal=89.3%]Training:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [1:44:20<3:33:32, 191.23s/it, train=95.3%, val_bal=89.3%]Training:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [1:47:31<3:33:32, 191.23s/it, train=95.2%, val_bal=88.7%]Training:  34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [1:47:31<3:30:17, 191.17s/it, train=95.2%, val_bal=88.7%]Training:  34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [1:50:43<3:30:17, 191.17s/it, train=95.4%, val_bal=89.2%]                                                                                           INFO:__main__:  Val(bal): 89.9% | Traj: 88.8% | CN_AD: 90.5%
INFO:__main__:
--- Fold 5/5 ---
INFO:dataset:Filled 4 missing values in 'AGE' with 69.00
INFO:dataset:Filled 10 missing values in 'PTEDUCAT' with 16.00
INFO:dataset:Filled 593 missing values in 'CATANIMSC' with 20.00
INFO:dataset:Filled 601 missing values in 'TRAASCOR' with 31.00
INFO:dataset:Filled 653 missing values in 'TRABSCOR' with 77.00
INFO:dataset:Filled 1013 missing values in 'DSPANFOR' with -4.00
INFO:dataset:Filled 1018 missing values in 'DSPANBAC' with -4.00
INFO:dataset:Filled 1005 missing values in 'BNTTOTAL' with -4.00
INFO:dataset:Filled 167 missing values in 'VSWEIGHT' with 167.00
INFO:dataset:Filled 1 missing values in 'BMI' with 28.30
INFO:dataset:Filled 289 missing values in 'MH14ALCH' with 0.00
INFO:dataset:Filled 287 missing values in 'MH16SMOK' with 0.00
INFO:dataset:Filled 287 missing values in 'MH4CARD' with 0.00
INFO:dataset:Filled 287 missing values in 'MH2NEURL' with -4.00
INFO:dataset:Loaded 5155 samples
INFO:dataset:Tabular features (16): ['AGE', 'PTGENDER', 'PTEDUCAT', 'PTMARRY', 'CATANIMSC', 'TRAASCOR', 'TRABSCOR', 'DSPANFOR', 'DSPANBAC', 'BNTTOTAL', 'VSWEIGHT', 'BMI', 'MH14ALCH', 'MH16SMOK', 'MH4CARD', 'MH2NEURL']
INFO:dataset:  Class 0: 4035 (78.3%)
INFO:dataset:  Class 1: 1120 (21.7%)
INFO:mri_vit_model:Created ViT3DClassifier with vit_base
INFO:mri_vit_model:  Image size: 128x128x128
INFO:mri_vit_model:  Patch size: 16
INFO:mri_vit_model:  Num patches: 512
INFO:mri_vit_model:  Embed dim: 768, Depth: 12, Heads: 12
INFO:mri_vit_model:Loading MAE pre-trained weights from ../mri_vit_ad/pretrained/vit_mae75_pretrained.pth
INFO:mri_vit_model:  Loaded pos_embed directly (shapes match: torch.Size([1, 513, 768]))
INFO:mri_vit_model:Loaded 150 pretrained weights (including pos_embed, cls_token, patch_embed if matched)
INFO:mri_vit_model:Missing keys: 2
INFO:mri_vit_model:  Missing: ['head.1.weight', 'head.1.bias']
/home/tanguy/medical/alzheimer/env/lib/python3.12/site-packages/torch/nn/modules/transformer.py:392: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(
ViT backbone: 768-dim features
FT-Transformer tabular encoder: 16 -> 64
  Auxiliary losses: Enabled (MRI + Tabular classifiers)
MultiModalFusion initialized:
  MRI backbone: vit (768-dim)
  Tabular features: 16 -> 64
  Fusion method: cross_modal
  Fusion hidden: 512
Training:   0%|          | 0/100 [00:00<?, ?it/s]Training:   0%|          | 0/100 [03:04<?, ?it/s, train=75.8%, val_bal=50.0%]Training:   1%|          | 1/100 [03:05<5:05:16, 185.02s/it, train=75.8%, val_bal=50.0%]Training:   1%|          | 1/100 [06:09<5:05:16, 185.02s/it, train=78.8%, val_bal=71.0%]Training:   2%|â–         | 2/100 [06:09<5:01:29, 184.59s/it, train=78.8%, val_bal=71.0%]Training:   2%|â–         | 2/100 [09:14<5:01:29, 184.59s/it, train=86.4%, val_bal=76.3%]Training:   3%|â–Ž         | 3/100 [09:14<4:58:43, 184.78s/it, train=86.4%, val_bal=76.3%]Training:   3%|â–Ž         | 3/100 [12:19<4:58:43, 184.78s/it, train=88.4%, val_bal=80.5%]Training:   4%|â–         | 4/100 [12:20<4:56:17, 185.18s/it, train=88.4%, val_bal=80.5%]Training:   4%|â–         | 4/100 [15:25<4:56:17, 185.18s/it, train=88.3%, val_bal=79.5%]Training:   5%|â–Œ         | 5/100 [15:25<4:53:24, 185.31s/it, train=88.3%, val_bal=79.5%]Training:   5%|â–Œ         | 5/100 [18:30<4:53:24, 185.31s/it, train=89.1%, val_bal=82.6%]Training:   6%|â–Œ         | 6/100 [18:31<4:50:22, 185.34s/it, train=89.1%, val_bal=82.6%]Training:   6%|â–Œ         | 6/100 [21:35<4:50:22, 185.34s/it, train=89.6%, val_bal=83.7%]Training:   7%|â–‹         | 7/100 [21:35<4:46:40, 184.95s/it, train=89.6%, val_bal=83.7%]Training:   7%|â–‹         | 7/100 [24:40<4:46:40, 184.95s/it, train=90.6%, val_bal=87.2%]Training:   8%|â–Š         | 8/100 [24:40<4:43:38, 184.98s/it, train=90.6%, val_bal=87.2%]Training:   8%|â–Š         | 8/100 [27:43<4:43:38, 184.98s/it, train=90.7%, val_bal=86.8%]Training:   9%|â–‰         | 9/100 [27:43<4:39:57, 184.59s/it, train=90.7%, val_bal=86.8%]Training:   9%|â–‰         | 9/100 [30:49<4:39:57, 184.59s/it, train=91.7%, val_bal=81.9%]Training:  10%|â–ˆ         | 10/100 [30:49<4:37:19, 184.88s/it, train=91.7%, val_bal=81.9%]Training:  10%|â–ˆ         | 10/100 [33:54<4:37:19, 184.88s/it, train=91.9%, val_bal=76.7%]Training:  11%|â–ˆ         | 11/100 [33:54<4:34:18, 184.93s/it, train=91.9%, val_bal=76.7%]Training:  11%|â–ˆ         | 11/100 [37:00<4:34:18, 184.93s/it, train=92.0%, val_bal=81.5%]Training:  12%|â–ˆâ–        | 12/100 [37:00<4:31:32, 185.14s/it, train=92.0%, val_bal=81.5%]Training:  12%|â–ˆâ–        | 12/100 [40:06<4:31:32, 185.14s/it, train=92.1%, val_bal=82.9%]Training:  13%|â–ˆâ–Ž        | 13/100 [40:06<4:28:47, 185.37s/it, train=92.1%, val_bal=82.9%]Training:  13%|â–ˆâ–Ž        | 13/100 [43:12<4:28:47, 185.37s/it, train=92.2%, val_bal=85.6%]Training:  14%|â–ˆâ–        | 14/100 [43:12<4:26:06, 185.65s/it, train=92.2%, val_bal=85.6%]Training:  14%|â–ˆâ–        | 14/100 [46:19<4:26:06, 185.65s/it, train=92.7%, val_bal=85.0%]Training:  15%|â–ˆâ–Œ        | 15/100 [46:19<4:23:38, 186.10s/it, train=92.7%, val_bal=85.0%]Training:  15%|â–ˆâ–Œ        | 15/100 [49:24<4:23:38, 186.10s/it, train=92.9%, val_bal=87.2%]Training:  16%|â–ˆâ–Œ        | 16/100 [49:24<4:20:03, 185.76s/it, train=92.9%, val_bal=87.2%]Training:  16%|â–ˆâ–Œ        | 16/100 [52:28<4:20:03, 185.76s/it, train=92.9%, val_bal=87.7%]Training:  17%|â–ˆâ–‹        | 17/100 [52:28<4:16:17, 185.27s/it, train=92.9%, val_bal=87.7%]Training:  17%|â–ˆâ–‹        | 17/100 [55:40<4:16:17, 185.27s/it, train=93.5%, val_bal=80.6%]Training:  18%|â–ˆâ–Š        | 18/100 [55:40<4:15:53, 187.23s/it, train=93.5%, val_bal=80.6%]Training:  18%|â–ˆâ–Š        | 18/100 [58:51<4:15:53, 187.23s/it, train=93.3%, val_bal=83.3%]Training:  19%|â–ˆâ–‰        | 19/100 [58:51<4:14:27, 188.49s/it, train=93.3%, val_bal=83.3%]Training:  19%|â–ˆâ–‰        | 19/100 [1:02:02<4:14:27, 188.49s/it, train=93.3%, val_bal=84.3%]Training:  20%|â–ˆâ–ˆ        | 20/100 [1:02:02<4:12:03, 189.04s/it, train=93.3%, val_bal=84.3%]Training:  20%|â–ˆâ–ˆ        | 20/100 [1:05:13<4:12:03, 189.04s/it, train=93.8%, val_bal=85.3%]Training:  21%|â–ˆâ–ˆ        | 21/100 [1:05:13<4:09:43, 189.67s/it, train=93.8%, val_bal=85.3%]Training:  21%|â–ˆâ–ˆ        | 21/100 [1:08:23<4:09:43, 189.67s/it, train=94.0%, val_bal=86.1%]Training:  22%|â–ˆâ–ˆâ–       | 22/100 [1:08:23<4:06:39, 189.74s/it, train=94.0%, val_bal=86.1%]Training:  22%|â–ˆâ–ˆâ–       | 22/100 [1:11:33<4:06:39, 189.74s/it, train=94.1%, val_bal=82.2%]Training:  23%|â–ˆâ–ˆâ–Ž       | 23/100 [1:11:33<4:03:51, 190.02s/it, train=94.1%, val_bal=82.2%]Training:  23%|â–ˆâ–ˆâ–Ž       | 23/100 [1:14:43<4:03:51, 190.02s/it, train=94.2%, val_bal=86.1%]Training:  24%|â–ˆâ–ˆâ–       | 24/100 [1:14:44<4:00:44, 190.06s/it, train=94.2%, val_bal=86.1%]Training:  24%|â–ˆâ–ˆâ–       | 24/100 [1:17:56<4:00:44, 190.06s/it, train=94.3%, val_bal=87.8%]Training:  25%|â–ˆâ–ˆâ–Œ       | 25/100 [1:17:56<3:58:30, 190.81s/it, train=94.3%, val_bal=87.8%]Training:  25%|â–ˆâ–ˆâ–Œ       | 25/100 [1:21:08<3:58:30, 190.81s/it, train=94.2%, val_bal=86.3%]Training:  26%|â–ˆâ–ˆâ–Œ       | 26/100 [1:21:08<3:55:45, 191.16s/it, train=94.2%, val_bal=86.3%]Training:  26%|â–ˆâ–ˆâ–Œ       | 26/100 [1:24:20<3:55:45, 191.16s/it, train=94.5%, val_bal=87.2%]Training:  27%|â–ˆâ–ˆâ–‹       | 27/100 [1:24:20<3:52:59, 191.50s/it, train=94.5%, val_bal=87.2%]Training:  27%|â–ˆâ–ˆâ–‹       | 27/100 [1:27:32<3:52:59, 191.50s/it, train=94.4%, val_bal=88.5%]Training:  28%|â–ˆâ–ˆâ–Š       | 28/100 [1:27:32<3:50:00, 191.67s/it, train=94.4%, val_bal=88.5%]Training:  28%|â–ˆâ–ˆâ–Š       | 28/100 [1:30:43<3:50:00, 191.67s/it, train=94.7%, val_bal=86.6%]Training:  29%|â–ˆâ–ˆâ–‰       | 29/100 [1:30:43<3:46:35, 191.49s/it, train=94.7%, val_bal=86.6%]Training:  29%|â–ˆâ–ˆâ–‰       | 29/100 [1:33:55<3:46:35, 191.49s/it, train=95.3%, val_bal=87.6%]Training:  30%|â–ˆâ–ˆâ–ˆ       | 30/100 [1:33:55<3:43:19, 191.42s/it, train=95.3%, val_bal=87.6%]Training:  30%|â–ˆâ–ˆâ–ˆ       | 30/100 [1:37:05<3:43:19, 191.42s/it, train=95.4%, val_bal=89.5%]Training:  31%|â–ˆâ–ˆâ–ˆ       | 31/100 [1:37:05<3:39:50, 191.17s/it, train=95.4%, val_bal=89.5%]Training:  31%|â–ˆâ–ˆâ–ˆ       | 31/100 [1:40:16<3:39:50, 191.17s/it, train=95.2%, val_bal=84.4%]Training:  32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [1:40:16<3:36:39, 191.16s/it, train=95.2%, val_bal=84.4%]Training:  32%|â–ˆâ–ˆâ–ˆâ–      | 32/100 [1:43:29<3:36:39, 191.16s/it, train=95.3%, val_bal=87.8%]Training:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [1:43:29<3:33:58, 191.62s/it, train=95.3%, val_bal=87.8%]Training:  33%|â–ˆâ–ˆâ–ˆâ–Ž      | 33/100 [1:46:40<3:33:58, 191.62s/it, train=95.5%, val_bal=83.7%]Training:  34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [1:46:40<3:30:28, 191.35s/it, train=95.5%, val_bal=83.7%]Training:  34%|â–ˆâ–ˆâ–ˆâ–      | 34/100 [1:49:50<3:30:28, 191.35s/it, train=95.6%, val_bal=89.0%]Training:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [1:49:50<3:26:53, 190.97s/it, train=95.6%, val_bal=89.0%]Training:  35%|â–ˆâ–ˆâ–ˆâ–Œ      | 35/100 [1:53:02<3:26:53, 190.97s/it, train=95.9%, val_bal=81.2%]Training:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [1:53:02<3:24:02, 191.29s/it, train=95.9%, val_bal=81.2%]Training:  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 36/100 [1:56:14<3:24:02, 191.29s/it, train=96.0%, val_bal=83.5%]Training:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [1:56:14<3:20:59, 191.42s/it, train=96.0%, val_bal=83.5%]Training:  37%|â–ˆâ–ˆâ–ˆâ–‹      | 37/100 [1:59:25<3:20:59, 191.42s/it, train=96.0%, val_bal=89.0%]Training:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [1:59:25<3:17:46, 191.39s/it, train=96.0%, val_bal=89.0%]Training:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 38/100 [2:02:37<3:17:46, 191.39s/it, train=96.4%, val_bal=88.4%]Training:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [2:02:37<3:14:41, 191.50s/it, train=96.4%, val_bal=88.4%]Training:  39%|â–ˆâ–ˆâ–ˆâ–‰      | 39/100 [2:05:50<3:14:41, 191.50s/it, train=96.3%, val_bal=88.6%]Training:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [2:05:50<3:11:52, 191.87s/it, train=96.3%, val_bal=88.6%]Training:  40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 40/100 [2:09:00<3:11:52, 191.87s/it, train=97.0%, val_bal=87.7%]Training:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [2:09:00<3:08:12, 191.41s/it, train=97.0%, val_bal=87.7%]Training:  41%|â–ˆâ–ˆâ–ˆâ–ˆ      | 41/100 [2:12:11<3:08:12, 191.41s/it, train=96.6%, val_bal=85.5%]Training:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [2:12:11<3:05:04, 191.45s/it, train=96.6%, val_bal=85.5%]Training:  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 42/100 [2:15:23<3:05:04, 191.45s/it, train=96.9%, val_bal=89.7%]Training:  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [2:15:23<3:01:55, 191.50s/it, train=96.9%, val_bal=89.7%]Training:  43%|â–ˆâ–ˆâ–ˆâ–ˆâ–Ž     | 43/100 [2:18:32<3:01:55, 191.50s/it, train=97.2%, val_bal=86.6%]Training:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [2:18:32<2:57:59, 190.71s/it, train=97.2%, val_bal=86.6%]Training:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 44/100 [2:21:39<2:57:59, 190.71s/it, train=97.0%, val_bal=88.5%]Training:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [2:21:39<2:53:42, 189.50s/it, train=97.0%, val_bal=88.5%]Training:  45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 45/100 [2:24:43<2:53:42, 189.50s/it, train=97.2%, val_bal=87.8%]Training:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [2:24:43<2:49:13, 188.03s/it, train=97.2%, val_bal=87.8%]Training:  46%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 46/100 [2:27:48<2:49:13, 188.03s/it, train=97.6%, val_bal=88.1%]Training:  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 47/100 [2:27:48<2:45:08, 186.96s/it, train=97.6%, val_bal=88.1%]